import{A as f,t as $,l as k,f as H,j as n,C as e}from"./index-DayO9q6V.js";import{r as d}from"./recharts-DVuIdjrD.js";import{M as L}from"./MyAreaChart-CTZhVOzD.js";const j=[["Дыхание","Breathing"],["Медитация","Meditation"],["Закалка","Hardening"]],v=[["месяц","month"],["пол года","half year"],["год","year"]],R=[28,180,360],y=t=>{const i=Math.floor(t/1e3),r=Math.floor(i/60),l=i%60;return`${r}m ${l}s`},W=(t,i)=>new Date(t).toLocaleDateString(i===0?"ru-RU":"en-US",{day:"2-digit",month:"short"}),A=({theme:t,langIndex:i,fSize:r,metricIndex:l,setMetricIndex:a})=>n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"5px",padding:"2px",backgroundColor:e.get("panel",t),borderRadius:"12px"},children:j.map((x,o)=>n.jsxs("span",{onClick:()=>a(o),style:{padding:"6px 10px",cursor:"pointer",fontSize:r===0?"12px":"14px",fontWeight:l===o?"600":"400",color:l===o?e.get("mainText",t):e.get("subText",t),opacity:l===o?1:.7,transition:"all 0.2s ease"},children:[x[i],o<j.length-1&&n.jsx("span",{style:{margin:"0 8px",color:e.get("border",t)},children:"|"})]},o))}),B=({theme:t,langIndex:i,fSize:r,periodIndex:l,setPeriodIndex:a})=>n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",margin:"8px 0"},children:v.map((x,o)=>n.jsxs("span",{onClick:()=>a(o),style:{padding:"6px 10px",cursor:"pointer",fontSize:r===0?"11px":"13px",fontWeight:l===o?"600":"400",color:l===o?e.get("mainText",t):e.get("subText",t),opacity:l===o?1:.8,transition:"all 0.2s ease"},children:[x[i],o<v.length-1&&n.jsx("span",{style:{margin:"0 8px",color:e.get("border",t),fontSize:r===0?"12px":"14px"},children:"|"})]},o))}),P=()=>{const[t,i]=d.useState("dark"),[r,l]=d.useState(f.prefs[0]),[a,x]=d.useState(f.prefs[4]),[o,w]=d.useState(0),[b,T]=d.useState(0);d.useEffect(()=>{const s=$.subscribe(i),c=k.subscribe(u=>l(u==="ru"?0:1)),p=H.subscribe(x);return()=>{s.unsubscribe(),c.unsubscribe(),p.unsubscribe()}},[]);const M=[f.breathingLog,f.meditationLog,f.hardeningLog],m=d.useMemo(()=>{const s=M[o]||{},c={};for(const[p,u]of Object.entries(s)){let C=0,S=0,D=0;for(const g of u){const z=g.endTime-g.startTime;C+=z,o===0&&g.maxHold&&(S+=g.maxHold),o===2&&g.timeInColdWater&&(D+=g.timeInColdWater)}c[p]={date:p,totalDuration:C,totalMaxHold:S,totalTimeInCold:D}}return Object.values(c).sort((p,u)=>new Date(p.date)-new Date(u.date))},[o]),h=d.useMemo(()=>{if(m.length===0)return[];const s=new Date,c=new Date(s);return c.setDate(s.getDate()-R[b]),m.filter(p=>new Date(p.date)>=c)},[m,b]),I=d.useMemo(()=>h.map(s=>({date:s.date.split("-").slice(1).reverse().join("."),weight:Math.round(s.totalDuration/1e3)})).reverse(),[h]);return n.jsxs("div",{style:E(t).container,children:[n.jsx("div",{style:{fontSize:a===0?"14px":"16px",fontWeight:"bold",fontFamily:"Segoe UI",color:o===0?e.get("out",t):o===1?e.get("meditate",t):e.get("cold",t)},children:j[o][r]}),n.jsx("div",{style:{width:"100%",height:"220px",marginBottom:"16px",marginRight:"25px"},children:n.jsx(L,{data:I,fillColor:o===0?e.get("out",t):o===1?e.get("meditate",t):e.get("cold",t),textColor:e.get("subText",t),linesColor:e.get("border",t),backgroundColor:e.get("background",t)})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[n.jsx(A,{theme:t,langIndex:r,fSize:a,metricIndex:o,setMetricIndex:w}),n.jsx(B,{theme:t,langIndex:r,fSize:a,periodIndex:b,setPeriodIndex:T})]}),n.jsx("div",{style:{width:"90%",height:"42%",overflowY:"auto",padding:"8px",backgroundColor:e.get("panel",t),borderRadius:"12px",border:`1px solid ${e.get("border",t)}`,scrollbarWidth:"thin",scrollbarColor:`${e.get("icons",t)} ${e.get("background",t)}`},children:h.length===0?n.jsx("div",{style:{color:e.get("subText",t),fontSize:a===0?"13px":"15px",textAlign:"center"},children:r===0?"Нет данных за выбранный период":"No data for selected period"}):h.slice().reverse().map((s,c)=>n.jsxs("div",{style:{display:"flex",borderBottom:`1px solid ${e.get("border",t)}`,justifyContent:"space-between",padding:"5px 12px"},children:[n.jsx("span",{style:{color:e.get("mainText",t),fontSize:a===0?"13px":"15px"},children:W(s.date,r)}),n.jsx("span",{style:{color:e.get("icons",t),fontSize:a===0?"13px":"15px",fontWeight:"500"},children:y(s.totalDuration)}),o===0&&s.totalMaxHold>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:a===0?"12px":"14px",color:e.get("subText",t)},children:[n.jsx("span",{children:r===0?"Макс. задержка: ":"Max Hold: "}),n.jsx("span",{children:y(s.totalMaxHold)})]}),o===2&&s.totalTimeInCold>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:a===0?"12px":"14px",color:e.get("subText",t)},children:[n.jsx("span",{children:r===0?"В холодной: ":"In Cold: "}),n.jsx("span",{children:y(s.totalTimeInCold)})]})]},`${s.date}-${c}`))})]})},E=t=>({container:{backgroundColor:e.get("background",t),display:"flex",position:"absolute",flexDirection:"column",overflowY:"scroll",justifyContent:"start",alignItems:"center",height:"78vh",top:"14vh",width:"100vw",fontFamily:"Segoe UI"}});export{P as default};
