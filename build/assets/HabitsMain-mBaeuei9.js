import{R as y,r as d,A as c,t as K,g as Q,l as B,j as p,C as i,a as P,Q as q,S as J,m as Z,T as tt,V as et,W as at}from"./index-CmFk1T56.js";import{u as nt,a as st,b as R}from"./index-BUgLP_AM.js";const I=new Date().toISOString().split("T")[0],rt=new Audio("Audio/Click.wav"),it=new Audio("Audio/Skip.wav"),ot=new Audio("Audio/IsDone.wav");let ct,dt,lt;const yt=()=>{const[e,s]=y.useState("dark"),[l,o]=y.useState("dark"),[a,t]=y.useState([]),[x,S]=y.useState([]),[m,w]=d.useState(c.prefs[0]),[h,f]=d.useState(c.choosenHabits.length>0);y.useEffect(()=>{const r=K.subscribe(s);return()=>r.unsubscribe()},[]),y.useEffect(()=>{const r=Q.subscribe(o);return()=>r.unsubscribe()},[]),y.useEffect(()=>{const r=B.subscribe(b=>{w(b==="ru"?0:1)});return()=>r.unsubscribe()},[]),y.useEffect(()=>{t(c.choosenHabits)},[]),y.useEffect(()=>{if(a.length>0){const r=new Set;a.forEach(b=>{const g=j().find(C=>C.id===b);g&&!r.has(g.category[0])&&r.add(g.category[0])}),S(Array.from(r))}},[a]);const T=r=>{t(b=>{const g=new Set(b);return g.has(r)?b:(c.addHabit(I,r),[...g,r])}),f(c.choosenHabits.length>0)};return ct=r=>{if(a.includes(r)){c.removeHabit(I,r),t(v=>v.filter(A=>A!==r));const C=(j().find(v=>v.id===r)?.name||["",""])[m]||(m===0?"Привычка":"Habit"),D=m===0?`Привычка: '${C}' удалена`:`Habit: '${C}' deleted`;q(D,2e3),f(c.choosenHabits.length>0)}},dt=T,p.jsxs("div",{style:H(e).container,children:[!h&&p.jsx("div",{style:{...H(e).panel,justifyContent:"center",alignItems:"center",marginTop:"40%"},children:p.jsx("p",{style:{...H(e).subText,fontSize:"12px",margin:"10%",marginTop:"20%",whiteSpace:"pre-line",color:i.get("subText",e)},children:gt(m)})}),h&&p.jsx("div",{style:H(e).scrollView,children:ut({theme:e,habitsCards:a,categories:x})})]})};function j(){return P.concat((c.CustomHabits||[]).filter(e=>!P.some(s=>s.id===e.id)))}function ut({theme:e,habitsCards:s,categories:l}){return l.map(o=>{const a=s.map(t=>j().find(x=>x.id===t)).filter(t=>t&&t.category[0]===o);return p.jsx(bt,{text:j().find(t=>t.category[0]===o)?.category,theme:e,children:a.map(t=>p.jsx(pt,{id:t.id,text:t.name,descr:t.description,imgsrc:t.src,theme:e},t.id))},o)})}function pt({id:e=0,text:s=["Название","Name"],descr:l=["Описание","Description"],imgsrc:o,theme:a}){const[t,x]=d.useState(c.habitsByDate[I]?.[e]),[S,m]=d.useState(c.prefs[0]),[w,h]=d.useState(null),f=100,T=-f,[k,r]=d.useState(!0);let b=i.get(t===1?"habitCardDone":t===-1?"habitCardSkipped":"habitCard",a),g=i.get(t===0?"habitCardSkipped":t===1?"habitCard":"habitCardSkipped",a),C=i.get(t===0?"habitCardDone":t===-1?"habitCard":"habitCardDone",a);const[D,v]=d.useState(!1),[A,E]=d.useState(b);d.useEffect(()=>{const u=B.subscribe(n=>{m(n==="ru"?0:1)});return()=>u.unsubscribe()},[]),d.useEffect(()=>{c.changeStatus(I,e,t)},[t]),d.useEffect(()=>{(async()=>{try{if(o&&typeof o=="string"&&o.startsWith("icon_")){const n=await tt(o);h(n||"images/HabitsIcons/Default.png")}else h(o)}catch(n){console.error("Error loading icon:",n),h("images/HabitsIcons/Default.png")}})()},[o]);const M=Array.isArray(s)?s[S]:s,U=Array.isArray(l)?l[S]:l;d.useEffect(()=>{E(i.get(t===1?"habitCardDone":t===-1?"habitCardSkipped":"habitCard",a))},[a,t]);const z=nt(0),$=st(z,[-1,1],[T,f]),F=()=>{b=i.get(t===1?"habitCardDone":t===-1?"habitCardSkipped":"habitCard",a),g=i.get(t===0?"habitCardSkipped":t===1?"habitCard":"habitCardSkipped",a),C=i.get(t===0?"habitCardDone":t===-1?"habitCard":"habitCardDone",a)},Y=(u,n)=>{(t===1&&n.offset.x<0||t!==1)&&E(ft(b,n.offset.x>0?C:g,Math.abs(n.offset.x)/f)),Math.abs(n.offset.x)>f&&k&&(V(n.offset.x>0),R($,0,{type:"tween",duration:.2}),r(!1))},O=()=>{k&&R($,0,{type:"tween",duration:.2}),E(i.get(t===1?"habitCardDone":t===-1?"habitCardSkipped":"habitCard",a)),r(!0)},V=u=>{let n=0;if(u)t===0?n=1:t===-1?n=0:n=1,c.habitsByDate[I][e]=n;else{if(t===0)n=-1;else if(t===1)n=0;else{n=-1,lt=e;const G=c.prefs[0]===0?`Вы уверены, что хотите удалить привычку: '${M}' ?`:`Are you sure you want to delete '${M}' habit?`;at(G)}c.habitsByDate[I][e]=n}n===1?L(ot,50):n===-1&&L(it,50),E(i.get(n===1?"habitCardDone":n===-1?"habitCardSkipped":"habitCard",a)),x(n)},N=()=>{L(rt,50);const u=!D;v(u),et(u?e:null)};d.useEffect(()=>{const u=J.subscribe(n=>{v(n===e)});return()=>u.unsubscribe()},[e]);const W={display:"flex",flexDirection:"column",width:"90%",borderRadius:"24px",margin:"5px",overflow:"hidden",borderStyle:"solid",borderColor:i.get("border",a),borderWidth:1,position:"relative",backgroundColor:A,x:$},X={fontSize:"14px",color:i.get("mainText",a),marginLeft:"20px"},_={textAlign:"left",fontSize:"10px",color:i.get("subText",a),marginLeft:"70px"};return p.jsxs(Z.div,{id:e,style:W,onClick:N,drag:k?"x":!1,dragConstraints:{left:T,right:t===1?0:f},onDragStart:F,dragElastic:0,onDrag:Y,onDragEnd:O,animate:{height:D?"10vh":"4.5vh",outline:D?"3px solid "+i.get("border",a):"1px solid "+i.get("border",a)},transition:{type:"tween",duration:.4,ease:"easeInOut"},children:[p.jsxs("div",{style:{display:"flex",alignItems:"flex-start",maxHeight:"40px",paddingBottom:"5px"},children:[w&&p.jsx("img",{src:w,style:{width:"24px",objectFit:"contain",marginLeft:"15px",marginTop:"8px"},onError:u=>{u.target.onerror=null,u.target.src="images/HabitsIcons/Default.png"},alt:""}),p.jsx("h2",{style:X,children:M})]}),D&&p.jsx("div",{style:{paddingBottom:"25px"},children:p.jsx("p",{style:_,children:U})})]})}function bt({text:e=["Имя","Name"],children:s,theme:l}){const[o,a]=d.useState(c.prefs[0]);return d.useEffect(()=>{const t=B.subscribe(x=>{a(x==="ru"?0:1)});return()=>t.unsubscribe()},[]),p.jsxs("div",{style:H(l).categoryPanel,children:[e[o],s]})}const H=e=>({container:{backgroundColor:i.get("background",e),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI"},categoryPanel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,margin:"4px",background:i.get("panelGradient",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,fontFamily:"Segoe UI",color:i.get("subText",e)},text:{textAlign:"left",fontSize:"10px",color:i.get("subText",e),marginLeft:"30px",marginBottom:"12px"},scrollView:{padding:"20px",width:"90vw",height:"80vh",overflowY:"auto",marginTop:"15vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch",borderRadius:"24px",backgroundColor:"rgba(0,0,0,0.1)"}});function ft(e,s,l){if(!e||!s)return e||s||"#000000";l=Math.max(0,Math.min(1,l)),e=e.replace("#",""),s=s.replace("#","");const o=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),t=parseInt(e.slice(4,6),16),x=parseInt(s.slice(0,2),16),S=parseInt(s.slice(2,4),16),m=parseInt(s.slice(4,6),16),w=Math.round(o+(x-o)*l),h=Math.round(a+(S-a)*l),f=Math.round(t+(m-t)*l);return"#"+w.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")+f.toString(16).padStart(2,"0")}function gt(e){return e===0?`Вы еще не добавили ни одной привычки

 Вы можете выбрать из списка или добавить свою привычку.

Выбранные привычки будут обновляться автоматически каждый день, если вы пропустите день, привычка будет не выполнена для этого дня.

Вы должны выполнить свою привычку и затем свайпнуть вправо, чтобы отметить её как выполненную.

Чтобы сформировать привычку, вам нужно выполнить ее 66 дней подряд.

Вы можете просмотреть прогресс ваших привычек в панели метрик и календаре.


 * Чтобы начать, нажмите кнопку "+" ниже`:`You have not added any habits yet

 You can choose from the list or add your own habit.

Choosen habits will update automatically every day, if you skip a day, the habit will be skipped for that day.

You need to perform your habit and then swipe right to mark it as done.

To form a habit you need to perform it for 66 days in a row.

You can view a progress of your habits in the metrics panel and calendar.


 * To get started tap the "+" button below`}function L(e,s){c.prefs[2]==0&&e!==null&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),c.prefs[3]==0&&navigator.vibrate(s)}export{dt as addHabitFn,lt as currentId,yt as default,ct as removeHabitFn};
