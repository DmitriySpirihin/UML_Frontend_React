import{A as l,U as S,p as Q,u as q,t as X,l as Z,f as _,v as ee,w as te,j as e,b as I,N as ie,C as r,m as F,a as se,x as ne,y as oe,z as ae,B as re,D as le,E as ce,G as de,n as pe,H as ue,I as ge,J as xe,K as be,L as he,i as fe}from"./index-HEAg23VM.js";import{r as a,R as me}from"./recharts-Bg6K2Pzo.js";import{getCurrentCycleAnalysis as ye}from"./TrainingAnaliticsMain-Ct0Fxh-F.js";import{P as we,s as ve}from"./Premium-xia6nhgr.js";import"./TrainingAnaliticsTabs-BUKoNwQE.js";import"./index-DjjLxQoJ.js";const ze=()=>{const[i,n]=a.useState(l.prefs[1]===0?"dark":"light"),[o,d]=a.useState(l.prefs[0]),[g,f]=a.useState(0),[m,y]=a.useState(0),[j,x]=a.useState(0),[c,w]=a.useState(!1),[k,T]=a.useState(""),[b,E]=a.useState(""),[D,H]=a.useState(""),[M,U]=a.useState(!1),[W,P]=a.useState(!1),[R,B]=a.useState(S.hasPremium),[$,L]=a.useState(S.isValidation),[p,v]=a.useState(l.menuCardsStates||{}),A=[{id:"HabitsMain",icon:e.jsx(ae,{}),title:o===0?"Привычки":"Habits",subtitle:o===0?"Трекер дисциплины":"Discipline tracker",color:"#FFD700"},{id:"TrainingMain",icon:e.jsx(re,{}),title:o===0?"Тренировки":"Workout",subtitle:o===0?"Дневник силы":"Gym diary",color:"#FF4D4D"},{id:"MentalMain",icon:e.jsx(le,{}),title:o===0?"Мозг":"Brain",subtitle:o===0?"Развитие интеллекта":"Intelligence",color:"#4DA6FF"},{id:"RecoveryMain",icon:e.jsx(ce,{}),title:o===0?"Восстановление":"Recovery",subtitle:o===0?"Медитации и отдых":"Meditation & Rest",color:"#4DFF88"},{id:"SleepMain",icon:e.jsx(de,{}),title:o===0?"Сон":"Sleep",subtitle:o===0?"Анализ качества":"Quality analysis",color:"#A64DFF"},{id:"ToDoMain",icon:e.jsx(pe,{}),title:o===0?"Задачи":"To-Do",subtitle:o===0?"Список дел":"Task list",color:"#FFA64D"}];a.useEffect(()=>{l.menuCardsStates&&Object.keys(l.menuCardsStates).length>0&&v(l.menuCardsStates)},[]),a.useEffect(()=>{Object.keys(p).length>0&&(l.menuCardsStates=p,(async()=>{try{await oe(),console.log("Menu states saved successfully")}catch(s){console.error("Failed to save menu states",s)}})())},[p]),a.useEffect(()=>{const t=Q.subscribe(B),s=q.subscribe(L);return()=>{t.unsubscribe(),s.unsubscribe()}},[]),a.useEffect(()=>{const t=X.subscribe(n),s=Z.subscribe(C=>{d(C==="ru"?0:1)}),u=_.subscribe(f);return()=>{t.unsubscribe(),s.unsubscribe(),u.unsubscribe()}},[]),a.useEffect(()=>{const t=ee.subscribe(T),s=te.subscribe(U);return()=>{t.unsubscribe(),s.unsubscribe()}},[]),a.useEffect(()=>{M&&(P(!1),w(!0))},[M]);const z=t=>{t?x(j+1):y(m+1),m===5&&j===5&&(P(!0),y(0),x(0),S.hasPremium=!0,S.premiumEndDate="2099-01-01",ge(!0))},V=t=>{t.length===16&&ue(t)},O=t=>{v(s=>({...s,[t]:{...s[t],pinned:!s[t]?.pinned,hidden:s[t]?.hidden||!1}}))},G=t=>{v(s=>({...s,[t]:{...s[t],hidden:!0,pinned:!1}}))},N=()=>{v(t=>{const s={...t};return Object.keys(s).forEach(u=>{s[u]={...s[u],hidden:!1}}),s})},Y=(()=>{let t=[...A];return t=t.filter(s=>!p[s.id]?.hidden),t.sort((s,u)=>{const C=p[s.id]?.pinned?1:0;return(p[u.id]?.pinned?1:0)-C}),t})(),J=A.some(t=>p[t.id]?.hidden),K={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.09}}};return e.jsxs(e.Fragment,{children:[c&&e.jsxs("div",{style:{position:"absolute",display:"flex",alignItems:"center",flexDirection:"column",top:"10vh",left:"0",width:"100vw",height:"40vh",backgroundColor:"rgba(0,0,0,0.9)",zIndex:1e4},children:[e.jsx("div",{style:{display:"flex",overflowY:"scroll",borderRadius:"12px",width:"85vw",height:"15vh",fontSize:"12px",fontFamily:"Segoe UI",border:"1px solid #333",color:"white",padding:"10px"},children:k}),e.jsx("textarea",{style:{borderRadius:"12px",width:"85vw",height:"10vh",fontSize:"12px",background:"#111",color:"white",marginTop:"10px"},value:D,onChange:t=>H(t.target.value)}),e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around",marginTop:"10px"},children:[e.jsx("input",{style:{borderRadius:"12px",width:"50vw",height:"3vh",background:"#222",color:"white"},type:"text",onChange:t=>E(t.target.value)}),e.jsx("button",{onClick:()=>{b==="TrainingMain"?I("TrainingMain"):ie.sendMessage(b,D)},children:"Submit"})]}),e.jsx("button",{onClick:()=>w(!1),style:{marginTop:"10px"},children:"Close"})]}),e.jsxs("div",{style:h(i).container,children:[e.jsx("div",{style:{height:"16vh"}}),W&&e.jsx("input",{style:{width:"85vw",height:"2vh",fontSize:"12px",borderRadius:"12px",zIndex:1001,marginBottom:"10px"},type:"password",onChange:t=>V(t.target.value)}),e.jsxs("div",{style:h(i).scrollView,children:[e.jsx("div",{style:{height:"2vh",width:"100%"},onClick:()=>{z(!0)}}),!R&&!$&&e.jsx(we,{clickHandler:()=>ve(),w:"87%",h:"55px",fSize:"15px",br:"24px",langIndex:o,theme:i,textToShow:["Премиум за приглашение","Invite and get premium"],needSparcle:!1}),e.jsx(Se,{theme:i,lang:o,onClick:()=>{I("RobotMain")}}),e.jsx(F.div,{variants:K,initial:"hidden",animate:"show",style:h(i).grid,children:e.jsx(se,{mode:"popLayout",children:Y.map((t,s)=>e.jsx(Fe,{item:t,theme:i,hasPremium:R,index:s,fSize:g,lang:o,isPinned:p[t.id]?.pinned,onPin:()=>O(t.id),onHide:()=>G(t.id)},t.id))})}),J&&e.jsxs(F.div,{initial:{opacity:0},animate:{opacity:1},onClick:N,style:{marginTop:"20px",padding:"10px 20px",display:"flex",alignItems:"center",gap:"8px",background:r.get("simplePanel",i),borderRadius:"20px",cursor:"pointer",fontSize:"12px",color:r.get("subText",i)},children:[e.jsx(ne,{})," ",o===0?"Вернуть скрытые разделы":"Restore hidden sections"]}),e.jsx("div",{style:{height:"10vh",width:"100%"},onClick:()=>{z(!1)}})]})]})]})};function Se({theme:i,lang:n,onClick:o}){const d=i==="dark",g="#00E5FF";return e.jsxs(F.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},whileTap:{scale:.96},onClick:o,style:{width:"88%",height:"50px",borderRadius:"16px",background:d?"rgba(0, 229, 255, 0.08)":"#FFFFFF",border:`1px solid ${d?"rgba(0, 229, 255, 0.3)":"rgba(0, 229, 255, 0.5)"}`,boxShadow:`0 0 15px ${d?"rgba(0, 229, 255, 0.15)":"rgba(0, 150, 255, 0.1)"}`,backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"10px",cursor:"pointer",position:"relative",overflow:"hidden"},children:[e.jsx(xe,{size:18,color:g}),e.jsx("span",{style:{fontFamily:"Segoe UI",fontWeight:"600",fontSize:"15px",color:d?"#E0F7FA":"#333",letterSpacing:"0.3px"},children:n===0?"AI Ассистент & Инсайты":"AI Assistant & Insights"}),e.jsx("div",{style:{position:"absolute",right:"15px",opacity:.6},children:e.jsx(be,{size:10,color:g})})]})}function Fe({item:i,theme:n,index:o,fSize:d,lang:g,isPinned:f,onPin:m,onHide:y}){const x=ke(o-1),c=n==="dark",w={position:"relative",width:"100%",height:"80px",display:"flex",alignItems:"center",padding:"0 20px",boxSizing:"border-box",borderRadius:"24px",overflow:"hidden",marginBottom:"12px",backgroundColor:c?r.get("simplePanel",n)+"99":"#FFFFFF",backdropFilter:c?"blur(40px)":"none",border:f?`1px solid ${i.color}`:`1px solid ${c?r.get("border",n)+"30":"#E5E7EB"}`,boxShadow:c?"0 8px 20px 0 rgba(0, 0, 0, 0.4)":"0 4px 10px rgba(0, 0, 0, 0.04)"},k={width:"48px",height:"48px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px",flexShrink:0,backgroundColor:c?r.get("background",n)+"80":r.get("background",n),color:i.color,border:c?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.03)"};return e.jsxs(F.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,x:-100,height:0,marginBottom:0},whileTap:{scale:.97},drag:"x",dragConstraints:{left:0,right:0},onDragEnd:(T,{offset:b})=>{b.x<-80&&(y(),window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.notificationOccurred("success")),b.x>80&&(m(),window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("medium"))},onClick:()=>{I(i.id),je(null)},style:w,children:[e.jsx("div",{style:k,children:me.cloneElement(i.icon,{size:22})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",flexGrow:1,overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("h4",{style:{...h(n,d).title,color:r.get("mainText",n),margin:0,fontWeight:c?"900":"700"},children:i.title}),f&&e.jsx(he,{size:12,color:i.color,style:{transform:"rotate(45deg)"}})]}),e.jsx("div",{style:{...h(n,d).subtitle,color:r.get("subText",n),opacity:c?.6:.8},children:i.subtitle})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginLeft:"8px"},children:[x!==""&&e.jsx("div",{style:{padding:"4px 10px",backgroundColor:c?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",borderRadius:"12px",fontSize:"13px",fontWeight:"700",color:r.get("mainText",n),marginRight:"8px"},children:x}),e.jsx(fe,{size:14,color:r.get("subText",n),style:{opacity:.3}})]}),!1]})}const h=(i,n)=>({container:{backgroundColor:r.get("background",i),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI",overflow:"hidden"},scrollView:{width:"100vw",maxHeight:"90vh",overflowY:"scroll",display:"flex",flexDirection:"column",alignItems:"center"},grid:{width:"92%",display:"flex",flexDirection:"column",gap:"4px",marginTop:"5px"},title:{fontFamily:"Segoe UI",fontSize:n===0?"19px":"21px",letterSpacing:"0.2px"},subtitle:{fontFamily:"Segoe UI",fontWeight:"500",fontSize:n===0?"12px":"14px",marginTop:"2px"},text:{fontFamily:"Segoe UI",fontSize:n===0?"10px":"12px",color:r.get("subText",i)},mainText:{fontFamily:"Segoe UI",fontSize:n===0?"14px":"16px",color:r.get("mainText",i)}});function je(i){l.prefs[2]==0,l.prefs[3]==0&&window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("light")}function ke(i){if(i===0)return l.choosenHabits.length>0?l.choosenHabits.length:"";if(i===1){const n=ye().currentTonnage;return n>0?(n/1e3).toFixed(1)+(l.prefs[0]===0?"т":"t"):""}return""}export{ze as default};
