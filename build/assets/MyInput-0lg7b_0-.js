import{b7 as E,b8 as I,j as u,C as y,A,b9 as j,ba as k}from"./index-L6N8QMHc.js";import{r as i}from"./recharts-Bg6K2Pzo.js";const $=({keyType:g=0,maxL:b=500,placeHolder:P,theme:c,h="90%",w:p="vh",value:a="",onChange:x=null,clear:d=!1})=>{const[e,n]=i.useState({myString:"",cursorPos:0}),[r,m]=i.useState(!1),[f,l]=i.useState(!0);return i.useEffect(()=>{n({myString:a,cursorPos:a.length})},[a]),i.useEffect(()=>{const o=E.subscribe(t=>{r&&(t==="bs"?n(s=>{const S=Array.from(s.myString);return s.cursorPos===0?s:{myString:[...S.slice(0,s.cursorPos-1),...S.slice(s.cursorPos)].join(""),cursorPos:s.cursorPos-1}}):t==="bsall"?n({myString:"",cursorPos:0}):t.length===1&&n(s=>({myString:s.myString.slice(0,s.cursorPos)+t+s.myString.slice(s.cursorPos),cursorPos:s.cursorPos+1})))});return()=>o.unsubscribe()},[r]),i.useEffect(()=>{if(!r){l(!1);return}l(!0);const o=setInterval(()=>{l(t=>!t)},500);return()=>clearInterval(o)},[r]),i.useEffect(()=>{const o=I.subscribe(t=>{t.value===!1&&(m(!1),d&&n({myString:"",cursorPos:0}))});return()=>o.unsubscribe()},[]),i.useEffect(()=>{x&&r&&x(e.myString)},[e]),u.jsx("div",{style:{width:p,height:h,borderBottom:`1px solid ${y.get("border",c)}`,display:"flex",alignItems:"flex-end",justifyContent:"flex-start"},onClick:o=>{j(""),m(!0),k({type:g,value:!0}),n(t=>({myString:t.myString,cursorPos:L(o,t.myString)}))},children:u.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflow:"hidden",fontSize:A.prefs[4]===0?"13px":"15px",display:"block",paddingLeft:"8px",textAlign:"left",paddingBottom:"2px",lineHeight:"18px",fontFamily:"Segoe UI",color:e.myString.length===0?y.get("icons",c):y.get("mainText",c)},children:e.myString.length>0||r?u.jsxs(u.Fragment,{children:[e.myString.slice(0,e.cursorPos),u.jsx("span",{style:{display:"inline-block",width:"2px",color:f&&r?y.get("iconsHighlited",c):"transparent",fontSize:"15px",marginLeft:"2px",verticalAlign:"middle"},children:"|"}),e.myString.slice(e.cursorPos)]}):P})})},L=(g,b)=>{const c=A.prefs[4]===0?13:15,h=18,p=g.nativeEvent.offsetX-8,a=g.nativeEvent.offsetY,d=document.createElement("canvas").getContext("2d");d.font=`${c}px 'Segoe UI', 'Apple Color Emoji', 'Noto Color Emoji', 'Arial'`;const e=b.split(`
`),n=Math.floor(a/h),r=Math.min(n,e.length-1),m=e[r],f=Array.from(m);let l=0;for(let t=0;t<f.length;t++){const s=d.measureText(f[t]).width;if(l+=s,p<l)return e.slice(0,r).reduce((w,C)=>w+Array.from(C).length+1,0)+t}return e.slice(0,r).reduce((t,s)=>t+Array.from(s).length+1,0)+f.length};export{$ as M};
