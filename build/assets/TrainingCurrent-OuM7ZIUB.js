import{R as E,r as i,A as m,b6 as $,t as M,l as W,f as K,j as t,C as s,b7 as O,g as U,$ as V}from"./index-BIfy9fDg.js";import{f as Y}from"./TrainingLogHelper-DAwItdJa.js";import{T as H}from"./TimerTwoTone-ldkWb_Xw.js";new Audio("Audio/Timer.wav");const ie=()=>{const[e,n]=E.useState("dark"),[o,g]=i.useState(m.prefs[0]),[r,d]=i.useState(m.prefs[4]),[x,f]=i.useState($),[c,y]=i.useState({}),[p,z]=i.useState(!0),[b,S]=i.useState(null),[v,I]=i.useState(null),[F,C]=i.useState(0),[P,B]=i.useState(0),[G,J]=i.useState(!1),[L,Q]=i.useState(12e4),[k,X]=i.useState(3e3),[Z,_]=i.useState(0);return i.useEffect(()=>{const h=M.subscribe(n),w=W.subscribe(l=>{g(l==="ru"?0:1)}),R=K.subscribe(l=>{d(l)}),u=$.subscribe(l=>{const j=m.trainingLog?.[l.dayKey]?.[l.dInd]||null;S(m.programs.find(A=>A.id===j.programId)),I(l.dInd),C(j.tonnage),B(j.duration),y(j),f(l)});return()=>{h.unsubscribe(),w.unsubscribe(),R.unsubscribe(),u.unsubscribe()}},[]),t.jsx("div",{style:a(e).container,children:t.jsxs("div",{style:a(e).panel,children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",height:"25vw",borderBottomRightRadius:"24px",borderBottomLeftRadius:"24px",width:"100%",alignItems:"center",backgroundColor:s.get("bottomPanel",e)},children:[t.jsx("div",{style:a(e,r).text,children:b?.name[o]}),t.jsx("div",{style:{...a(e,r).subtext,marginBottom:"15px"},children:(x.mode==="new"?"⏳ ":"✅ ")+b?.schedule[v].name[o]}),t.jsxs("div",{style:{display:"flex",width:"100%",height:"15vw",justifyContent:"flex-start",alignItems:"center",borderTop:`1px solid ${s.get("border",e)}`},children:[t.jsx("div",{style:{...a(e,r).subtext,marginLeft:"12px"},children:Math.round(P/6e4)+(o===0?" мин":" min")}),t.jsx("div",{style:{...a(e,r).subtext,marginLeft:"12px"},children:F*.001+(o===0?" тонн":" tons")}),c?.completed&&t.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center"},children:[t.jsx(q,{time:k,maxTime:L,theme:e}),t.jsx(H,{style:{fontSize:"24px",color:s.get("icons",e),marginRight:"19px"}}),t.jsx(O,{style:{fontSize:"24px",color:s.get("icons",e),marginRight:"19px"}})]})]})]}),t.jsx("div",{style:a(e).scrollView,children:c?.exercises&&Object.keys(c.exercises).length>0&&t.jsx("div",{style:{marginTop:"12px",display:"flex",flexDirection:"column",width:"95%"},children:Object.entries(c.exercises).map(([h,w])=>{const R=m.exercises[h].name[o];return t.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[t.jsx("div",{style:{...a(e,r).text,marginLeft:"12px",fontWeight:"bold",marginBottom:"4px"},children:R}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[t.jsxs("div",{style:{display:"flex",height:"25px",justifyContent:"flex-start",borderBottom:`1px solid ${s.get("border",e)}`},children:[t.jsx("div",{style:{...a(e,r).subtext,width:"17%",borderRight:`1px solid ${s.get("border",e)}`},children:o===0?"Подходы":"Sets"}),t.jsx("div",{style:{...a(e,r).subtext,width:"17%",borderRight:`1px solid ${s.get("border",e)}`},children:o===0?"Повторы":"Reps"}),t.jsx("div",{style:{...a(e,r).subtext,width:"17%",borderRight:`1px solid ${s.get("border",e)}`},children:o===0?"Вес":"Weight"})]}),w.sets.map((u,l)=>t.jsxs("div",{style:{display:"flex",height:"25px",justifyContent:"flex-start",borderBottom:`1px solid ${s.get("border",e)}`},children:[t.jsx("div",{style:T(e,u.type),children:l+1}),t.jsxs("div",{style:T(e,u.type),children:[u.reps,p&&t.jsx(D,{exId:h,setIndex:l,beforeDate:new Date(x.dayKey),value:u.reps,isReps:!0,theme:e})]}),t.jsxs("div",{style:T(e,u.type),children:[u.weight,p&&t.jsx(D,{exId:h,setIndex:l,beforeDate:new Date(x.dayKey),value:u.weight,isReps:!1,theme:e})]}),t.jsxs("div",{style:{marginLeft:"auto"},children:[t.jsx(U,{style:a(e).icon}),t.jsx(V,{style:a(e).icon})]})]},l))]})]},h)})})})]})})},T=(e,n)=>({fontSize:"16px",fontWeight:"bold",color:n===0?s.get("trainingIsolatedFont",e):s.get("trainingBaseFont",e),width:"17%",borderRight:`1px solid ${s.get("border",e)}`}),N=(e,n)=>({fontSize:"10px",fontStyle:"italic",color:n?s.get("done",e):s.get("skipped",e)}),a=(e,n)=>({container:{backgroundColor:s.get("background",e),display:"flex",position:"absolute",flexDirection:"column",overflowY:"scroll",justifyContent:"start",alignItems:"center",height:"78vh",top:"14vh",width:"100vw",fontFamily:"Segoe UI"},panel:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center",justifyContent:"start"},scrollView:{display:"flex",flexDirection:"column",overflowY:"scroll",width:"100%",height:"65vh"},text:{textAlign:"left",fontSize:n===0?"13px":"15px",color:s.get("mainText",e),marginBottom:"5px"},subtext:{fontSize:n===0?"11px":"13px",color:s.get("subText",e)},icon:{fontSize:"14px",color:s.get("icons",e),marginRight:"18px"}});function D({exId:e,setIndex:n,beforeDate:o,value:g,isReps:r,theme:d}){const x=Y(e,n,o,m.trainingLog);let f="",c=0;return x!==null&&(c=g-(r?x.reps:x.weight),c!==0&&(f=`${c>0?"+":""}${c}`)),t.jsx("span",{style:N(d,c>0),children:f})}function q({time:e,maxTime:n,theme:o}){const g=n-e,r=Math.floor(g/6e4),d=Math.floor(g%6e4/1e3),x=g>0?`${r>0?r+":":""}${d.toString().padStart(2,"0")}`:"",f=i.useRef(d),[c,y]=i.useState(!1),p=n>0?e/n*100:0;if(i.useEffect(()=>{if(d!==f.current){y(!0),f.current=d;const v=setTimeout(()=>{y(!1)},200);return()=>clearTimeout(v)}},[d]),e<=0||g<=0)return null;const b=c?"18px":"15px",S=p<50&&p>30?s.get("trainingIsolatedFont",o):p<30?s.get("trainingBaseFont",o):s.get("subText",o);return t.jsx("div",{style:{color:S,fontSize:b,fontWeight:"bold",transition:"font-size 0.2s ease-out",lineHeight:1},children:x})}export{ie as default};
