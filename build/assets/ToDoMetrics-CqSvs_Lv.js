import{j as t,A as T,U as P,t as E,l as $,f as H,p as N,C as i,m as h}from"./index-CZoPKF6T.js";import{i as V,B as U,s as Y,X as K,Y as q,T as X,t as _,u as J,r as f}from"./recharts-C3psbGwv.js";import{M as Q}from"./MyAreaChart-DXEi6jLP.js";const Z=({data:e=[],theme:g="dark",textColor:a="#94a3b8",barColor:l="#334155"})=>{const y=g==="light";if(!Array.isArray(e)||e.length===0)return t.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:a,opacity:.5,fontSize:"12px"},children:"No category data"});const b=({active:c,payload:m,label:o})=>c&&m&&m.length?t.jsxs("div",{style:{backgroundColor:y?"rgba(255,255,255,0.9)":"rgba(30,30,30,0.9)",backdropFilter:"blur(10px)",padding:"8px 12px",borderRadius:"12px",border:`1px solid ${l}40`,boxShadow:"0 8px 20px rgba(0,0,0,0.15)",fontFamily:"Segoe UI",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"11px",color:a,marginBottom:"2px",opacity:.8},children:o}),t.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:l},children:[m[0].value," ",t.jsx("span",{style:{fontSize:"10px",fontWeight:"400"},children:"items"})]})]}):null;return t.jsx(V,{width:"100%",height:"100%",children:t.jsxs(U,{data:e,margin:{top:20,right:10,left:-30,bottom:0},barSize:24,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"barGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:l,stopOpacity:1}),t.jsx("stop",{offset:"100%",stopColor:l,stopOpacity:.6})]})}),t.jsx(Y,{stroke:a,strokeOpacity:.1,vertical:!1,strokeDasharray:"4 4"}),t.jsx(K,{dataKey:"name",tick:{fill:a,fontSize:10,opacity:.7},axisLine:!1,tickLine:!1,dy:10,interval:0,tickFormatter:c=>c.length>6?c.slice(0,6)+"..":c}),t.jsx(q,{tick:{fill:a,fontSize:10,opacity:.7},axisLine:!1,tickLine:!1,allowDecimals:!1}),t.jsx(X,{content:t.jsx(b,{}),cursor:{fill:y?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",radius:4}}),t.jsx(_,{dataKey:"count",radius:[6,6,6,6],fill:"url(#barGradient)",animationDuration:1200,children:t.jsx(J,{dataKey:"count",position:"top",offset:5,fontSize:10,fontWeight:600,fill:a,opacity:.8})})]})})},it=()=>{const[e,g]=f.useState("dark"),[a,l]=f.useState(T.prefs[0]),[y,b]=f.useState(T.prefs[4]),[c,m]=f.useState(P.hasPremium);f.useEffect(()=>{const x=E.subscribe(g),p=$.subscribe(C=>l(C==="ru"?0:1)),j=H.subscribe(b),v=N.subscribe(m);return()=>{x.unsubscribe(),p.unsubscribe(),j.unsubscribe(),v.unsubscribe()}},[]);const o=f.useMemo(()=>{const x=T.todoList||[],p=x.filter(r=>r.isDone),j=x.length,v=p.length,C=j>0?Math.round(v/j*100):0,B=Array.from({length:28},(r,n)=>{const u=new Date;u.setDate(u.getDate()-n);const S=u.toISOString().split("T")[0],w=p.filter(O=>O.startDate===S).length;return{date:S,count:w}}).reverse(),I=a===0?["Ð’Ñ","ÐŸÐ½","Ð’Ñ‚","Ð¡Ñ€","Ð§Ñ‚","ÐŸÑ‚","Ð¡Ð±"]:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=[0,0,0,0,0,0,0];p.forEach(r=>{const n=new Date(r.startDate);isNaN(n)||k[n.getDay()]++});const R=Math.max(...k),A=k.indexOf(R),G=R>0?I[A]:"--";let L=0;const W=new Date().toISOString().split("T")[0];for(let r=0;r<30;r++){const n=new Date;n.setDate(n.getDate()-r);const u=n.toISOString().split("T")[0],S=p.some(w=>w.startDate===u);if(!(u===W&&!S))if(S)L++;else break}const F=B.slice(-7).map(r=>{const n=new Date(r.date);return{date:I[n.getDay()],value:r.count}}),D={};x.forEach(r=>{const n=r.category||"General";D[n]=(D[n]||0)+1});const M=Object.keys(D).map(r=>({name:r,count:D[r]})).sort((r,n)=>n.count-r.count).slice(0,5);return{total:j,completedCount:v,rate:C,heatmapDays:B,bestDay:G,streak:L,areaData:F,barData:M}},[T.todoList,a]),s=tt(e),d={hidden:{opacity:0,y:15},show:{opacity:1,y:0}};return t.jsx("div",{style:s.container,children:t.jsxs(h.div,{style:s.scrollContent,className:"no-scrollbar",initial:"hidden",animate:"show",variants:{show:{transition:{staggerChildren:.05}}},children:[t.jsxs(h.div,{variants:d,style:s.header,children:[t.jsx("h2",{style:s.pageTitle,children:a===0?"Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´":"Dashboard"}),t.jsx("span",{style:s.pageSubtitle,children:a===0?"Ð¢Ð²Ð¾Ð¸ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ":"Your achievements"})]}),t.jsxs(h.div,{variants:d,style:s.insightRow,children:[t.jsxs("div",{style:{...s.insightCard,background:"linear-gradient(135deg, #FF6B6B 0%, #EE5253 100%)"},children:[t.jsx("span",{style:s.insightIcon,children:"ðŸ”¥"}),t.jsxs("div",{style:s.insightText,children:[t.jsx("div",{style:s.insightVal,children:o.streak}),t.jsx("div",{style:s.insightLabel,children:a===0?"Ð¡Ñ‚Ñ€Ð¸Ðº (Ð´Ð½ÐµÐ¹)":"Day Streak"})]})]}),t.jsxs("div",{style:{...s.insightCard,background:"linear-gradient(135deg, #4834d4 0%, #686de0 100%)"},children:[t.jsx("span",{style:s.insightIcon,children:"â­"}),t.jsxs("div",{style:s.insightText,children:[t.jsx("div",{style:s.insightVal,children:o.bestDay}),t.jsx("div",{style:s.insightLabel,children:a===0?"ÐŸÐ¸Ðº Ñ„Ð¾Ñ€Ð¼Ñ‹":"Prime Day"})]})]})]}),t.jsxs(h.div,{variants:d,style:s.chartBox,children:[t.jsxs("div",{style:s.chartHeaderRow,children:[t.jsx("h3",{style:s.chartTitle,children:a===0?"ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ":"Activity"}),t.jsx("span",{style:s.chartBadge,children:"28 Days"})]}),t.jsx("div",{style:s.heatmapGrid,children:o.heatmapDays.map((x,p)=>t.jsx("div",{style:{...s.heatmapSquare,backgroundColor:i.get("areaChart",e),opacity:x.count===0?.08:Math.min(.3+x.count*.15,1)}},p))})]}),t.jsxs("div",{style:s.summaryGrid,children:[t.jsx(z,{label:a===0?"Ð’ÑÐµÐ³Ð¾":"Total",value:o.total,theme:e,variants:d,icon:"ðŸ“‹"}),t.jsx(z,{label:a===0?"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾":"Done",value:o.completedCount,theme:e,color:i.get("done",e),variants:d,icon:"âœ”ï¸"}),t.jsx(z,{label:a===0?"Ð£ÑÐ¿ÐµÑ…":"Rate",value:o.rate+"%",theme:e,color:i.get("areaChart",e),variants:d,isHighlight:!0,icon:"âš¡"})]}),t.jsxs(h.div,{variants:d,style:s.chartBox,children:[t.jsx("h3",{style:s.chartTitle,children:a===0?"Ð¢ÐµÐ¼Ð¿ (Ð—Ð°Ð´Ð°Ñ‡Ð¸/Ð”ÐµÐ½ÑŒ)":"Velocity (Tasks/Day)"}),t.jsx("div",{style:{height:"150px",width:"100%"},children:t.jsx(Q,{data:o.areaData,fillColor:i.get("areaChart",e),textColor:i.get("subText",e),linesColor:i.get("subText",e),backgroundColor:i.get("simplePanel",e)})})]}),t.jsxs(h.div,{variants:d,style:s.chartBox,children:[t.jsx("h3",{style:s.chartTitle,children:a===0?"Ð¢Ð¾Ð¿ ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸":"Top Categories"}),t.jsx("div",{style:{height:"180px",width:"100%"},children:t.jsx(Z,{data:o.barData,theme:e,textColor:i.get("subText",e),barColor:i.get("barsColorTonnage",e)})})]})]})})},z=({label:e,value:g,theme:a,color:l,variants:y,icon:b,isHighlight:c})=>t.jsxs(h.div,{variants:y,style:{backgroundColor:i.get("simplePanel",a),borderRadius:"20px",padding:"15px",display:"flex",flexDirection:"column",flex:1,boxShadow:i.get("shadow",a),border:c?`1px solid ${l}44`:"1px solid transparent"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",marginBottom:"5px"},children:[t.jsx("span",{children:b}),t.jsx("span",{style:{fontSize:"10px",color:i.get("subText",a),fontWeight:"700",textTransform:"uppercase"},children:e})]}),t.jsx("span",{style:{fontSize:"22px",fontWeight:"800",color:l||i.get("mainText",a)},children:g})]}),tt=(e,g)=>({container:{backgroundColor:i.get("background",e),height:"100%",width:"100vw",paddingTop:"100px",display:"flex",flexDirection:"column",fontFamily:"SF Pro Display, Segoe UI, sans-serif"},scrollContent:{flex:1,overflowY:"auto",padding:"10px 20px 120px 20px",display:"flex",flexDirection:"column",gap:"18px"},header:{marginBottom:"5px",marginTop:"15px"},pageTitle:{fontSize:"28px",fontWeight:"800",color:i.get("mainText",e),margin:0},pageSubtitle:{fontSize:"14px",color:i.get("subText",e)},insightRow:{display:"flex",gap:"12px"},insightCard:{flex:1,borderRadius:"24px",padding:"15px",display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 8px 20px rgba(0,0,0,0.15)",color:"#fff"},insightIcon:{fontSize:"24px"},insightText:{display:"flex",flexDirection:"column"},insightVal:{fontSize:"20px",fontWeight:"800",lineHeight:1},insightLabel:{fontSize:"10px",opacity:.8,fontWeight:"600",textTransform:"uppercase",marginTop:"2px"},heatmapGrid:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"6px",margin:"15px 0 5px 0"},heatmapSquare:{aspectRatio:"1/1",borderRadius:"6px",width:"100%"},summaryGrid:{display:"flex",gap:"10px"},chartBox:{backgroundColor:i.get("simplePanel",e),borderRadius:"24px",padding:"20px",boxShadow:i.get("shadow",e),border:`1px solid ${e==="dark"?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.02)"}`},chartHeaderRow:{display:"flex",justifyContent:"space-between",alignItems:"center"},chartTitle:{fontSize:"13px",fontWeight:"700",color:i.get("subText",e),margin:0,textTransform:"uppercase",marginBottom:"10px"},chartBadge:{fontSize:"9px",backgroundColor:"rgba(127,127,127,0.1)",padding:"2px 6px",borderRadius:"5px",color:i.get("subText",e)}});export{it as default};
