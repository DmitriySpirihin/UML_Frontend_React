import{r as g,A as m,t as N,l as M,f as W,j as s,C as t}from"./index-CfModHx0.js";import{b as G,c as O}from"./index-cax3g_om.js";const K=(r,u)=>{const e=new Date(r),x={weekday:"long"},i=u===0?"ru-RU":"en-US";return e.toLocaleDateString(i,x)},Y=r=>`${Math.floor(r/6e4)} min`,w=["#00c6ff","#0072ff","#ff416c","#ff4b2b","#38ef7d","#11998e","#f09819","#edde5d","#834d9b","#d04ed6","#1d976c","#93f9b9","#5d29c3","#a968f2","#ff7e5f","#feb47b","#2af598","#009efd","#ff6b6b","#ffa500","#114357","#f29492","#43e97b","#38f9d7","#92fe9d","#00c9ff","#2c3e50","#3498db","#c33764","#1d2671","#ff9a9e","#fecfef","#a8ff78","#78ffd6","#b993d6","#8ca6db","#ff758c","#ff7eb3","#4facfe","#00f2fe"],V=({needToAdd:r,setEx:u})=>{const[e,x]=g.useState("dark"),[i,D]=g.useState(m.prefs[0]==="ru"?0:1),[a,E]=g.useState(m.prefs[1]),[k,z]=g.useState(null);g.useEffect(()=>{const n=N.subscribe(x),o=M.subscribe(l=>{D(l==="ru"?0:1)});return()=>{o.unsubscribe(),n.unsubscribe()}},[]),g.useEffect(()=>{const n=W.subscribe(E);return()=>{n.unsubscribe()}},[]);const b=[];for(const[n,o]of Object.entries(m.trainingLog||{}))o.forEach((l,c)=>{b.push({date:n,idx:c,session:l})});b.sort((n,o)=>{const l=n.session.startTime||0;return(o.session.startTime||0)-l});const j=new Map;let $=0;return b.forEach(({session:n})=>{const o=`${n.programId}-${n.dayIndex}`;j.has(o)||(j.set(o,w[$%w.length]),$++)}),s.jsx("div",{style:f(e).container,children:b.map(n=>{const{date:o,idx:l,session:c}=n,I=`${o}-${l}`,h=k===I,S=c.programId||0,v=c.dayIndex||0,B=`${S}-${v}`,A=j.get(B)||w[0],C=m.programs.find(p=>p.id===S),L=C?.name?.[i]||`Program ${S}`,F=C?.schedule?.[v]?.name?.[i]||`Day ${v+1}`;return s.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{style:{...f(e,!1,!1,a).sessionPanel,borderTop:`3px ridge ${A}`,backgroundColor:h?t.get("trainingGroupSelected",e):t.get("bottomPanel",e),paddingLeft:"12px",paddingRight:"12px",cursor:"pointer"},onClick:()=>z(h?null:I),children:[s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{style:f(e,!1,!1,a).text,children:[o," • ",K(o,i)]}),s.jsxs("div",{style:f(e,!1,!1,a).subtext,children:[L," • ",F]})]}),h?s.jsx(G,{size:20,color:t.get("icons",e),style:{marginRight:"20px"}}):s.jsx(O,{size:20,color:t.get("icons",e),style:{marginRight:"20px"}})]}),h&&s.jsxs("div",{style:{width:"100%",paddingLeft:"12px",paddingRight:"12px",paddingBottom:"12px"},children:[s.jsxs("div",{style:f(e,!1,!1,a).subtext,children:[Y(c.duration||0)," • ",(c.tonnage/1e3).toFixed(2)," ",i===0?"тонн":"tons"]}),Object.entries(c.exercises||{}).filter(([p,y])=>y?.sets?.length>0).map(([p,y])=>{const P=parseInt(p,10),R=m.exercises.find(d=>d.id===P)?.name?.[i]||`Exercise ${p}`;return s.jsxs("div",{style:{...f(e,!1,!1,a).exercisesPanel,backgroundColor:t.get("background",e),borderBottom:`1px solid ${t.get("border",e)}`,width:"100%"},children:[s.jsxs("div",{style:{fontSize:a===0?"12px":"14px",color:t.get("mainText",e),marginBottom:"6px"},children:[R,s.jsxs("span",{style:{...f(e,!1,!1,a).subtext,marginLeft:"20px"},children:[(y.totalTonnage/1e3).toFixed(2)," ",i===0?"тонн":"tons"]})]}),y.sets.map((d,T)=>{const U=d.type===0?t.get("trainingIsolatedFont",e):t.get("trainingBaseFont",e);return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:a===0?"11px":"13px",color:U,fontWeight:"500",borderBottom:`1px solid ${t.get("border",e)}`,marginTop:"4px"},children:[s.jsxs("span",{children:[T+1,":"]}),s.jsx("span",{children:d.weight}),s.jsx("span",{children:i===0?"кг":"kg"}),s.jsx("span",{children:"×"}),s.jsx("span",{children:d.reps}),d.time!=null&&d.time>0&&s.jsxs("span",{children:["(",Math.round(d.time/1e3),"s)"]})]},T)})]},p)})]})]},I)})})},f=(r,u,e,x)=>({container:{backgroundColor:t.get("background",r),display:"flex",flexDirection:"column",overflowY:"scroll",justifyContent:"start",alignItems:"center",height:"78vh",paddingTop:"5vh",width:"100vw",fontFamily:"Segoe UI",boxSizing:"border-box"},sessionPanel:{display:"flex",flexDirection:"row",width:"98vw",height:"6vh",alignItems:"center",justifyContent:"center"},exercisesPanel:{display:"flex",flexDirection:"column",width:"100%",alignItems:"flex-start",justifyContent:"flex-start"},text:{textAlign:"left",fontSize:x===0?"13px":"15px",color:t.get("mainText",r),marginBottom:"4px"},subtext:{textAlign:"left",fontSize:x===0?"11px":"13px",color:t.get("subText",r),marginBottom:"4px"}});export{V as default};
