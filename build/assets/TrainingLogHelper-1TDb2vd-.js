import{A as a,b2 as x}from"./index-Dvwow3_C.js";function p(o){return new Date(o).toISOString().split("T")[0]}function L(o,n,s,e){if(!e||typeof o!="string"||typeof n!="number")return null;const t=s.getTime();let i=null,r=-1/0;for(const[c,g]of Object.entries(e)){const f=new Date(c).getTime();if(!(f>=t))for(const l of g){if(!l.completed)continue;const m=l.exercises?.[o];if(!m||!Array.isArray(m.sets))continue;const d=m.sets[n];!d||typeof d.reps!="number"||typeof d.weight!="number"||f>r&&(r=f,i={type:d.type,reps:d.reps,weight:d.weight,time:d.time})}}return i}async function b(o,n,s){const e=a.programs.find(g=>g.id===n);if(!e||!e.schedule[s])return console.error("Invalid program or dayIndex"),!1;const t={},i=[];e.schedule[s].exercises.forEach(g=>{const u=a.exercises.find(f=>f.id===g.exId);if(!u){console.warn(`Exercise ${g.exId} not found in AppData.exercises`);return}t[g.exId]={mgId:u.mgId,sets:[],totalTonnage:0,completed:!1},i.push(g.exId)});const r=p(o),c={programId:n,dayIndex:s,completed:!1,startTime:Date.now(),endTime:null,duration:0,tonnage:0,exercises:t,exerciseOrder:i};a.trainingLog[r]||(a.trainingLog[r]=[]),a.trainingLog[r].push(c),await x()}async function S(o,n,s,e,t){const i=new Date(o.getFullYear(),o.getMonth(),o.getDate()),r=i.getTime()+e,c=i.getTime()+t,g=c-r,u={},f=[];a.programs.find(h=>h.id===n).schedule[s].exercises.forEach(h=>{const y=a.exercises.find(D=>D.id===h.exId);if(!y){console.warn(`Exercise ${h.exId} not found in AppData.exercises`);return}u[h.exId]={mgId:y.mgId,sets:[],totalTonnage:0,completed:!1},f.push(h.exId)});const m={programId:n,dayIndex:s,completed:!0,startTime:r,endTime:c,duration:g,tonnage:0,exercises:u,exerciseOrder:f},d=p(o);a.trainingLog[d]||(a.trainingLog[d]=[]),a.trainingLog[d].push(m),await x()}async function E(o,n){const s=p(o),e=a.trainingLog[s];if(!e||n<0||n>=e.length)return!1;e.splice(n,1),e.length===0&&delete a.trainingLog[s],await x()}function A(o,n){const s=p(o),e=a.trainingLog[s]?.[n];return!e||e.completed?!1:(e.endTime=Date.now(),e.duration=e.endTime-e.startTime,e.completed=!0,Object.values(e.exercises).map(t=>{t.completed=!0}),e.tonnage=Object.values(e.exercises).reduce((t,i)=>t+(i.totalTonnage||0),0),!0)}function M(o,n,s){const e=p(o),t=a.trainingLog[e]?.[n];return!t||t.exercises[s]?!1:(t.exercises[s]={mgId:a.exercises[s]?.mgId||0,sets:[],totalTonnage:0,completed:!1},t.exerciseOrder.push(s),!0)}function O(o,n,s){const e=p(o),t=a.trainingLog[e]?.[n];if(!t||!t.exercises[s])return!1;const i=t.exercises[s];return t.tonnage=Math.max(0,t.tonnage-(i.totalTonnage||0)),delete t.exercises[s],t.exerciseOrder&&(t.exerciseOrder=t.exerciseOrder.filter(r=>r!==s)),!0}function K(o,n,s,e,t,i,r){const c=p(o),g=a.trainingLog[c]?.[n],u=g?.exercises?.[s];if(!u)return!1;const l={type:r?0:1,reps:e,weight:t,time:i};u.sets.push(l);const m=e*t;return u.totalTonnage=(u.totalTonnage||0)+m,g.tonnage=(g.tonnage||0)+m,!0}function v(o,n,s,e,t,i,r,c){const g=p(o),u=a.trainingLog[g]?.[n],f=u?.exercises?.[s];if(!f||e<0||e>=f.sets.length)return!1;const l=f.sets[e],m=c?0:1;if(l.reps===t&&l.weight===i&&r===l.time&&l.type===m)return!0;const d=l.reps*l.weight;f.totalTonnage=Math.max(0,(f.totalTonnage||0)-d),u.tonnage=Math.max(0,(u.tonnage||0)-d),l.reps=t,l.weight=i,l.type=m;const h=t*i;return f.totalTonnage=(f.totalTonnage||0)+h,u.tonnage=(u.tonnage||0)+h,!0}function j(o,n,s){const e=p(o),i=a.trainingLog[e]?.[n]?.exercises?.[s];return i?(i.completed=!0,!0):!1}function B(o,n){const s=p(o);return a.trainingLog[s]?.[n]?.tonnage||0}function k(o,n){const s=p(o),e=a.trainingLog[s]?.[n];if(!e)return 0;let t=0;for(const i of Object.values(e.exercises))for(const r of i.sets)t+=r.reps;return t}function C(o,n){const s=p(o),e=a.trainingLog[s]?.[n];if(!e)return 0;let t=0;for(const i of Object.values(e.exercises))t+=i.sets.length;return t}function T(o,n){if(!o||!n||o<1||n<=0)return 0;if(o===1)return n;const s=n*(36/(37-o)),e=n*(1+.0333*o),t=n*Math.pow(o,.1),i=s+e+t;return Math.round(i/3)}function F(){const o=new Date;o.setMonth(o.getMonth()-2),o.setHours(0,0,0,0);const n=new Set;return Object.entries(a.trainingLog).forEach(([s,e])=>{new Date(s)>=o&&e.forEach(i=>{i.completed&&Object.entries(i.exercises).forEach(([r,c])=>{Array.isArray(c.sets)&&c.sets.length>0&&n.add(r)})})}),console.log(Array.from(n)),Array.from(n)}function H(o,n=!1){try{const s=new Date;s.setMonth(s.getMonth()-2),s.setHours(0,0,0,0);const e=new Map;return Object.entries(a.trainingLog).forEach(([t,i])=>{if(new Date(t)>=s){let c=0,g=0,u=!1;if(i.forEach(f=>{if(f.completed&&f.exercises?.[o]){const l=f.exercises[o];if(Array.isArray(l.sets)&&l.sets.length>0)if(u=!0,n)g+=l.totalTonnage||0;else{const m=Math.max(...l.sets.map(d=>d.weight||0));m>c&&(c=m)}}}),u){const f=n?g*.001:c;e.set(t,f)}}}),Array.from(e.entries()).map(([t,i])=>({date:t,value:i})).sort((t,i)=>new Date(t.date)-new Date(i.date))}catch(s){return console.error("Error in getChartData:",s),[]}}function I(o){let n=0;for(const s in a.trainingLog){const e=a.trainingLog[s];for(const t of e){if(!t.completed)continue;const i=t.exercises?.[o];if(i?.sets){for(const r of i.sets)if(r.type===1){const c=T(r.reps,r.weight);c>n&&(n=c)}}}}return n}function P(o){const n=Object.keys(a.trainingLog).sort((s,e)=>new Date(e).getTime()-new Date(s).getTime());for(const s of n){const e=a.trainingLog[s];for(const t of e){if(!t.completed)continue;const i=t.exercises?.[o];if(!i?.sets)continue;let r=0;for(const c of i.sets)if(c.type===1){const g=T(c.reps,c.weight);g>r&&(r=g)}if(r>0)return r}}return 0}export{b as a,S as b,H as c,E as d,I as e,C as f,F as g,T as h,L as i,j,K as k,P as l,B as m,k as n,A as o,O as p,M as q,v as r};
