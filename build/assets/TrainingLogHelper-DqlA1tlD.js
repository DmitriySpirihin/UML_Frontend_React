import{A as a,aV as y}from"./index-DmK3efdH.js";function p(n){return new Date(n).toISOString().split("T")[0]}function S(n,o,s,e){if(!e||typeof n!="string"||typeof o!="number")return null;const t=s.getTime();let r=null,i=-1/0;for(const[c,g]of Object.entries(e)){const f=new Date(c).getTime();if(!(f>=t))for(const u of g){if(!u.completed)continue;const m=u.exercises?.[n];if(!m||!Array.isArray(m.sets))continue;const d=m.sets[o];!d||typeof d.reps!="number"||typeof d.weight!="number"||f>i&&(i=f,r={type:d.type,reps:d.reps,weight:d.weight,time:d.time})}}return r}async function L(n,o,s){const e=a.programs.find(g=>g.id===o);if(!e||!e.schedule[s])return console.error("Invalid program or dayIndex"),!1;const t={},r=[];e.schedule[s].exercises.forEach(g=>{const l=a.exercises.find(f=>f.id===g.exId);if(!l){console.warn(`Exercise ${g.exId} not found in AppData.exercises`);return}t[g.exId]={mgId:l.mgId,sets:[],totalTonnage:0,completed:!1},r.push(g.exId)});const i=p(n),c={programId:o,dayIndex:s,completed:!1,startTime:Date.now(),endTime:null,duration:0,tonnage:0,exercises:t,exerciseOrder:r};a.trainingLog[i]||(a.trainingLog[i]=[]),a.trainingLog[i].push(c),await y()}async function A(n,o,s,e,t){const r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=r.getTime()+e,c=r.getTime()+t,g=c-i,l={},f=[];a.programs.find(h=>h.id===o).schedule[s].exercises.forEach(h=>{const x=a.exercises.find(D=>D.id===h.exId);if(!x){console.warn(`Exercise ${h.exId} not found in AppData.exercises`);return}l[h.exId]={mgId:x.mgId,sets:[],totalTonnage:0,completed:!1},f.push(h.exId)});const m={programId:o,dayIndex:s,completed:!0,startTime:i,endTime:c,duration:g,tonnage:0,exercises:l,exerciseOrder:f},d=p(n);a.trainingLog[d]||(a.trainingLog[d]=[]),a.trainingLog[d].push(m),await y()}async function E(n,o){const s=p(n),e=a.trainingLog[s];if(!e||o<0||o>=e.length)return!1;e.splice(o,1),e.length===0&&delete a.trainingLog[s],await y()}function b(n,o){const s=p(n),e=a.trainingLog[s]?.[o];return!e||e.completed?!1:(e.endTime=Date.now(),e.duration=e.endTime-e.startTime,e.completed=!0,Object.values(e.exercises).map(t=>{t.completed=!0}),e.tonnage=Object.values(e.exercises).reduce((t,r)=>t+(r.totalTonnage||0),0),!0)}function O(n,o,s){const e=p(n),t=a.trainingLog[e]?.[o];return!t||t.exercises[s]?!1:(t.exercises[s]={mgId:a.exercises[s]?.mgId||0,sets:[],totalTonnage:0,completed:!1},t.exerciseOrder.push(s),!0)}function M(n,o,s){const e=p(n),t=a.trainingLog[e]?.[o];if(!t||!t.exercises[s])return!1;const r=t.exercises[s];return t.tonnage=Math.max(0,t.tonnage-(r.totalTonnage||0)),delete t.exercises[s],t.exerciseOrder&&(t.exerciseOrder=t.exerciseOrder.filter(i=>i!==s)),!0}function K(n,o,s,e,t,r,i){const c=p(n),g=a.trainingLog[c]?.[o],l=g?.exercises?.[s];if(!l)return!1;const u={type:i?0:1,reps:e,weight:t,time:r};l.sets.push(u);const m=e*t;return l.totalTonnage=(l.totalTonnage||0)+m,g.tonnage=(g.tonnage||0)+m,!0}function v(n,o,s,e,t,r,i,c){const g=p(n),l=a.trainingLog[g]?.[o],f=l?.exercises?.[s];if(!f||e<0||e>=f.sets.length)return!1;const u=f.sets[e],m=c?0:1;if(u.reps===t&&u.weight===r&&i===u.time&&u.type===m)return!0;const d=u.reps*u.weight;f.totalTonnage=Math.max(0,(f.totalTonnage||0)-d),l.tonnage=Math.max(0,(l.tonnage||0)-d),u.reps=t,u.weight=r,u.type=m;const h=t*r;return f.totalTonnage=(f.totalTonnage||0)+h,l.tonnage=(l.tonnage||0)+h,!0}function j(n,o,s){const e=p(n),r=a.trainingLog[e]?.[o]?.exercises?.[s];return r?(r.completed=!0,!0):!1}function k(n,o){const s=p(n);return a.trainingLog[s]?.[o]?.tonnage||0}function B(n,o){const s=p(n),e=a.trainingLog[s]?.[o];if(!e)return 0;let t=0;for(const r of Object.values(e.exercises))for(const i of r.sets)t+=i.reps;return t}function I(n,o){const s=p(n),e=a.trainingLog[s]?.[o];if(!e)return 0;let t=0;for(const r of Object.values(e.exercises))t+=r.sets.length;return t}function T(n,o){if(!n||!o||n<1||o<=0)return 0;if(n===1)return o;const s=o*(36/(37-n)),e=o*(1+.0333*n),t=o*Math.pow(n,.1),r=s+e+t;return Math.round(r/3)}function C(){const n=new Date;n.setMonth(n.getMonth()-2),n.setHours(0,0,0,0);const o=new Set;return Object.entries(a.trainingLog).forEach(([s,e])=>{new Date(s)>=n&&e.forEach(r=>{r.completed&&Object.entries(r.exercises).forEach(([i,c])=>{Array.isArray(c.sets)&&c.sets.length>0&&o.add(i)})})}),console.log(Array.from(o)),Array.from(o)}function F(n,o=!1){try{const s=new Date;s.setMonth(s.getMonth()-2),s.setHours(0,0,0,0);const e=new Map;return Object.entries(a.trainingLog).forEach(([t,r])=>{if(new Date(t)>=s){let c=0,g=0,l=!1;if(r.forEach(f=>{if(f.completed&&f.exercises?.[n]){const u=f.exercises[n];if(Array.isArray(u.sets)&&u.sets.length>0)if(l=!0,o)g+=u.totalTonnage||0;else{const m=Math.max(...u.sets.map(d=>d.weight||0));m>c&&(c=m)}}}),l){const f=o?g*.001:c;e.set(t,f)}}}),Array.from(e.entries()).map(([t,r])=>({date:t,value:r})).sort((t,r)=>new Date(t.date)-new Date(r.date))}catch(s){return console.error("Error in getChartData:",s),[]}}function H(n){let o=0;for(const s in a.trainingLog){const e=a.trainingLog[s];for(const t of e){const r=t.exercises?.[n];if(r?.sets)for(const i of r.sets){const c=T(i.reps,i.weight);c>o&&(o=c)}}}return o}function P(n){const o=Object.keys(a.trainingLog).sort((s,e)=>new Date(e).getTime()-new Date(s).getTime());for(const s of o){const e=a.trainingLog[s];for(const t of e){const r=t.exercises?.[n];if(!r?.sets)continue;let i=0;for(const c of r.sets){const g=T(c.reps,c.weight);g>i&&(i=g)}if(i>0)return i}}return 0}const V=()=>{try{const n=a?.trainingLog||{},o=new Date;let s=0;const e=[];for(let t=0;t<7;t++){const r=new Date(o);r.setDate(o.getDate()-t);const i=r.toISOString().split("T")[0];e.push(i)}for(const t of e){const r=n[t];if(Array.isArray(r)){const i=r.filter(c=>c.completed===!0).length;s+=i}}return Math.min(s,7)}catch(n){return console.warn("Error calculating weekly training amount:",n),0}};export{L as a,A as b,F as c,E as d,H as e,I as f,C as g,T as h,S as i,j,K as k,P as l,k as m,B as n,b as o,M as p,O as q,v as r,V as s};
