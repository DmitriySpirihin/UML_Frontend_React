import{r as o,t as G,l as q,f as he,A as f,E as T,G as Me,H as Ne,j as t,C as i,I as Oe,J as be,K as me,L as ye,O as Ve,P as J,Q as Ye,S as Ue,T as We,V as X,W as K,X as Ge,i as qe,k as Je,a as Z,Y}from"./index-Dqn_qtD2.js";import{I as Q,F as Xe,a as Ke,b as Qe}from"./HabitsMain-Ptv7VWZx.js";import{M as $}from"./MyInput-Bj1O9Ga_.js";import{S as _e}from"./Slider-DbnpteXf.js";import"./index-_2WTyGrd.js";const b=new Audio("Audio/Click.wav"),A=()=>Z.concat((f.CustomHabits||[]).filter(e=>!Z.some(c=>c.id===e.id))),w=new Date,ct=()=>{const[e,c]=o.useState(G.value),[d,u]=o.useState(q.value),[l,j]=o.useState(he.value),[C,H]=o.useState(!1),[x,ee]=o.useState(f.prefs[0]),[y,B]=o.useState(!1),[te,je]=o.useState(""),[Ce,z]=o.useState(!1),[S,se]=o.useState(""),[L,ne]=o.useState(""),[ie,oe]=o.useState(""),[ae,Se]=o.useState("default"),[le,ve]=o.useState(-1),[v,E]=o.useState(w.getFullYear()),[I,M]=o.useState(w.getMonth()+1),[D,k]=o.useState(w.getDate()),[U,re]=o.useState([]),[ce,W]=o.useState(""),[F,de]=o.useState(!1),[N,Ie]=o.useState(66),[xe,ue]=o.useState(A()),[De,pe]=o.useState(null),[O,fe]=o.useState(!1),[ke,ge]=o.useState(0),[Pe,Te]=o.useState("default"),[V,P]=o.useState(!1),g=(n,r)=>{r===2?k(a=>{const p=new Date(v,I,0).getDate();let h=a;return n?a<p&&new Date(v,I-1,a+1).getTime()<=w.getTime()&&(h=a+1):a>1&&(h=a-1),h}):r===1?M(a=>{let p=a;n?a<12&&new Date(v,a,D).getTime()<=w.getTime()&&(p=a+1):a>1&&(p=a-1);const h=new Date(v,p,0).getDate();return D>h&&k(h),p}):r===0&&E(a=>{let p=a;n?a<w.getFullYear()&&new Date(a+1,I-1,D).getTime()<=w.getTime()&&(p=a+1):a>w.getFullYear()-1&&(p=a-1);const h=new Date(p,I,0).getDate();return D>h&&k(h),p})},Ae=T(()=>g(!1,0)),He=T(()=>g(!0,0)),ze=T(()=>g(!1,1)),Le=T(()=>g(!0,1)),Fe=T(()=>g(!1,2)),Re=T(()=>g(!0,2)),$e=()=>{ce.length>0?(re(n=>[...n,ce]),W("")):Y(x===0?"Введите цель":"Enter goal",2e3,!1)},Be=n=>{re(r=>r.filter((a,p)=>p!==n))},Ee=[["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],["January","February","March","April","May","June","July","August","September","October","November","December"]];o.useEffect(()=>{const n=G.subscribe(c),r=q.subscribe(u),a=Me.subscribe(H),p=he.subscribe(j);return()=>{n.unsubscribe(),r.unsubscribe(),a.unsubscribe(),p.unsubscribe()}},[]),o.useEffect(()=>{const n=G.subscribe(c),r=q.subscribe(a=>{ee(a==="ru"?0:1)});return()=>{n.unsubscribe(),r.unsubscribe()}},[]),o.useEffect(()=>{ue(A())},[]),o.useEffect(()=>{const n=Ne.subscribe(je);return te==="AddHabitPanel"?setTimeout(()=>ge(1),400):ge(0),()=>{n.unsubscribe()}},[]);const R=(n,r)=>{n.length>0?r===0?se(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===1?ne(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===2?oe(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===3&&W(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===0?se(""):r===1?ne(""):r===2?oe(""):r===3&&W("")};return o.useEffect(()=>{S.length>3&&L.length>3?P(!0):P(!1)},[S,L,ie,ae,x]),t.jsxs("div",{style:{...s(e).container,transform:te==="AddHabitPanel"?"translateX(0)":"translateX(-100%)",backgroundColor:ke===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:[!y&&t.jsxs("div",{style:s(e,C).panel,children:[t.jsx("div",{style:s(e,!1,l).headerText,children:x===0?"добавь привычку":"add habit"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"90%"},children:[t.jsx(Oe,{style:{color:i.get("icons",e),fontSize:"16px",marginTop:"10px",marginLeft:"10px"}}),t.jsx($,{maxL:10,w:"70%",placeHolder:x===0?"поиск":"search",theme:e,onChange:n=>tt(n,xe,ue)})]}),t.jsx("div",{style:s(e).scrollView,children:xe.map(n=>!f.choosenHabits.includes(n.id)&&t.jsx("li",{style:{...s(e).text,borderRadius:"24px",backgroundColor:n.id===De?i.get("highlitedPanel",e):"transparent"},onClick:()=>{pe(n.id),ve(n.id),P(!0),m(b)},children:t.jsx("p",{style:s(e,!1,l).text,children:n.name[x]})},n.id))})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{me(""),ye(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B(!0),P(!1)},children:t.jsx(Ve,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{V&&(z(!0),m(b))},children:t.jsx(J,{style:{...s(e).miniIcon,color:V?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),y&&t.jsxs("div",{style:s(e,C).panel,children:[t.jsx("div",{style:s(e).headerText,children:x===0?"или создай свою":"or create your own"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh",justifyContent:"space-around",alignItems:"center"},children:[t.jsx($,{maxL:25,h:"15%",w:"90%",placeHolder:x===0?"имя":"name",theme:e,onChange:n=>R(n,0)}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"95%"},children:[t.jsx($,{maxL:25,h:"40%",w:"50%",placeHolder:x===0?"категория":"category",theme:e,onChange:n=>R(n,1),value:L}),t.jsx("select",{style:{...s(e,!1,l).input,width:"48%"},onChange:n=>R(n.target.value,1),children:Ze(e,x,l)})]}),t.jsx($,{maxL:100,h:"20%",w:"90%",placeHolder:x===0?"описание(опционально)":"description(optional)",theme:e,onChange:n=>R(n,2)}),t.jsx("div",{style:s(e,!1,l).headerText,children:x===0?"выбери иконку(опционально)":"choose icon(optional)"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{width:"80%",marginLeft:"30px",padding:"5px"},children:t.jsxs("div",{style:s(e).button,onClick:()=>fe(!O),children:[!O&&t.jsx(Ye,{style:s(e).miniIcon}),O&&t.jsx(Ue,{style:s(e).miniIcon})]})}),t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"20%",height:"100%",padding:"8px"},children:Q.getIcon(Pe,{size:48,style:{marginRight:"70px",color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{me(""),ye(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B(!1),P(!1),pe(null)},children:t.jsx(We,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{V&&(z(!0),m(b))},children:t.jsx(J,{style:{...s(e).miniIcon,color:V?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),O&&t.jsx("div",{style:s(e).selectPanel,children:Object.entries(Q.ic).map(([n])=>t.jsx("div",{style:{width:"15%",padding:"12px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"8px",transition:"background-color 0.2s",":hover":{backgroundColor:i.get("highlitedPanel",e)}},onClick:()=>{Te(n),Se(n),m(b),fe(!1),S.length>3&&L.length>3&&P(!0)},children:Q.getIcon(n,{size:32,style:{color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})},n))}),Ce&&t.jsx("div",{style:s(e).container,children:t.jsxs("div",{style:s(e).confirmationPanel,children:[t.jsx("p",{style:s(e,!1,l).text,children:st(x,y,le,S)}),t.jsxs("div",{style:{...s(e).simplePanelRow,flexDirection:"column",justifyContent:"space-between",alignItems:"center",backgroundColor:i.get("background",e),width:"90%",height:"80%",borderRadius:"24px"},children:[t.jsx("p",{style:s(e,!1,l).subtext,children:x===0?"установите дату":"set date"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Ae,onClick:()=>{g(!1,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(X,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",v," "]}),t.jsx("div",{...He,onClick:()=>{g(!0,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(K,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...ze,onClick:()=>{g(!1,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(X,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",Ee[x][I-1]," "]}),t.jsx("div",{...Le,onClick:()=>{g(!0,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(K,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Fe,onClick:()=>{g(!1,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(X,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",D," "]}),t.jsx("div",{...Re,onClick:()=>{g(!0,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(K,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsx("p",{style:s(e,!1,l).subtext,children:x===0?"(опционально) дополнительные цели":"(optional) additional goals"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%",flexDirection:"row",justifyContent:"space-around",alignItems:"center"},children:[t.jsx($,{w:"80%",h:"70%",maxL:50,placeHolder:x===0?"новая цель":"new goal",onChange:n=>R(n,3),clear:!0}),t.jsx(J,{style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},onClick:$e})]}),t.jsx("div",{style:{marginTop:"10px",width:"60%",display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",overflowY:"auto",height:"90%"},children:U.map((n,r)=>t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%",height:"20%"},children:[t.jsx("div",{style:s(e,!1,l).text,children:r+1+": "+n}),t.jsx(Ge,{style:{...s(e).miniIcon,fontSize:"14px",marginBottom:"20px",marginLeft:"auto"},onClick:()=>Be(r)})]},r))}),t.jsxs("div",{style:{marginTop:"5px",width:"70%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("p",{style:s(e,!1,l).subtext,children:x===0?"положительная привычка ?":"is positive ?"}),!F&&t.jsx(Xe,{onClick:()=>de(!0),style:{...s(e).miniIcon,fontSize:"20px",marginBottom:"5px"}}),F&&t.jsx(Ke,{onClick:()=>de(!1),style:{...s(e).miniIcon,fontSize:"20px",marginBottom:"5px"}})]}),t.jsx(_e,{style:s(e).slider,min:21,max:180,value:N,valueLabelDisplay:"auto",onChange:n=>Ie(n.target.value)}),t.jsx("div",{style:{...s(e,!1,l).subtext,marginTop:"5px",width:"90%"},children:nt(x,N,F)})]}),t.jsxs("div",{style:s(e).simplePanelRow,children:[t.jsx("div",{style:s(e).button,onClick:()=>{z(!1),_(k,M,E),m(b)},children:t.jsx(qe,{style:s(e).miniIcon})}),t.jsx("div",{style:s(e).button,onClick:()=>{const n=`${v}-${I.toString().padStart(2,"0")}-${D.toString().padStart(2,"0")}`,r=U.length>0?U.map(a=>({text:a,isDone:!1})):[];y?et(S,L,ie,ae,n,r,F,N):we(le,S,!1,n,r,F,N),m(b),z(!1),_(k,M,E),m(b),z(!1),_(k,M,E)},children:t.jsx(Je,{style:s(e).miniIcon})})]})]})})]})},Ze=(e,c,d)=>Array.from(new Set(Z.map(l=>l.category[c]))).map(l=>t.jsx("option",{value:l,style:{...s(e,!1,d).text},children:l},l)),we=(e,c,d,u,l,j,C)=>{if(f.IsHabitInChoosenList(e)){Y(f.prefs[0]===0?"привычка уже в списке":"habit already in list",2500,!1);return}Qe(e,u,l,j,C);const H=d?f.prefs[0]===0?`привычка: ${c} создана и добавлена`:`habit: ${c} was created and added`:f.prefs[0]===0?"привычка добавлена":"habit added";Y(H,2500,!0)},et=(e,c,d,u,l,j,C,H)=>{const x=A(),y=(x.length>0?Math.max(...x.map(B=>B.id)):0)+1;f.IsCustomHabitExists(y)?Y(f.prefs[0]===0?"привычка с таким названием уже существует":"habit with this name already exists",2500,!1):(f.AddCustomHabit(e,c,d,u,y),setTimeout(()=>{we(y,e,!0,l,j,C,H)},100))},tt=(e,c,d)=>{if(e.length>0){const u=A().filter(l=>l.name[f.prefs[0]].toLowerCase().startsWith(e.toLowerCase()));d(u)}else{const u=A();c.length!=u.length&&d(u)}},s=(e,c,d)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,padding:"20px"},panel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",overflow:"hidden",boxSizing:"border-box",overflowY:"scroll",border:`1px solid ${i.get("border",e)}`,margin:"5px",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:c?"85vh":"65vh"},confirmationPanel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,margin:"5px",marginBottom:"15vw",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:"170vw"},text:{textAlign:"center",fontSize:d?"13px":"15px",color:i.get("mainText",e),marginBottom:"12px"},subtext:{textAlign:"center",fontSize:d?"11px":"13px",color:i.get("subText",e),marginBottom:"12px"},textDate:{textAlign:"center",fontSize:"18px",color:i.get("mainText",e),marginBottom:"4px"},headerText:{textAlign:"center",margin:"5px",padding:"5px",fontSize:d?"13px":"15px",color:i.get("subText",e)},scrollView:{overflowY:"auto",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"},simplePanel:{marginLeft:"7.5vw",width:"70vw",height:"30vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch",background:"rgba(0, 0, 0, 0.1)",borderRadius:"24px"},input:{backgroundColor:i.get("simplePanel",e),width:"65vw",height:"3vh",borderBottom:`1px solid ${i.get("border",e)}`,borderRadius:"12px",margin:"12px",fontSize:d?"13px":"15px",fontFamily:"Segoe UI",color:i.get("subText",e)},simplePanelRow:{width:"75vw",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-around",userSelect:"none",touchAction:"none"},select:{width:"20vw",height:"6vw",borderRadius:"12px",border:`1px solid ${i.get("border",e)}`,marginTop:"12px",fontSize:d?"13px":"15px",color:i.get("subText",e),backgroundColor:i.get("habitCard",e)},selectOption:{color:i.get("subText",e),backgroundColor:i.get("habitCard",e),fontSize:d?"11px":"13px"},selectPanel:{backgroundColor:i.get("habitCard",e),borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexWrap:"wrap",width:"77vw",maxHeight:"42vh",overflowY:"auto",padding:"16px",gap:"8px",justifyContent:"center",zIndex:1e3},selectIcon:{flex:"{0,0,33.33%}",width:"20vw",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignContent:"center",justifyContent:"center",width:"15vw",marginTop:"12px",fontSize:"12px"},miniIcon:{fontSize:"28px",padding:"5px",marginTop:"10px",color:i.get("icons",e),userSelect:"none",touchAction:"none",filter:`drop-shadow(0 0px 1px ${i.get("iconsShadow",e)})`},slider:{width:"70%",userSelect:"none",touchAction:"none",color:i.get("icons",e)}});function m(e){f.prefs[2]==0&&e!==null&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),f.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}function st(e,c,d,u){if(c)return e===0?"добавить привычку "+u+"?":"add habit "+u+"?";{const l=A().find(j=>j.id===d).name[e];return e===0?"добавить привычку "+l+"?":"add habit "+l+"?"}}function nt(e,c,d){return d?e===0?"мне нужно "+c+" дней чтобы бросить привычку":"i need "+c+" days to quit":e===0?"мне нужно "+c+" дней для формирования привычки":"it takes "+c+" days to form a habit"}function _(e,c,d){const u=new Date;e(u.getDate()),c(u.getMonth()+1),d(u.getFullYear())}export{ct as default};
