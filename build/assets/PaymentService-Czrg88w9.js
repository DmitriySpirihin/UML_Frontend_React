import{U as i}from"./index-BsaS51Ip.js";const o="https://ultymylife.ru",{WebApp:l}=window.Telegram;async function p(r,t){try{const e=await s(r,t);if(!e.success||!e.confirmation?.confirmation_url||!e.paymentId)throw new Error("Invalid payment response: missing paymentId or URL");localStorage.setItem("pendingPaymentId",e.paymentId),window.Telegram?.WebApp?.openLink?window.Telegram.WebApp.openLink(e.confirmation.confirmation_url):window.open(e.confirmation.confirmation_url,"_blank")}catch(e){throw console.error("Failed to start payment:",e),e}}async function s(r,t){try{const e=await fetch(`${o}/api/sbp-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,plan:t})});if(!e.ok)throw new Error(`HTTP ${e.status}`);return await e.json()}catch(e){throw console.error("Network error in createSbpInvoice:",e),new Error("Network error: could not reach payment server")}}async function m(r,t){if(!window.Telegram?.WebApp){alert("Telegram Stars payments are only available inside Telegram.");return}try{const e=await fetch(`${o}/api/tg-stars-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,plan:t})});if(!e.ok){const a=await e.text();throw console.error("Stars API Error Body:",a),new Error(`Server returned status: ${e.status}`)}const n=await e.json();if(!n.success)throw new Error(n.error||"Failed to create Stars invoice");window.Telegram.WebApp.openTelegramLink(n.invoice_link)}catch(e){throw console.error("Stars payment error:",e),alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—á—ë—Ç Telegram Stars. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."),e}}async function w(r,t){try{const e=await fetch(`${o}/api/ton-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,plan:t})});if(!e.ok)throw new Error(`HTTP ${e.status}`);const n=await e.json();if(!n.success)throw new Error(n.error||"Failed to create TON invoice");return n}catch(e){throw console.error("TON fetch error:",e),e}}async function d(){if(!window.Telegram?.WebApp){alert("Available only in Telegram");return}const r=i.id;if(!r){alert("User ID not found");return}const e=`https://t.me/UltyMyLife_bot?start=${r}`;window.Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(e)}&text=${encodeURIComponent("–ü—Ä–∏–≤–µ—Ç! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ UltyMyLife –∏ –ø–æ–ª—É—á–∏–º –æ–±–∞ –ø–æ –º–µ—Å—è—Ü—É Premium –±–µ—Å–ø–ª–∞—Ç–Ω–æ! üéÅ")}`)}export{m as a,w as f,p as i,d as s};
