import{an as De,ao as Re,aP as re,j as e,A as z,t as ze,l as Ae,a3 as Be,f as Pe,C as n,m as u,aQ as Ee,a as V,aR as Fe,o as Me,af as X,aS as $e,a6 as le,M as de,aT as Le,aU as We,aV as Ne,a2 as Ge,aW as Ue,aX as Oe,aY as He,aZ as Ve,a_ as Xe,a$ as Ye}from"./index-BBPULZPZ.js";import{r}from"./recharts-k8ghPecL.js";import{b as ce,c as qe}from"./index-DTPqzpIO.js";import Qe from"./TrainingExercise-egwT4ahY.js";import{S as U}from"./ScrollPicker-BRrHYxZv.js";import"./index-CUNv7yal.js";const Ze=r.createContext(null);function _e(){const s=r.useRef(!1);return De(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function Je(){const s=_e(),[l,i]=r.useState(0),t=r.useCallback(()=>{s.current&&i(l+1)},[l]);return[r.useCallback(()=>Re.postRender(t),[t]),l]}const Ke=s=>!s.isLayoutDirty&&s.willUpdate(!1);function ie(){const s=new Set,l=new WeakMap,i=()=>s.forEach(Ke);return{add:t=>{s.add(t),l.set(t,t.addEventListener("willUpdate",i))},remove:t=>{s.delete(t);const x=l.get(t);x&&(x(),l.delete(t)),i()},dirty:i}}const xe=s=>s===!0,et=s=>xe(s===!0)||s==="id",tt=({children:s,id:l,inherit:i=!0})=>{const t=r.useContext(re),x=r.useContext(Ze),[a,j]=Je(),y=r.useRef(null),C=t.id||x;y.current===null&&(et(i)&&C&&(l=l?C+"-"+l:C),y.current={id:l,group:xe(i)&&t.group||ie()});const T=r.useMemo(()=>({...y.current,forceRender:a}),[j]);return e.jsx(re.Provider,{value:T,children:s})},ae=(s,l)=>{const i=[];for(let t=s;t<=l;t++)i.push(t);return i},ct=()=>{const[s,l]=r.useState(z.programs),i=()=>{l({...z.programs})},[t,x]=r.useState("dark"),[a,j]=r.useState(z.prefs[0]),[y,C]=r.useState(z.prefs[1]),[T,f]=r.useState(!1),[S,v]=r.useState(!1),[p,Y]=r.useState(-1),[b,A]=r.useState(-1),[$,L]=r.useState(""),[W,I]=r.useState(""),[q,pe]=r.useState(3),[w,Q]=r.useState(8),[k,Z]=r.useState(12),[h,_]=r.useState(0),[J,K]=r.useState(0),ue=r.useMemo(()=>ae(1,20),[]),ee=r.useMemo(()=>ae(1,100),[]),[nt,te]=r.useState(1),[se,ne]=r.useState(a===0?"День 1":"Day 1"),[ge,B]=r.useState(!1),[fe,N]=r.useState(!1),[ye,P]=r.useState(!1),[be,E]=r.useState(!1),[he,me]=r.useState(""),[je,oe]=r.useState(0);r.useEffect(()=>{w>k&&Z(w)},[w]),r.useEffect(()=>{k<w&&Q(k)},[k]),r.useEffect(()=>{const o=ze.subscribe(x),d=Ae.subscribe(D=>j(D==="ru"?0:1)),g=Be.subscribe(D=>f(D==="AddProgrammPanel")),m=Pe.subscribe(C);return()=>{o.unsubscribe(),d.unsubscribe(),g.unsubscribe(),m.unsubscribe()}},[]),r.useEffect(()=>{if(p===-1)return;const o=s[p];if(!o)return;const d=o.schedule.length;te(d),ne(a===0?`День ${d+1}`:`Day ${d+1}`)},[p,a,s]);const F=()=>{i(),v(!1),B(!1),P(!1)},Ce=()=>{Oe(R($),R(W)),L(""),I(""),F(),f(!1)},Se=()=>{Ue(p,R($),R(W)),L(""),I(""),F(),f(!1)},ve=()=>{He(p,R(se)),te(o=>o+1),F()},we=()=>{let o=a===0?"время":"time";h===0&&(o=q+"x"+w+"-"+k),Ye(p,b,J,o),E(!1),i()},G=o=>{oe(o);let d="";if(o===0){const g=s[p].name;d=a===0?`Удалить программу "${Array.isArray(g)?g[a]:g}"?`:`Delete program "${Array.isArray(g)?g[a]:g}"?`}else if(o===1){const g=s[p]?.schedule[b]?.name;d=a===0?`Удалить день "${g[a]}"?`:`Delete day "${g[a]}"?`}else{const g=s[p].schedule[b]?.exercises[J]?.exId;Le(p,b,g),i();return}me(d),P(!0)},ke=()=>{je===0?(Ve(p),Y(-1)):(Xe(p,b),A(-1)),F()},Te=o=>{v(!0),oe(o);{const d=s[p];L(Array.isArray(d.name)?d.name[a]:d.name),I(Array.isArray(d.description)?d.description[a]:d.description),f(!0)}},Ie={collapsed:{height:0,opacity:0,overflow:"hidden"},expanded:{height:"auto",opacity:1,transition:{duration:.3,ease:"easeInOut"}}};return e.jsxs("div",{style:c(t).container,children:[e.jsx(tt,{children:e.jsx("div",{style:{width:"100%",maxWidth:"600px",paddingBottom:"80px"},children:Object.entries(s).map(([o,d])=>({id:Number(o),...d})).filter(o=>o.show).sort((o,d)=>o.id-d.id).map(o=>{const d=p===o.id;return e.jsxs(u.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{...c(t).card,backgroundColor:d?n.get("trainingGroupSelected",t):n.get("background",t),border:`1px solid ${d?n.get("currentDateBorder",t):"transparent"}`},children:[e.jsxs(u.div,{onClick:()=>{Y(d?-1:o.id),A(-1)},style:c(t).groupHeader,whileTap:{scale:.98},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flex:1,gap:"15px"},children:[e.jsx("div",{style:c(t).iconBox,children:e.jsx(Ee,{size:20,color:d?"#fff":n.get("icons",t)})}),e.jsxs("div",{children:[e.jsx("p",{style:c(t,!1,!1,y).text,children:Array.isArray(o.name)?o.name[a]:o.name}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"4px"},children:[e.jsxs("span",{style:c(t).badge,children:[o.schedule.length," ",a===0?"дней":"days"]}),!d&&e.jsx("span",{style:{...c(t).badge,opacity:.6},children:o.creationDate})]})]})]}),e.jsx(u.div,{animate:{rotate:d?180:0},children:e.jsx(ce,{style:c(t).icon})})]}),e.jsx(V,{children:d&&e.jsx(u.div,{variants:Ie,initial:"collapsed",animate:"expanded",exit:"collapsed",style:{borderTop:`1px solid ${n.get("border",t)}`},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{style:{...c(t,!1,!1,y).subtext,marginBottom:"20px"},children:Array.isArray(o.description)?o.description[a]:o.description}),b===-1&&e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",overflowX:"auto",paddingBottom:"5px"},children:[e.jsx(O,{icon:e.jsx(Fe,{}),label:a===0?"День":"Day",onClick:()=>B(!0),theme:t}),e.jsx(O,{icon:e.jsx(Me,{}),label:a===0?"Правка":"Edit",onClick:()=>Te(0),theme:t}),e.jsx(O,{icon:e.jsx(X,{}),label:a===0?"Удалить":"Del",onClick:()=>G(0),theme:t,isDanger:!0})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:o.schedule.map((g,m)=>e.jsx(st,{index:m,day:g,active:b===m,onClick:()=>A(b===m?-1:m),theme:t,fSize:y,langIndex:a,onAddEx:()=>N(!0),onRemove:()=>{A(m),G(1)},onRemoveEx:D=>{K(D),G(2)}},m))}),e.jsx("div",{style:{marginTop:"25px",justifyItems:"center",padding:"15px",backgroundColor:t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"16px"},children:e.jsx($e,{programmId:o.id,theme:t,langIndex:a,programs:s})})]})})})]},o.id)})})}),p===-1&&e.jsx(u.button,{whileTap:{scale:.9},onClick:()=>{v(!1),f(!0)},style:c(t).bigFab,children:e.jsx(le,{size:24,color:"#FFF"})}),e.jsxs(V,{children:[T&&e.jsxs(M,{onClose:()=>f(!1),theme:t,title:a===0?S?"Редактировать":"Новая программа":S?"Edit Program":"New Program",children:[e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("input",{type:"text",placeholder:a===0?"Название":"Name",value:$,onChange:o=>I(o.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:n.get("mainText",t),marginLeft:"8px",outline:"none"}}),e.jsx("input",{type:"text",placeholder:a===0?"Описание":"Description",value:W,onChange:o=>I(o.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:n.get("mainText",t),marginLeft:"8px",outline:"none"}})]}),e.jsx(H,{onClose:()=>f(!1),onConfirm:()=>S?Se():Ce(),theme:t})]}),ge&&e.jsxs(M,{onClose:()=>B(!1),theme:t,title:a===0?"Тренировочный день":"Training Day",children:[e.jsx("input",{type:"text",placeholder:a===0?"Название дня":"Day Name",value:se,onChange:o=>ne(o.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:n.get("mainText",t),marginLeft:"8px",outline:"none"}}),e.jsx(H,{onClose:()=>B(!1),onConfirm:ve,theme:t})]}),ye&&e.jsxs(M,{onClose:()=>P(!1),theme:t,title:"⚠️",children:[e.jsx("p",{style:{...c(t,!1,!1,y).text,textAlign:"center",marginBottom:"25px"},children:he}),e.jsxs("div",{style:{display:"flex",gap:"20px",width:"100%",justifyContent:"center"},children:[e.jsx(u.button,{whileTap:{scale:.95},onClick:()=>P(!1),style:c(t).secondaryBtn,children:a===0?"Нет":"Cancel"}),e.jsx(u.button,{whileTap:{scale:.95},onClick:ke,style:c(t).dangerBtn,children:a===0?"Удалить":"Delete"})]})]}),be&&e.jsxs(M,{onClose:()=>E(!1),theme:t,title:a===0?"Стратегия":"Strategy",children:[e.jsxs("div",{style:c(t).segmentedControl,children:[e.jsx("div",{onClick:()=>_(0),style:{...c(t).segment,backgroundColor:h===0?n.get("difficulty",t):"transparent",color:h===0?n.get("mainText",t):n.get("subText",t),boxShadow:h===0?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Повторы":"Reps"}),e.jsx("div",{onClick:()=>_(1),style:{...c(t).segment,backgroundColor:h===1?n.get("difficulty",t):"transparent",color:h===1?n.get("mainText",t):n.get("subText",t),boxShadow:h===1?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Время":"Time"})]}),h===0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",margin:"20px 0"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:n.get("subText",t),marginBottom:"5px"},children:"SETS"}),e.jsx(U,{items:ue,value:q,onChange:pe,theme:t,width:"60px"})]}),e.jsx("span",{style:{fontSize:"20px",color:n.get("subText",t),marginTop:"15px"},children:"×"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:n.get("subText",t),marginBottom:"5px"},children:"MIN"}),e.jsx(U,{items:ee,value:w,onChange:Q,theme:t,width:"60px"})]}),e.jsx("span",{style:{fontSize:"20px",color:n.get("subText",t),marginTop:"15px"},children:"-"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:n.get("subText",t),marginBottom:"5px"},children:"MAX"}),e.jsx(U,{items:ee,value:k,onChange:Z,theme:t,width:"60px"})]})]}),e.jsx(H,{onClose:()=>E(!1),onConfirm:we,theme:t})]})]}),fe&&e.jsxs("div",{style:c(t).fullOverlay,children:[e.jsx(Qe,{needToAdd:!0,setEx:o=>{K(o),N(!1),E(!0)}}),e.jsx(u.div,{whileTap:{scale:.9},onClick:()=>N(!1),style:c(t).closeOverlayBtn,children:e.jsx(de,{size:24,color:"#FFF"})})]})]})},st=({index:s,day:l,active:i,onClick:t,theme:x,fSize:a,langIndex:j,onAddEx:y,onRemove:C,onRemoveEx:T})=>e.jsxs(u.div,{layout:!0,onClick:t,style:{...c(x).card,backgroundColor:i?x==="light"?"#fff":"rgba(255,255,255,0.05)":"transparent",border:i?`1px solid ${n.get("border",x)}`:"1px solid transparent",marginBottom:"0",boxShadow:i&&x==="light"?"0 4px 12px rgba(0,0,0,0.05)":"none"},children:[e.jsxs("div",{style:{padding:"12px 15px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"12px",color:n.get("subText",x)},children:i?e.jsx(qe,{}):e.jsx(ce,{})}),e.jsx(We,{style:{color:n.get("currentDateBorder",x)},size:16}),e.jsx("span",{style:{fontWeight:"600",color:n.get("mainText",x),flex:1,fontSize:"15px"},children:j===0?`${l.name[0]}`:`${l.name[1]}`}),i&&e.jsxs("div",{style:{display:"flex",gap:"10px"},onClick:f=>f.stopPropagation(),children:[e.jsx(u.div,{whileTap:{scale:.9},onClick:y,style:c(x).miniBtn,children:e.jsx(le,{size:12,color:"#fff"})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:C,style:{...c(x).miniBtn,backgroundColor:"rgba(255, 77, 77, 0.2)"},children:e.jsx(X,{size:12,color:"#ff4d4d"})})]})]}),e.jsx(V,{children:i&&e.jsx(u.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsxs("div",{style:{padding:"0 15px 15px",display:"flex",flexDirection:"column",gap:"8px"},children:[l.exercises.map((f,S)=>{const v=z.exercises[f.exId];return v?e.jsxs("div",{style:c(x).exerciseRow,children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:n.get("mainText",x)},children:v.name[j]}),e.jsxs("div",{style:{fontSize:"12px",color:n.get("subText",x),display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Ne,{size:10})," ",f.sets]})]})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:p=>{p.stopPropagation(),T(S)},style:{padding:"8px",opacity:.6},children:e.jsx(X,{color:"#ff4d4d",size:14})})]},S):null}),l.exercises.length===0&&e.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:n.get("subText",x),padding:"10px"},children:j===0?"Нет упражнений":"No exercises"})]})})})]}),O=({icon:s,onClick:l,theme:i,label:t,isDanger:x})=>e.jsxs(u.div,{whileTap:{scale:.95},onClick:l,style:{flex:1,padding:"8px 12px",borderRadius:"12px",minWidth:"80px",backgroundColor:x?"rgba(255, 77, 77, 0.1)":i==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",color:x?"#ff4d4d":n.get("subText",i),display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",cursor:"pointer"},children:[s,e.jsx("span",{style:{fontSize:"10px",fontWeight:"700",opacity:.8,textTransform:"uppercase"},children:t})]}),M=({children:s,title:l,theme:i,onClose:t})=>e.jsx("div",{style:c(i).modalBackdrop,onClick:t,children:e.jsxs(u.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95},style:c(i).modalContainer,onClick:x=>x.stopPropagation(),children:[e.jsx("div",{style:c(i).modalHeader,children:e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",color:n.get("mainText",i),margin:0},children:l})}),e.jsx("div",{style:{width:"100%",padding:"0 20px",display:"flex",flexDirection:"column",alignItems:"center"},children:s})]})}),H=({onClose:s,onConfirm:l,theme:i})=>e.jsxs("div",{style:c(i).modalActions,children:[e.jsx(u.div,{whileTap:{scale:.9},onClick:s,style:c(i).circleBtn,children:e.jsx(de,{style:{fontSize:"24px",color:n.get("subText",i)}})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:l,style:{...c(i).circleBtn,backgroundColor:n.get("done",i)},children:e.jsx(Ge,{style:{fontSize:"24px",color:"#fff"}})})]}),R=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"",c=(s,l,i,t)=>({container:{backgroundColor:n.get("background",s),display:"flex",flexDirection:"column",overflowY:"auto",alignItems:"center",height:"90vh",paddingTop:"20px",width:"100vw",marginTop:"110px",fontFamily:"Segoe UI, Roboto, sans-serif",boxSizing:"border-box"},card:{width:"94%",margin:"0 auto 12px auto",borderRadius:"16px",overflow:"hidden",boxShadow:s==="light"?"0 2px 8px rgba(0,0,0,0.05)":"none"},groupHeader:{display:"flex",flexDirection:"row",padding:"15px",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},iconBox:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:n.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center"},badge:{fontSize:"10px",fontWeight:"700",padding:"2px 8px",borderRadius:"6px",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:n.get("subText",s),textTransform:"uppercase"},text:{fontSize:t===0?"16px":"18px",color:n.get("mainText",s),fontWeight:"600",margin:0},subtext:{fontSize:t===0?"13px":"15px",color:n.get("subText",s),lineHeight:"1.4",margin:0},icon:{fontSize:"20px",color:n.get("icons",s)},exerciseRow:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",borderRadius:"12px",backgroundColor:s==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",border:`1px solid ${n.get("border",s)}`},exerciseIcon:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},bigFab:{position:"fixed",bottom:"110px",right:"30px",width:"56px",height:"56px",borderRadius:"28px",backgroundColor:n.get("difficulty",s),border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 20px rgba(0,0,0,0.3)",cursor:"pointer",zIndex:100},miniBtn:{width:"24px",height:"24px",borderRadius:"8px",backgroundColor:n.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},circleBtn:{width:"50px",height:"50px",borderRadius:"25px",backgroundColor:n.get("skipped",s),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},secondaryBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:n.get("mainText",s),fontSize:"16px",cursor:"pointer"},dangerBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:"#ff4d4d",color:"#fff",fontSize:"16px",cursor:"pointer"},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},modalContainer:{width:"99%",maxWidth:"400px",backgroundColor:n.get("background",s),borderRadius:"24px",boxShadow:"0 20px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",alignItems:"center",border:`1px solid ${n.get("border",s)}`,overflow:"hidden"},modalHeader:{width:"100%",padding:"20px",borderBottom:`1px solid ${n.get("border",s)}`,textAlign:"center",marginBottom:"15px"},modalActions:{marginTop:"20px",padding:"15px 20px",width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",borderTop:`1px solid ${n.get("border",s)}`,backgroundColor:s==="light"?"rgba(0,0,0,0.02)":"rgba(255,255,255,0.02)"},segmentedControl:{display:"flex",width:"100%",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"4px",margin:"10px 0"},segment:{flex:1,textAlign:"center",padding:"8px",borderRadius:"10px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},fullOverlay:{position:"fixed",inset:0,backgroundColor:n.get("background",s),zIndex:6e3},closeOverlayBtn:{position:"fixed",top:"20px",right:"20px",zIndex:6001,width:"40px",height:"40px",borderRadius:"20px",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}});export{ct as default};
