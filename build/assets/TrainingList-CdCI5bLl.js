import{A as y,t as ne,l as se,f as ie,j as t,C as d,m as w,ae as P,d as A}from"./index-CHg4mtf-.js";import{r as x}from"./recharts-k8ghPecL.js";import{b as re}from"./index-DpA3OXT7.js";const ae=(e,a)=>{const s=new Date(e),m={weekday:"long"},g=a===0?"ru-RU":"en-US";return s.toLocaleDateString(g,m)},O=e=>{const a=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return`${a}:${s.toString().padStart(2,"0")}`},oe=(e,a)=>{const s=e.duration/1e3,m=e.distance||0;let g="",N="";if(e.type==="RUNNING"||e.type==="SWIMMING"){if(m>0&&s>0){if(e.type==="RUNNING"){const u=s/m,T=Math.floor(u/60),p=Math.floor(u%60);g=a===0?`${T}:${p.toString().padStart(2,"0")} /ÐºÐ¼`:`${T}:${p.toString().padStart(2,"0")} min/km`}else if(e.type==="SWIMMING"){const u=s/m*100,T=Math.floor(u/60),p=Math.floor(u%60);g=a===0?`${T}:${p.toString().padStart(2,"0")} /100Ð¼`:`${T}:${p.toString().padStart(2,"0")} min/100m`}}}else if(e.type==="CYCLING"&&m>0&&s>0){const u=m*3600/s;N=a===0?`${u.toFixed(1)} ÐºÐ¼/Ñ‡`:`${u.toFixed(1)} km/h`}return{paceDisplay:g,speedDisplay:N}},H=(e,a,s)=>a?e==="SWIMMING"?s===0?`${Math.round(a)} Ð¼`:`${Math.round(a)} m`:s===0?`${a.toFixed(1)} ÐºÐ¼`:`${a.toFixed(1)} km`:"",le=(e,a)=>{const s={GYM:a===0?"Ð¡Ð¸Ð»Ð¾Ð²Ð°Ñ":"Gym",RUNNING:a===0?"Ð‘ÐµÐ³":"Running",CYCLING:a===0?"Ð’ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´":"Cycling",SWIMMING:a===0?"ÐŸÐ»Ð°Ð²Ð°Ð½Ð¸Ðµ":"Swimming",OTHER:a===0?"Ð¢Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ°":"Training"};return s[e]||s.OTHER},U={RUNNING:"#ff416c",CYCLING:"#38ef7d",SWIMMING:"#00c6ff",OTHER:"#a8a8a8"},E=["#00c6ff","#0072ff","#ff416c","#ff4b2b","#38ef7d","#11998e","#f09819","#edde5d","#834d9b","#d04ed6","#1d976c","#93f9b9","#5d29c3","#a968f2","#ff7e5f","#feb47b","#2af598","#009efd","#ff6b6b","#ffa500","#114357","#f29492","#43e97b","#38f9d7","#92fe9d","#00c9ff","#2c3e50","#3498db","#c33764","#1d2671","#ff9a9e","#fecfef","#a8ff78","#78ffd6","#b993d6","#8ca6db","#ff758c","#ff7eb3","#4facfe","#00f2fe"],ge=()=>{const[e,a]=x.useState("dark"),[s,m]=x.useState(y.prefs[0]==="ru"?0:1),[g,N]=x.useState(y.prefs[1]),[u,T]=x.useState(null),[p,L]=x.useState(0),[b,D]=x.useState(0),[W,B]=x.useState(0),[j,K]=x.useState("all");x.useEffect(()=>{const r=ne.subscribe(a),o=se.subscribe(l=>m(l==="ru"?0:1));return()=>{o.unsubscribe(),r.unsubscribe()}},[]),x.useEffect(()=>{const r=ie.subscribe(N);return()=>r.unsubscribe()},[]),x.useEffect(()=>{j!=="all"&&j!=="GYM"&&L(0)},[j]);const{allTrainings:Y,sessionColorMap:V}=x.useMemo(()=>{const r=[],o=new Map;let l=0;for(const[n,c]of Object.entries(y.trainingLog||{}))c.forEach((S,M)=>{const R=S.type||(S.programId!==void 0||S.exercises?"GYM":"OTHER");r.push({date:n,idx:M,session:{...S,type:R}})});return r.sort((n,c)=>(c.session.startTime||0)-(n.session.startTime||0)),r.forEach(({session:n})=>{if(n.type==="GYM"){const c=`${n.programId||0}-${n.dayIndex||0}`;o.has(c)||(o.set(c,E[l%E.length]),l++)}}),{allTrainings:r.filter(n=>{const c=n.session;if(j!=="all"&&c.type!==j)return!1;if(c.type==="GYM"){if(p===1)return c.programId===b;if(p===2)return c.programId===b&&c.dayIndex===W}return!0}),sessionColorMap:o}},[y.trainingLog,p,b,W,j]),G=x.useMemo(()=>{const r=new Set;return Object.values(y.trainingLog||{}).forEach(o=>o.forEach(l=>{(l.type||"GYM")==="GYM"&&l.programId!==void 0&&r.add(l.programId)})),Array.from(r).map(o=>{const l=y.programs[o];return{id:o,name:l?.name?.[s]||`Program ${o}`}}).sort((o,l)=>o.name.localeCompare(l.name))},[s]),I=x.useMemo(()=>{if(p!==2||b==null)return[];const o=y.programs[b]?.schedule||[];return o.map((l,v)=>({index:v,name:o[v]?.name?.[s]||`Day ${v+1}`}))},[p,b,s]);x.useEffect(()=>{(p===1||p===2)&&G.length>0&&b===0&&D(G[0].id),p===2&&I.length>0&&B(I[0].index)},[p,G,I,b]);const _=s===0?"Ð’ÑÐµ":"All",q=s===0?"ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°":"Program",J=s===0?"Ð”ÐµÐ½ÑŒ":"Day",Q={all:s===0?"Ð’ÑÐµ Ñ‚Ð¸Ð¿Ñ‹":"All Types",GYM:s===0?"Ð¡Ð¸Ð»Ð¾Ð²Ñ‹Ðµ":"Gym",RUNNING:s===0?"Ð‘ÐµÐ³":"Running",CYCLING:s===0?"Ð’ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´":"Cycling",SWIMMING:s===0?"ÐŸÐ»Ð°Ð²Ð°Ð½Ð¸Ðµ":"Swimming"},X=x.useMemo(()=>{const r=new Set(["all","GYM"]);return Object.values(y.trainingLog||{}).forEach(o=>o.forEach(l=>{const v=l.type||(l.programId!==void 0?"GYM":"OTHER");["RUNNING","CYCLING","SWIMMING"].includes(v)&&r.add(v)})),Array.from(r)},[y.trainingLog]);return t.jsxs("div",{style:i(e).container,children:[t.jsx("div",{style:i(e).typeFilterContainer,children:t.jsx("div",{style:i(e).typeToggleWrapper,children:X.map(r=>{const o=j===r;return t.jsx(w.div,{onClick:()=>K(r),whileTap:{scale:.95},style:{...i(e).typeTogglePill,backgroundColor:o?d.get("currentDateBorder",e):"transparent",color:o?"#fff":d.get("subText",e),fontSize:g===0?"13px":"14px"},children:Q[r]||r},r)})})}),(j==="all"||j==="GYM")&&t.jsxs("div",{style:i(e).filterContainer,children:[t.jsx("div",{style:i(e).toggleWrapper,children:[{key:0,label:_},{key:1,label:q},{key:2,label:J}].map(({key:r,label:o})=>{const l=p===r;return t.jsx(w.div,{onClick:()=>L(r),whileTap:{scale:.95},style:{...i(e).togglePill,backgroundColor:l?d.get("currentDateBorder",e):"transparent",color:l?"#fff":d.get("subText",e),fontSize:g===0?"13px":"14px"},children:o},r)})}),t.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},children:[(p===1||p===2)&&t.jsxs("div",{style:i(e).selectWrapper,children:[t.jsx("select",{value:b,onChange:r=>{const o=Number(r.target.value);D(o),p===2&&I.length>0&&B(I[0]?.index||0)},style:i(e).select,children:G.map(r=>t.jsx("option",{value:r.id,children:r.name},r.id))}),t.jsx(P,{style:i(e).selectIcon})]}),p===2&&t.jsxs("div",{style:i(e).selectWrapper,children:[t.jsx("select",{value:W,onChange:r=>B(Number(r.target.value)),style:i(e).select,children:I.map(r=>t.jsx("option",{value:r.index,children:r.name},r.index))}),t.jsx(P,{style:i(e).selectIcon})]})]})]}),t.jsx("div",{style:{width:"100%",maxWidth:"800px",paddingBottom:"50px"},children:Y.length>0?t.jsx(A,{children:Y.map((r,o)=>{const{date:l,idx:v,session:n}=r,c=`${l}-${v}`,S=u===c;let M;if(n.type==="GYM"){const f=`${n.programId||0}-${n.dayIndex||0}`;M=V.get(f)||E[0]}else M=U[n.type]||U.OTHER;let R="",$="";if(n.type==="GYM"){const f=y.programs[n.programId||0],h=f?.name?.[s]||`Program ${n.programId||0}`,k=f?.schedule?.[n.dayIndex||0]?.name?.[s]||`Day ${n.dayIndex+1}`;R=h,$=k}else R=le(n.type,s),$=H(n.type,n.distance,s);return t.jsxs(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:o*.05,duration:.3},style:{...i(e).card,borderLeft:`5px solid ${M}`},children:[t.jsxs("div",{onClick:()=>T(S?null:c),style:{...i(e).cardHeader,cursor:"pointer"},children:[t.jsxs("div",{style:{flex:1,padding:"12px 0 12px 16px"},children:[t.jsxs("div",{style:{...i(e,g).dateText},children:[l," â€¢ ",t.jsx("span",{style:{opacity:.8},children:ae(l,s)})]}),t.jsxs("div",{style:i(e,g).programText,children:[R," ",$&&t.jsxs("span",{children:["â€¢ ",$]})]})]}),t.jsx("div",{style:{padding:"0 16px",display:"flex",alignItems:"center"},children:t.jsx(w.div,{animate:{rotate:S?180:0},children:t.jsx(re,{size:18,color:d.get("subText",e)})})})]}),t.jsx(A,{children:S&&t.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:t.jsx("div",{style:i(e).expandedContent,children:n.type==="GYM"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:i(e).statsRow,children:[t.jsxs("div",{style:i(e).statBadge,children:["â± ",O(n.duration||0)]}),t.jsxs("div",{style:i(e).statBadge,children:["ðŸ‹ï¸ ",(n.tonnage/1e3).toFixed(2)," ",s===0?"Ñ‚":"t"]}),n.RPE&&t.jsxs("div",{style:i(e).statBadge,children:["RPE ",n.RPE]})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Object.entries(n.exercises||{}).filter(([f,h])=>h?.sets?.length>0).map(([f,h])=>{const k=parseInt(f,10),Z=y.exercises[k]?.name?.[s]||`Exercise ${f}`;return t.jsxs("div",{style:i(e).exerciseBlock,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"6px"},children:[t.jsx("span",{style:i(e,g).exerciseTitle,children:Z}),t.jsxs("span",{style:i(e).tonnageSub,children:[(h.totalTonnage/1e3).toFixed(2)," ",s===0?"Ñ‚":"t"]})]}),t.jsx("div",{style:i(e).setsGrid,children:h.sets.map((C,z)=>{const F=C.type===0,ee=F?d.get("trainingIsolatedFont",e):d.get("trainingBaseFont",e),te=F?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.0)";return t.jsxs("div",{style:{...i(e).setRow,backgroundColor:te,color:ee,fontSize:g===0?"13px":"15px"},children:[t.jsx("span",{style:{opacity:.6,fontSize:"11px",marginRight:"6px"},children:z+1}),t.jsx("span",{style:{fontWeight:"600"},children:C.weight}),t.jsx("span",{style:{fontSize:"11px",margin:"0 2px"},children:s===0?"ÐºÐ³":"kg"}),t.jsx("span",{style:{margin:"0 4px",opacity:.5},children:"Ã—"}),t.jsx("span",{style:{fontWeight:"600"},children:C.reps}),C.time!=null&&C.time>0&&t.jsxs("span",{style:{marginLeft:"6px",fontSize:"11px",opacity:.8},children:["(",Math.round(C.time/1e3),"s)"]})]},z)})})]},f)})}),n.note&&t.jsxs("div",{style:i(e).noteBlock,children:[t.jsx("div",{style:i(e).noteLabel,children:s===0?"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°:":"Note:"}),t.jsx("div",{style:i(e).noteText,children:n.note})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:i(e).statsRow,children:[t.jsxs("div",{style:i(e).statBadge,children:["â± ",O(n.duration||0)]}),n.distance&&t.jsxs("div",{style:i(e).statBadge,children:["ðŸ“ ",H(n.type,n.distance,s)]}),n.elevationGain>0&&t.jsxs("div",{style:i(e).statBadge,children:["â›°ï¸ ",n.elevationGain," ",s===0?"Ð¼":"m"]}),n.avgHeartRate>0&&t.jsxs("div",{style:i(e).statBadge,children:["â¤ï¸ ",n.avgHeartRate," bpm"]})]}),(()=>{const{paceDisplay:f,speedDisplay:h}=oe(n,s);return f||h?t.jsxs("div",{style:i(e).statRow,children:[f&&t.jsxs("div",{children:[t.jsx("div",{style:i(e).statLabel,children:s===0?"Ð¢ÐµÐ¼Ð¿:":"Pace:"}),t.jsx("div",{style:i(e).statValue,children:f})]}),h&&t.jsxs("div",{children:[t.jsx("div",{style:i(e).statLabel,children:s===0?"Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ:":"Speed:"}),t.jsx("div",{style:i(e).statValue,children:h})]})]}):null})(),(n.avgCadence>0||n.RPE)&&t.jsxs("div",{style:i(e).statsRow,children:[n.avgCadence>0&&t.jsxs("div",{style:i(e).statBadge,children:["ðŸš´ ",n.avgCadence," ",s===0?"Ð¾Ð±/Ð¼Ð¸Ð½":"rpm"]}),n.RPE&&t.jsxs("div",{style:i(e).statBadge,children:["RPE ",n.RPE]})]}),n.note&&t.jsxs("div",{style:i(e).noteBlock,children:[t.jsx("div",{style:i(e).noteLabel,children:s===0?"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°:":"Note:"}),t.jsx("div",{style:i(e).noteText,children:n.note})]})]})})})})]},c)})}):t.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},style:{padding:"40px 20px",color:d.get("subText",e),fontSize:g===0?"14px":"16px",textAlign:"center",fontStyle:"italic"},children:s===0?"Ð¢Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹":"No trainings found"})})]})},i=(e,a)=>({container:{backgroundColor:d.get("background",e),display:"flex",flexDirection:"column",alignItems:"center",height:"89vh",marginTop:"120px",width:"100vw",fontFamily:"Segoe UI, Roboto, sans-serif",overflowY:"auto",boxSizing:"border-box",padding:"0 10px"},typeFilterContainer:{width:"100%",maxWidth:"600px",display:"flex",justifyContent:"center",marginBottom:"15px",padding:"0 10px"},typeToggleWrapper:{display:"flex",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",padding:"4px",borderRadius:"25px",width:"100%",maxWidth:"500px",justifyContent:"space-between",flexWrap:"wrap",gap:"4px"},typeTogglePill:{flex:"1 1 auto",textAlign:"center",padding:"8px 4px",borderRadius:"20px",cursor:"pointer",fontWeight:"500",minWidth:"80px",transition:"all 0.2s ease",whiteSpace:"nowrap"},filterContainer:{width:"100%",maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",marginBottom:"20px",padding:"0 10px"},toggleWrapper:{display:"flex",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",padding:"4px",borderRadius:"25px",width:"100%",justifyContent:"space-between"},togglePill:{flex:1,textAlign:"center",padding:"8px 0",borderRadius:"20px",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},selectWrapper:{position:"relative",width:"100%"},select:{width:"100%",padding:"12px 16px",borderRadius:"12px",border:"none",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",color:d.get("mainText",e),fontSize:a===0?"14px":"16px",appearance:"none",outline:"none",cursor:"pointer"},selectIcon:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",color:d.get("subText",e),fontSize:"12px",pointerEvents:"none"},card:{width:"100%",backgroundColor:e==="light"?"#fff":"rgba(255,255,255,0.03)",borderRadius:"16px",marginBottom:"12px",boxShadow:e==="light"?"0 2px 10px rgba(0,0,0,0.05)":"none",border:`1px solid ${e==="light"?"transparent":"rgba(255,255,255,0.05)"}`,overflow:"hidden"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"center"},dateText:{fontSize:a===0?"16px":"18px",fontWeight:"bold",color:d.get("mainText",e),marginBottom:"4px"},programText:{fontSize:a===0?"13px":"14px",color:d.get("subText",e),fontWeight:"500"},expandedContent:{padding:"0 16px 16px 16px",borderTop:`1px solid ${d.get("border",e)}`,marginTop:"0px",paddingTop:"12px",backgroundColor:e==="light"?"rgba(0,0,0,0.01)":"rgba(0,0,0,0.1)"},statsRow:{display:"flex",flexWrap:"wrap",gap:"8px 12px",marginBottom:"16px"},statRow:{display:"flex",gap:"20px",marginBottom:"12px",padding:"8px 0"},statLabel:{fontSize:"12px",color:d.get("subText",e),marginBottom:"4px"},statValue:{fontSize:a===0?"16px":"18px",fontWeight:"bold",color:d.get("mainText",e)},statBadge:{backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",padding:"4px 10px",borderRadius:"8px",fontSize:"12px",color:d.get("mainText",e),fontWeight:"600",whiteSpace:"nowrap"},exerciseBlock:{marginBottom:"8px",paddingBottom:"8px",borderBottom:`1px dashed ${d.get("border",e)}`},exerciseTitle:{color:d.get("mainText",e),fontWeight:"600",fontSize:a===0?"14px":"16px"},tonnageSub:{fontSize:"11px",color:d.get("subText",e),fontWeight:"bold"},setsGrid:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},setRow:{display:"flex",alignItems:"center",padding:"4px 8px",borderRadius:"6px",backgroundColor:e==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.03)"},noteBlock:{marginTop:"12px",padding:"12px",backgroundColor:e==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"10px",borderLeft:`3px solid ${d.get("subText",e)}`},noteLabel:{fontSize:"12px",color:d.get("subText",e),marginBottom:"4px",fontWeight:"500"},noteText:{fontSize:a===0?"13px":"14px",color:d.get("mainText",e),lineHeight:1.4}});export{ge as default};
