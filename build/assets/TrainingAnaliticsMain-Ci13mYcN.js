import{j as e,C as p,A as m,t as A,l as N,f as Y,bo as ce,bp as de,a as _,m as T,bq as xe,M as ie,b8 as pe,af as ge,br as ue,U as fe,p as he,k as ye,F as be}from"./index-DGPlUMvs.js";import{h as U,P as me,i as je,C as ve,L as Se,T as V,j as Ce,k as we,l as ke,m as Te,n as De,r as h,o as Re,p as Ie,B as Me,q as Be,X as Fe,Y as ze,s as ee,R as Le}from"./recharts-Bg6K2Pzo.js";import{V as $e}from"./TrainingAnaliticsTabs-C0zuC95A.js";import{j as Ae,k as We,d as Ee,l as Oe}from"./index-Dvzr8BDx.js";const Pe=[["Лёгкая","Light"],["Средняя","Medium"],["Тяжёлая","Heavy"]];function He({data:t,theme:s,totalTonnage:n,sessionCount:i,langIndex:a=0}){const o=t.reduce((c,f)=>c+f.value,0),d=s==="light",r={mainText:d?"#111827":"#F9FAFB",subText:d?"#6B7280":"#9CA3AF",border:d?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)",tooltipBg:d?"rgba(255,255,255,0.9)":"rgba(30,30,30,0.9)",pillBg:d?"rgba(0,0,0,0.06)":"rgba(255,255,255,0.08)",segments:["#4ADE80","#FACC15","#F87171"]},x=(n/1e3).toFixed(1),l=a===0?`${i} ${Ge(i)}`:`${i} workout${i!==1?"s":""}`,u=t.map((c,f)=>({...c,name:Pe[f]?.[a]||`Group ${f}`,color:r.segments[f],percent:o>0?(c.value/o*100).toFixed(0):0})),g=({active:c,payload:f})=>{if(c&&f&&f.length){const y=f[0].payload;return e.jsxs("div",{style:{backgroundColor:r.tooltipBg,backdropFilter:"blur(10px)",padding:"8px 12px",borderRadius:"12px",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",border:`1px solid ${r.border}`},children:[e.jsx("p",{style:{margin:0,fontSize:"13px",fontWeight:"600",color:y.color},children:y.name}),e.jsxs("p",{style:{margin:0,fontSize:"12px",color:r.mainText},children:[y.value," ",a===0?"подходов":"sets"," (",y.percent,"%)"]})]})}return null};return e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{width:"100%",height:220,position:"relative"},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(me,{children:[e.jsxs(je,{data:u,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:70,outerRadius:90,cornerRadius:6,paddingAngle:4,stroke:"none",startAngle:90,endAngle:-270,children:[u.map((c,f)=>e.jsx(ve,{fill:c.color},`cell-${f}`)),e.jsx(Se,{position:"center",content:({viewBox:c})=>{const f=c.cx||c.width/2,y=c.cy||c.height/2;return e.jsxs("g",{children:[e.jsx("text",{x:f,y:y-5,textAnchor:"middle",dominantBaseline:"central",fill:r.mainText,style:{fontSize:"32px",fontWeight:"800",fontFamily:"Segoe UI, sans-serif"},children:x}),e.jsx("text",{x:f,y:y+22,textAnchor:"middle",dominantBaseline:"central",fill:r.subText,style:{fontSize:"12px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"1px"},children:a===0?"ТОНН":"TONS"})]})}})]}),e.jsx(V,{content:e.jsx(g,{})})]})})}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"20px",marginTop:"0px",flexWrap:"wrap",width:"100%"},children:u.map((c,f)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:c.color}}),e.jsx("span",{style:{fontSize:"12px",color:r.subText,fontWeight:"500"},children:c.name}),e.jsxs("span",{style:{fontSize:"12px",color:r.mainText,fontWeight:"700"},children:[c.percent,"%"]})]},f))}),e.jsx("div",{style:{marginTop:"15px",padding:"6px 16px",borderRadius:"20px",backgroundColor:r.pillBg,color:r.subText,fontSize:"12px",fontWeight:"600"},children:l})]})}function Ge(t){return t%10===1&&t%100!==11?"тренировка":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"тренировки":"тренировок"}const Ne=({active:t,payload:s,label:n,theme:i,langIndex:a})=>{if(t&&s&&s.length){const o=i==="light",d=s[0].value,r=a===0?"Нагрузка":"Load";return e.jsxs("div",{style:{backgroundColor:o?"rgba(255,255,255,0.9)":"rgba(30,30,30,0.9)",backdropFilter:"blur(10px)",border:`1px solid ${p.get("border",i)}`,borderRadius:"12px",padding:"10px 14px",boxShadow:"0 8px 20px rgba(0,0,0,0.15)",textAlign:"center",minWidth:"120px"},children:[e.jsx("p",{style:{margin:0,fontSize:"13px",fontWeight:"bold",color:p.get("mainText",i),marginBottom:"4px"},children:n}),e.jsxs("p",{style:{margin:0,fontSize:"12px",color:p.get("subText",i)},children:[r,": ",e.jsxs("span",{style:{fontWeight:"bold",color:s[0].stroke},children:[d,"%"]})]})]})}return null};function Ye({theme:t,langIndex:s,muscleLoadData:n}){const i=t==="light",a=p.get("icons",t),o=p.get("subText",t),d=p.get("radar",t),r=p.get("radarBorder",t);return e.jsx("div",{style:{width:"100%",height:"300px",position:"relative"},children:e.jsx(U,{width:"100%",height:"100%",className:"muscle-load-chart",children:e.jsxs(Ce,{cx:"50%",cy:"50%",outerRadius:"70%",data:n,children:[e.jsx("defs",{children:e.jsxs("filter",{id:"radarGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})}),e.jsx(we,{gridType:"polygon",stroke:a,strokeOpacity:i?.15:.1}),e.jsx(ke,{dataKey:"muscle",tickLine:!1,axisLine:!1,tick:{fill:o,fontSize:11,fontWeight:500}}),e.jsx(Te,{angle:30,domain:[0,100],tick:!1,axisLine:!1}),e.jsx(De,{name:"Load",dataKey:"load",stroke:r,strokeWidth:3,fill:d,fillOpacity:.5,filter:"url(#radarGlow)",isAnimationActive:!0}),e.jsx(V,{content:e.jsx(Ne,{theme:t,langIndex:s})})]})})})}const Ke=[["7 дней","7 Days"],["Месяц","Month"],["3 Месяца","3 Months"]],oe=[7,28,84],_e=()=>{const[t,s]=h.useState("dark"),[n,i]=h.useState(m.prefs[0]),[a,o]=h.useState(m.prefs[4]),[d,r]=h.useState(0),[x,l]=h.useState("radar");h.useEffect(()=>{const j=A.subscribe(s),b=N.subscribe(C=>i(C==="ru"?0:1)),v=Y.subscribe(o);return()=>{j.unsubscribe(),b.unsubscribe(),v.unsubscribe()}},[]);const[u,g]=h.useState([]);h.useEffect(()=>{const j=oe[d];g(re(j,n))},[d,n]);const c=t==="light"||t==="speciallight",f=c?"rgba(255,255,255,0.7)":"rgba(30,30,30,0.6)",y=c?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)";return e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",paddingBottom:"80px"},children:[e.jsx("div",{style:H(t).segmentedControl,children:Ke.map((j,b)=>{const v=d===b;return e.jsx("div",{onClick:()=>r(b),style:{...H(t).segment,backgroundColor:v?c?"#fff":"rgba(255,255,255,0.1)":"transparent",boxShadow:v?"0 2px 8px rgba(0,0,0,0.1)":"none"},children:e.jsx("span",{style:{fontSize:"12px",fontWeight:v?"700":"500",color:v?p.get("mainText",t):p.get("subText",t)},children:j[n]})},b)})}),e.jsxs("div",{style:{display:"flex",gap:"15px"},children:[e.jsx(te,{icon:e.jsx(ce,{}),label:n===0?"Радар":"Radar",active:x==="radar",onClick:()=>l("radar"),theme:t}),e.jsx(te,{icon:e.jsx(de,{}),label:n===0?"Карта тела":"Body Map",active:x==="body",onClick:()=>l("body"),theme:t})]}),e.jsx("div",{style:{width:"94%",minHeight:"300px",position:"relative"},children:e.jsx(_,{mode:"wait",children:x==="radar"?e.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},style:{...H(t).card,backgroundColor:f,border:`1px solid ${y}`,padding:"20px",alignItems:"center",display:"flex",flexDirection:"column"},children:[e.jsx(Ye,{theme:t,langIndex:n,muscleLoadData:u}),e.jsx("div",{style:{marginTop:"10px",fontSize:"11px",color:p.get("subText",t),textAlign:"center"},children:n===0?"Распределение нагрузки по группам мышц":"Load distribution across muscle groups"})]},"radar"):e.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},style:{...H(t).card,backgroundColor:f,border:`1px solid ${y}`,padding:"20px",alignItems:"center",display:"flex",flexDirection:"column"},children:e.jsx(Ue,{theme:t,langIndex:n,period:d})},"body")})}),e.jsx("div",{style:{width:"94%"},children:e.jsx(qe,{currentData:u,langIndex:n,theme:t})})]})},te=({icon:t,label:s,active:n,onClick:i,theme:a})=>{const o=a==="light",d=p.get("currentDateBorder",a);return e.jsxs(T.div,{whileTap:{scale:.95},onClick:i,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"20px",cursor:"pointer",backgroundColor:n?d:o?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",color:n?"#fff":p.get("subText",a),transition:"all 0.2s ease"},children:[t,e.jsx("span",{style:{fontSize:"13px",fontWeight:"600"},children:s})]})},Ue=({theme:t,langIndex:s,period:n=0})=>{const i=m.pData.gender,a=i===0?"images/BodyIcons/Full.png":"images/BodyIcons/Fullf.png",[o,d]=h.useState({});h.useEffect(()=>{const l=oe[n]||7,u=re(l,s),g={};u.forEach(c=>{g[c.mgId]=c.load}),d(g)},[n,s]);const r=l=>l>=80?"#FF5252":l>=40?"#FFB74D":l>=5?"#66BB6A":p.get("subText",t),x=Array.from({length:13},(l,u)=>u);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[e.jsxs("div",{style:{position:"relative",width:"220px",height:"220px"},children:[e.jsx("img",{src:a,style:{width:"100%",height:"100%",objectFit:"contain",opacity:.8},alt:"Body base"}),x.map(l=>{const u=o[l]??0,g=xe[i]?.[l];if(!g)return null;const c=r(u);return e.jsx(g,{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",color:c,opacity:u===0?.1:.9,pointerEvents:"none",filter:u>0?"drop-shadow(0px 0px 2px rgba(0,0,0,0.3))":"none"}},`muscle-${l}`)})]}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginTop:"20px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx(q,{color:"#FF5252",label:s===0?"Высокая":"High"}),e.jsx(q,{color:"#FFB74D",label:s===0?"Средняя":"Medium"}),e.jsx(q,{color:"#66BB6A",label:s===0?"Низкая":"Low"})]})]})},q=({color:t,label:s})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t}}),e.jsx("span",{style:{fontSize:"11px",color:t,fontWeight:"600"},children:s})]}),qe=({currentData:t,langIndex:s,theme:n})=>{if(!t||t.length===0||t.every(g=>g.load===0))return e.jsxs("div",{style:H(n).insightCard,children:[e.jsx("div",{style:{fontSize:"20px"},children:"ℹ️"}),e.jsx("div",{style:{fontSize:"13px",color:p.get("subText",n)},children:s===0?"Недостаточно данных для анализа.":"Not enough data for analysis."})]});const i=85,a=25,o=t.filter(g=>g.load>=i).map(g=>g.muscle),d=t.filter(g=>g.load<=a&&g.load>0).map(g=>g.muscle),r=t.filter(g=>g.load===0).map(g=>g.muscle);let x="",l="✅",u=!1;if(o.length===0&&d.length===0&&r.length===0)x=s===0?"Ваша нагрузка сбалансирована. Отличная работа!":"Your training is well-balanced. Great job!";else{u=!0,l="⚖️";const g=[];o.length>0&&g.push(s===0?`Высокая нагрузка: ${o.join(", ")}.`:`High load: ${o.join(", ")}.`),d.length>0&&g.push(s===0?`Низкая нагрузка: ${d.join(", ")}.`:`Low load: ${d.join(", ")}.`),r.length>0&&r.length<=5&&g.push(s===0?`Пропущено: ${r.join(", ")}.`:`Missed: ${r.join(", ")}.`),x=g.join(" ")}return e.jsxs("div",{style:{...H(n).insightCard,borderLeft:u?"4px solid #FFB74D":"4px solid #66BB6A",backgroundColor:n==="light"?"rgba(255,255,255,0.8)":"rgba(30,30,30,0.6)"},children:[e.jsx("div",{style:{fontSize:"24px"},children:l}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"bold",color:p.get("subText",n),textTransform:"uppercase",marginBottom:"4px"},children:s===0?"Инсайт":"Insight"}),e.jsx("div",{style:{fontSize:"13px",lineHeight:"1.5",color:p.get("mainText",n)},children:x})]})]})},H=t=>({segmentedControl:{display:"flex",backgroundColor:t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",padding:"4px",borderRadius:"16px",width:"90%",maxWidth:"350px"},segment:{flex:1,padding:"8px 0",borderRadius:"12px",textAlign:"center",cursor:"pointer",transition:"all 0.2s"},card:{width:"88%",borderRadius:"24px",overflow:"hidden",boxShadow:"0 4px 15px rgba(0,0,0,0.05)",backdropFilter:"blur(10px)"},insightCard:{display:"flex",alignItems:"start",gap:"15px",padding:"15px",borderRadius:"16px",boxShadow:"0 4px 15px rgba(0,0,0,0.05)",backdropFilter:"blur(10px)"}}),Xe=()=>{const t=Object.keys(m.trainingLog||{});if(t.length===0)return new Date;const s=t.reduce((n,i)=>new Date(n)>new Date(i)?n:i);return new Date(s)},X=[{id:0,name:["Грудь","Chest"],category:"upper"},{id:1,name:["Плечи","Shoulders"],category:"upper"},{id:2,name:["Широчайшие","Lats"],category:"upper"},{id:3,name:["Бицепс","Biceps"],category:"upper"},{id:4,name:["Трицепс","Triceps"],category:"upper"},{id:5,name:["Трапеции","Traps"],category:"upper"},{id:6,name:["Нижняя спина","Lower Back"],category:"upper"},{id:7,name:["Пресс","Abs"],category:"core"},{id:8,name:["Предплечья","Forearms"],category:"upper"},{id:9,name:["Квадрицепс","Quads"],category:"lower"},{id:10,name:["Бицепс бедра","Hamstrings"],category:"lower"},{id:11,name:["Ягодицы","Glutes"],category:"lower"},{id:12,name:["Икры","Calves"],category:"lower"}],re=(t,s,n=null)=>{const i=n||Xe(),a=new Date(i);a.setDate(a.getDate()-t);const o=a.getTime(),d=13,r={};X.forEach((c,f)=>{r[c.id]=f});const x=new Array(d).fill(0),l=.7,u=.3;for(const[c,f]of Object.entries(m.trainingLog||{}))if(!(new Date(c).getTime()<o)){for(const j of f)if(j?.completed)for(const[b,v]of Object.entries(j.exercises)){const C=v.totalTonnage||0;if(C<=0)continue;const B=parseInt(b,10),k=m.exercises?.[B];if(!k)continue;const w=k.mgId,D=Array.isArray(k.addMgIds)?k.addMgIds.filter(R=>R!==w&&R>=0&&R<13):[];if(Number.isInteger(w)&&r.hasOwnProperty(w)){const R=r[w];x[R]+=C*l}if(D.length>0){const R=C*u/D.length;for(const F of D)if(r.hasOwnProperty(F)){const z=r[F];x[z]+=R}}}}const g=Math.max(...x);return g===0?X.map(c=>({muscle:c.name[s],load:0,mgId:c.id})):X.map((c,f)=>({muscle:c.name[s],load:Math.round(x[f]/g*100),mgId:c.id}))};function Qe({values:t,height:s=40,color:n="#a53429"}){if(!t||t.length===0)return null;const i=t.map((d,r)=>({index:r,value:d})),a=`sparkGradient-${n.replace("#","")}-${Math.random().toString(36).substr(2,9)}`,o=`sparkGlow-${n.replace("#","")}-${Math.random().toString(36).substr(2,9)}`;return e.jsx("div",{style:{width:"100%",height:s},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(Re,{data:i,margin:{top:5,right:5,bottom:5,left:5},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:a,x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:n,stopOpacity:.4}),e.jsx("stop",{offset:"100%",stopColor:n,stopOpacity:1})]}),e.jsxs("filter",{id:o,height:"130%",children:[e.jsx("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),e.jsx("feOffset",{dx:"0",dy:"2",result:"offsetblur"}),e.jsx("feFlood",{floodColor:n,floodOpacity:"0.3"}),e.jsx("feComposite",{in2:"offsetblur",operator:"in"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx(Ie,{type:"monotone",dataKey:"value",stroke:`url(#${a})`,strokeWidth:3,dot:!1,isAnimationActive:!0,animationDuration:1500,filter:`url(#${o})`,strokeLinecap:"round"})]})})})}const Ve=({active:t,payload:s,label:n,palette:i,langIndex:a})=>t&&s&&s.length?e.jsxs("div",{style:{backgroundColor:i.tooltipBg,backdropFilter:"blur(10px)",border:`1px solid ${i.border}`,borderRadius:"12px",padding:"10px 14px",boxShadow:"0 8px 20px rgba(0,0,0,0.15)",minWidth:"120px"},children:[e.jsx("p",{style:{margin:0,fontSize:"12px",color:i.subText,marginBottom:"6px"},children:n}),s.map((o,d)=>{const r=o.dataKey==="tonnage"?o.value*10:o.value,x=o.name,l=o.dataKey==="tonnage"?i.tonnage:i.rm;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"2px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:l}}),e.jsxs("p",{style:{margin:0,fontSize:"14px",fontWeight:"600",color:i.text},children:[r," ",e.jsx("span",{style:{fontSize:"10px",opacity:.7},children:"kg"})]}),e.jsx("span",{style:{fontSize:"10px",color:i.subText,marginLeft:"auto"},children:x})]},d)})]}):null;function Je({data:t,theme:s="dark",langIndex:n,height:i=200}){const[a,o]=h.useState(!0),[d,r]=h.useState(!0);if(!t?.length)return null;const x=s==="light",l={text:x?"#111827":"#F9FAFB",subText:x?"#6B7280":"#9CA3AF",grid:x?"#E5E7EB":"#374151",border:x?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)",tooltipBg:x?"rgba(255,255,255,0.9)":"rgba(30,30,30,0.9)",tonnage:x?"#10B981":"#34D399",rm:x?"#3B82F6":"#60A5FA"};return e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{width:"100%",height:i,marginBottom:"10px"},children:e.jsx(U,{width:"100%",height:"100%",className:"myChart",children:e.jsxs(Me,{data:t,margin:{top:10,right:10,left:-20,bottom:0},barGap:2,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gradTon",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:l.tonnage,stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:l.tonnage,stopOpacity:.6})]}),e.jsxs("linearGradient",{id:"gradRm",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:l.rm,stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:l.rm,stopOpacity:.6})]})]}),e.jsx(Be,{strokeDasharray:"4 4",stroke:l.grid,vertical:!1,strokeOpacity:.4}),e.jsx(Fe,{dataKey:"date",tickLine:!1,axisLine:!1,tick:{fontSize:10,fill:l.subText},dy:10}),e.jsx(ze,{tickLine:!1,axisLine:!1,tick:{fontSize:10,fill:l.subText}}),e.jsx(V,{cursor:{fill:"transparent"},content:e.jsx(Ve,{palette:l,langIndex:n})}),a&&e.jsx(ee,{dataKey:"tonnage",name:"Vol",fill:"url(#gradTon)",radius:[4,4,4,4],barSize:12,animationDuration:1e3}),d&&e.jsx(ee,{dataKey:"oneRepMax",name:"1RM",fill:"url(#gradRm)",radius:[4,4,4,4],barSize:12,animationDuration:1e3})]})})}),e.jsxs("div",{style:{display:"flex",width:"100%",justifyContent:"center",gap:"15px"},children:[e.jsxs("div",{onClick:()=>o(u=>!u),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",padding:"6px 16px",borderRadius:"20px",backgroundColor:a?`${l.tonnage}20`:"transparent",border:`1px solid ${a?l.tonnage:l.grid}`,transition:"all 0.2s ease"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:a?l.tonnage:l.subText}}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"600",color:a?l.text:l.subText},children:n===0?"Тоннаж":"Volume"})]}),e.jsxs("div",{onClick:()=>r(u=>!u),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",padding:"6px 16px",borderRadius:"20px",backgroundColor:d?`${l.rm}20`:"transparent",border:`1px solid ${d?l.rm:l.grid}`,transition:"all 0.2s ease"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:d?l.rm:l.subText}}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"600",color:d?l.text:l.subText},children:"1RM"})]})]})]})}const Ze=({startValue:t=50,endValue:s=70,mediumValue:n=60,unit:i="kg",langIndex:a=0,size:o=120,textColor:d="#acbac3ff",linesColor:r="#34495e",minColor:x="#e74c3c",maxColor:l="#2ecc71",mediumcolor:u="#3498db",baseColor:g="#95a5a6"})=>{const c=s>t,f=s-t,y=s===t,j=c?"+":y?"":"-",b=c?"↗️":y?"➖":"↘️",v=r,C=c?x:l,B=u,k=c?l:x,w=o/2,D=8,R=D+2,F=w-D/2,z=F-R,W=z-R,I=2*Math.PI*F,$=2*Math.PI*z,E=2*Math.PI*W,O=Math.max(t,n,s)*1.1||1,L=(G,K)=>({hidden:{strokeDashoffset:G},visible:{strokeDashoffset:G*(1-K/O),transition:{duration:1.2,ease:"easeOut"}}});return e.jsxs("div",{style:{position:"relative",width:o,height:o,display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsxs("svg",{width:o,height:o,viewBox:`0 0 ${o} ${o}`,style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:w,cy:w,r:F,fill:"none",stroke:v,strokeWidth:D,opacity:.2}),e.jsx("circle",{cx:w,cy:w,r:z,fill:"none",stroke:v,strokeWidth:D,opacity:.2}),e.jsx("circle",{cx:w,cy:w,r:W,fill:"none",stroke:v,strokeWidth:D,opacity:.2}),e.jsx(T.circle,{cx:w,cy:w,r:F,fill:"none",stroke:C,strokeWidth:D,strokeLinecap:"round",strokeDasharray:I,variants:L(I,t),initial:"hidden",animate:"visible",opacity:.6}),e.jsx(T.circle,{cx:w,cy:w,r:z,fill:"none",stroke:B,strokeWidth:D,strokeLinecap:"round",strokeDasharray:$,variants:L($,n),initial:"hidden",animate:"visible"}),e.jsx(T.circle,{cx:w,cy:w,r:W,fill:"none",stroke:k,strokeWidth:D,strokeLinecap:"round",strokeDasharray:E,variants:L(E,s),initial:"hidden",animate:"visible"})]}),e.jsxs("div",{style:{position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:d,pointerEvents:"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginBottom:"2px"},children:[e.jsx("span",{style:{fontSize:"18px"},children:b}),e.jsxs("span",{style:{fontSize:"22px",fontWeight:"800",color:y?d:k,lineHeight:"1"},children:[j,Math.abs(f).toFixed(1)]}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"600",opacity:.7},children:i})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[e.jsxs("div",{style:{fontSize:"10px",color:C,opacity:.8},children:[a===0?"Начало:":"Start:"," ",e.jsx("b",{children:Number.isInteger(t)?t:t.toFixed(1)})]}),e.jsxs("div",{style:{fontSize:"10px",color:k},children:[a===0?"Конец:":"End:"," ",e.jsx("b",{children:Number.isInteger(s)?s:s.toFixed(1)})]}),e.jsxs("div",{style:{fontSize:"9px",color:B,opacity:.8,marginTop:"2px"},children:["~ ",n.toFixed(1)]})]})]})]})},et=({max:t})=>{const[s,n]=h.useState("dark"),[i,a]=h.useState(m.prefs[0]),[o,d]=h.useState(m.prefs[4]),[r,x]=h.useState(m.pData.goal);h.useEffect(()=>{const u=A.subscribe(n),g=N.subscribe(f=>{a(f==="ru"?0:1)}),c=Y.subscribe(f=>{d(f)});return()=>{u.unsubscribe(),g.unsubscribe(),c.unsubscribe()}},[]);const l=({title:u,weightRange:g,rest:c,recovery:f,iconColor:y})=>e.jsxs("div",{style:S(s).cardBody,children:[e.jsxs("div",{style:S(s).cardHeaderRow,children:[e.jsx("div",{style:{...S(s).iconBox,backgroundColor:y},children:e.jsx(Ae,{style:{color:"#fff",fontSize:"18px"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:S(s,o).subtext,children:i===0?"Ваша цель":"Current Goal"}),e.jsx("span",{style:{...S(s,o).text,fontSize:"20px",fontWeight:"bold",margin:0},children:u})]})]}),e.jsxs("div",{style:S(s).gridContainer,children:[e.jsxs("div",{style:S(s).statBox,children:[e.jsxs("div",{style:S(s).statHeader,children:[e.jsx(We,{style:{color:p.get("icons",s),fontSize:"14px"}}),e.jsx("span",{style:S(s,o).subtext,children:i===0?"Нагрузка":"Load"})]}),e.jsx("span",{style:{...S(s,o).text,fontWeight:"bold",fontSize:"16px"},children:g})]}),e.jsxs("div",{style:S(s).statBox,children:[e.jsxs("div",{style:S(s).statHeader,children:[e.jsx(Ee,{style:{color:p.get("icons",s),fontSize:"14px"}}),e.jsx("span",{style:S(s,o).subtext,children:i===0?"Отдых":"Rest"})]}),e.jsx("span",{style:{...S(s,o).text,fontWeight:"bold",fontSize:"16px"},children:c})]}),e.jsxs("div",{style:S(s).statBox,children:[e.jsxs("div",{style:S(s).statHeader,children:[e.jsx(Oe,{style:{color:p.get("icons",s),fontSize:"14px"}}),e.jsx("span",{style:S(s,o).subtext,children:i===0?"Восстан.":"Recovery"})]}),e.jsx("span",{style:{...S(s,o).text,fontWeight:"bold",fontSize:"16px"},children:f})]})]})]});return e.jsxs("div",{style:S(s).container,children:[e.jsx("div",{style:{...S(s,o).text,marginTop:"20px",marginBottom:"15px",opacity:.8,textTransform:"uppercase",letterSpacing:"1px",fontSize:"12px"},children:i===0?"Рекомендации для вас":"Personal recomendations"}),e.jsxs("div",{style:S(s).cardContainer,children:[r===1&&e.jsx(l,{title:i===0?"Сила":"Strength",weightRange:`${Math.round(t*.85)} - ${Math.round(t*.95)} ${i===0?"кг":"kg"} / 3-6 ${i===0?"повт.":"reps"}`,rest:i===0?"3-5 мин":"3-5 min",recovery:i===0?"72 ч":"72 h",iconColor:p.get("maxValColor",s)}),r===0&&e.jsx(l,{title:i===0?"Набор массы":"Muscle Gain",weightRange:`${Math.round(t*.68)} - ${Math.round(t*.82)} ${i===0?"кг":"kg"} / 10-12 ${i===0?"повт.":"reps"}`,rest:i===0?"1.5-2 мин":"1.5-2 min",recovery:i===0?"48 ч":"48 h",iconColor:p.get("done",s)}),r===2&&e.jsx(l,{title:i===0?"Сушка / Рельеф":"Drying / Cutting",weightRange:`${Math.round(t*.5)} - ${Math.round(t*.65)} ${i===0?"кг":"kg"} / 14-20+ ${i===0?"п.":"r."}`,rest:i===0?"30-60 сек":"30-60 sec",recovery:i===0?"24-48 ч":"24-48 h",iconColor:p.get("skipped",s)}),r===3&&e.jsx(l,{title:i===0?"Поддержание":"Maintenance",weightRange:`${Math.round(t*.6)} - ${Math.round(t*.7)} ${i===0?"кг":"kg"} / 10-14 ${i===0?"п.":"r."}`,rest:i===0?"1-2 мин":"1-2 min",recovery:i===0?"72 ч":"72 h",iconColor:p.get("icons",s)})]})]})},S=(t,s)=>({container:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",width:"100%",padding:"10px 0"},text:{fontSize:s===0?"14px":"16px",color:p.get("mainText",t)},subtext:{fontSize:s===0?"11px":"13px",color:p.get("subText",t),marginBottom:"2px"},cardContainer:{display:"flex",flexDirection:"column",borderRadius:"24px",width:"94%",backgroundColor:p.get("bottomPanel",t),boxShadow:"0 4px 12px rgba(0,0,0,0.15)",overflow:"hidden",position:"relative"},cardBody:{padding:"20px",display:"flex",flexDirection:"column"},cardHeaderRow:{display:"flex",alignItems:"center",marginBottom:"20px",paddingBottom:"15px",borderBottom:`1px solid ${p.get("border",t)}`},iconBox:{width:"45px",height:"45px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"15px",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"},gridContainer:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1fr",gap:"10px"},statBox:{backgroundColor:"rgba(255,255,255,0.03)",borderRadius:"16px",padding:"12px 8px",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",border:"1px solid rgba(255,255,255,0.05)"},statHeader:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px",opacity:.8}}),tt=[["Месяц","Month"],["Полгода","6 Months"],["Год","Year"]],st=[28,180,360],nt=({id:t,closePanel:s})=>{const[n,i]=h.useState("dark"),[a,o]=h.useState(m.prefs[0]),[d,r]=h.useState(m.prefs[4]),[x,l]=h.useState(0),[u,g]=h.useState([]);h.useEffect(()=>{const b=A.subscribe(i),v=N.subscribe(B=>o(B==="ru"?0:1)),C=Y.subscribe(r);return()=>{b.unsubscribe(),v.unsubscribe(),C.unsubscribe()}},[]),h.useEffect(()=>{const b=st[x];g(at(t,b))},[t,x]);const c=n==="light",f=c?"#eef2f7":"#09090b",y=c?"#1a1a1a":"#ffffff",j="#00BBFF";return e.jsx("div",{style:P(n).backdrop,onClick:()=>s(!1),children:e.jsxs(T.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300,mass:.8},style:{...P(n).panel,backgroundColor:f},onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{style:P(n).header,children:[e.jsx("div",{style:P(n).dragHandle}),e.jsx("div",{style:P(n).closeBtn,onClick:()=>s(!1),children:e.jsx(ie,{size:20,color:y})})]}),e.jsx("h3",{style:{margin:"10px 0 25px 0",fontSize:"22px",fontWeight:"800",color:y,textAlign:"center",letterSpacing:"-0.5px"},children:a===0?"Аналитика":"Analytics"}),e.jsx("div",{style:P(n).segmentedControlWrapper,children:tt.map((b,v)=>{const C=x===v;return e.jsxs("div",{onClick:()=>l(v),style:it(C,c,j),children:[b[a],C&&e.jsx(T.div,{layoutId:"tabGlow",style:{position:"absolute",bottom:0,left:"20%",right:"20%",height:"3px",borderRadius:"2px",backgroundColor:j,boxShadow:`0 -1px 8px ${j}`}})]},v)})}),e.jsxs("div",{style:{width:"100%",flex:1,overflowY:"auto",padding:"20px 0"},children:[e.jsx("div",{style:{width:"100%",marginBottom:"30px"},children:e.jsx(Je,{theme:n,langIndex:a,data:u,height:260})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"25px",width:"100%",paddingBottom:"40px"},children:u.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:se(c,j),children:[e.jsx("div",{style:{position:"absolute",inset:0,background:`radial-gradient(circle at 50% 30%, ${j}15, transparent 60%)`,zIndex:0}}),e.jsx("div",{style:{position:"relative",zIndex:1},children:e.jsx(Ze,{startValue:u[0].oneRepMax,endValue:u[u.length-1].oneRepMax,mediumValue:lt(u),unit:"kg",langIndex:a,size:220,textColor:y})})]}),e.jsx("div",{style:se(c,c?"#10B981":"#00FF99"),children:e.jsx("div",{style:{position:"relative",zIndex:1,width:"100%"},children:e.jsx(et,{max:u[u.length-1].oneRepMax})})})]}):e.jsx("div",{style:ot(c),children:a===0?"Нет данных за этот период":"No data for this period"})})]})]})})},it=(t,s,n)=>({flex:1,padding:"10px 0",textAlign:"center",cursor:"pointer",position:"relative",fontSize:"13px",fontWeight:t?"700":"600",color:t?s?"#000":"#fff":s?"#666":"#888",transition:"color 0.3s",textShadow:t?`0 0 15px ${n}60`:"none"}),se=(t,s)=>({width:"92%",padding:"25px",borderRadius:"30px",backgroundColor:t?"#ffffff":"#121214",boxShadow:t?`0 10px 30px -10px rgba(0,0,0,0.1), 0 0 20px -5px ${s}20`:`0 20px 40px -20px #000000, 0 0 30px -10px ${s}30`,border:t?"1px solid #f0f0f0":"1px solid #ffffff0d",position:"relative",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center"}),ot=t=>({padding:"60px 20px",color:t?"#999":"#666",fontSize:"15px",fontWeight:"500",fontStyle:"italic",background:t?"#f9f9f9":"#ffffff05",borderRadius:"20px",width:"90%",textAlign:"center"}),P=t=>({backdrop:{position:"fixed",inset:0,zIndex:5e3,backgroundColor:t==="light"?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.6)",backdropFilter:"blur(8px)",display:"flex",alignItems:"flex-end",justifyContent:"center"},panel:{width:"100%",maxWidth:"600px",height:"90vh",borderTopLeftRadius:"36px",borderTopRightRadius:"36px",padding:"0",display:"flex",flexDirection:"column",alignItems:"center",position:"relative",overflow:"hidden"},header:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",padding:"15px 20px 0 20px"},dragHandle:{width:"50px",height:"5px",backgroundColor:t==="light"?"#ddd":"#ffffff30",borderRadius:"10px"},closeBtn:{position:"absolute",right:"25px",top:"20px",padding:"8px",borderRadius:"50%",backgroundColor:t==="light"?"#f0f0f0":"#ffffff10",cursor:"pointer",transition:"background-color 0.2s",backdropFilter:"blur(5px)"},segmentedControlWrapper:{display:"flex",backgroundColor:t==="light"?"#f2f4f7":"#1c1c1e",padding:"4px",borderRadius:"20px",width:"90%",maxWidth:"380px",boxShadow:t==="light"?"inset 0 2px 4px rgba(0,0,0,0.05)":"inset 0 2px 4px rgba(0,0,0,0.2)",marginBottom:"10px"}}),rt=()=>{const t=Object.keys(m.trainingLog||{});if(t.length===0)return new Date;const s=t.reduce((n,i)=>new Date(n)>new Date(i)?n:i);return new Date(s)},at=(t,s)=>{if(!m.trainingLog||!m.exercises[t])return[];const n=rt(),i=new Date(n);i.setDate(i.getDate()-s);const a=i.getTime(),o={};for(const[r,x]of Object.entries(m.trainingLog))if(!(new Date(r).getTime()<a))for(const u of x){if(!u.completed)continue;const g=u.exercises?.[t];if(!g||!Array.isArray(g.sets))continue;let c=0,f=0;for(const y of g.sets){if(typeof y.reps!="number"||typeof y.weight!="number"||y.reps<=0||y.weight<=0)continue;c+=y.weight*y.reps;const j=y.weight*(1+y.reps/30);j>f&&(f=j)}(c>0||f>0)&&(o[r]||(o[r]={date:r,tonnage:0,oneRepMax:0}),o[r].tonnage+=c,f>o[r].oneRepMax&&(o[r].oneRepMax=f))}return Object.values(o).sort((r,x)=>new Date(r.date)-new Date(x.date)).map(r=>({date:r.date,tonnage:Math.round(r.tonnage/10),oneRepMax:Math.round(r.oneRepMax)}))},lt=t=>t.length===0?0:t.reduce((n,i)=>n+i.oneRepMax,0)/t.length,ct=()=>{const[t,s]=h.useState("dark"),[n,i]=h.useState(m.prefs[0]),[a,o]=h.useState(m.prefs[4]),[d,r]=h.useState(!1),[x,l]=h.useState(-1);h.useEffect(()=>{const f=A.subscribe(s),y=N.subscribe(b=>i(b==="ru"?0:1)),j=Y.subscribe(o);return()=>{f.unsubscribe(),y.unsubscribe(),j.unsubscribe()}},[]);const u=t==="light"||t==="speciallight",g=u?"rgba(255,255,255,0.8)":"rgba(30,30,30,0.6)",c=u?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)";return e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",paddingBottom:"80px"},children:[e.jsx(_,{children:Object.entries(m.exercises).filter(([f,y])=>y.rm>0&&y.show).map(([f,y],j)=>{const b=Number(f),v=pt(b,t),C=xt(b),B=parseInt(C.replace(/[^0-9-]/g,""))||0,k=C.includes("▴");return e.jsxs(T.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:j*.05},onClick:()=>{l(b),r(!0)},style:{...Q(t).card,backgroundColor:g,border:`1px solid ${c}`},whileTap:{scale:.98},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",flex:1},children:[e.jsx("div",{style:Q(t).iconBox,children:pe.getForList(y.mgId,n,t)}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{...Q(t,a).text,fontWeight:"700"},children:y.name[n]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px"},children:[e.jsx("span",{style:{fontSize:"13px",color:p.get("subText",t)},children:"1RM:"}),e.jsxs("span",{style:{fontSize:"16px",fontWeight:"bold",color:p.get("mainText",t)},children:[y.rm," ",e.jsx("span",{style:{fontSize:"11px",fontWeight:"normal"},children:"kg"})]}),C&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2px",padding:"2px 6px",borderRadius:"6px",backgroundColor:k?"rgba(76, 175, 80, 0.1)":"rgba(244, 67, 54, 0.1)",color:k?"#4CAF50":"#F44336",fontSize:"11px",fontWeight:"bold"},children:[k?e.jsx(ge,{size:8}):e.jsx(ue,{size:8}),Math.abs(B)]})]}),e.jsx("div",{style:{fontSize:"10px",color:p.get("subText",t),marginTop:"2px",opacity:.6},children:y.rmDate})]})]}),e.jsx("div",{style:{width:"80px",height:"40px",opacity:.8},children:e.jsx(Qe,{values:le(b),color:v})})]},b)})}),d&&e.jsx(nt,{id:x,closePanel:r})]})},dt=()=>{const t=Object.keys(m.trainingLog||{});if(t.length===0)return new Date;const s=t.reduce((n,i)=>new Date(n)>new Date(i)?n:i);return new Date(s)},ae=(t,s=28)=>{const n=dt(),i=new Date(n);i.setDate(n.getDate()-s);const a=i.getTime(),o=[];for(const[d,r]of Object.entries(m.trainingLog||{})){const x=new Date(d);if(!(x.getTime()<a))for(const l of r){if(!l.completed)continue;const u=l.exercises?.[t];if(!(!u||!Array.isArray(u.sets))){for(const g of u.sets)if(g.reps>0&&g.weight>0){const c=g.weight*(1+g.reps/30);o.push({date:x,weight:g.weight,reps:g.reps,estimated1RM:c,timestamp:x.getTime()})}}}}return o.sort((d,r)=>d.timestamp-r.timestamp)},le=t=>{const s=ae(t,28);if(s.length===0)return[0];const n=s.slice(-6).map(i=>i.estimated1RM);return n.length===1?[n[0],n[0]]:n},xt=t=>{const s=m.exercises?.[t]?.rm||0;if(s<=0)return"";const n=ae(t,365);if(n.length===0)return"";const a=Math.max(...n.map(d=>d.estimated1RM))-s,o=Math.round(a);return o===0?"":`${o>0?"▴":"▾"} ${Math.abs(o)}`},pt=(t,s)=>{const n=le(t);if(n.length<2||n.every(o=>o===0))return p.get("subText",s);const i=n[0],a=n[n.length-1];return a>i*1.02?p.get("light",s):a<i*.98?p.get("heavy",s):p.get("medium",s)},Q=(t,s)=>({card:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"90%",padding:"15px",borderRadius:"20px",marginBottom:"12px",boxShadow:t==="light"?"0 4px 12px rgba(0,0,0,0.05)":"0 4px 15px rgba(0,0,0,0.2)",backdropFilter:"blur(10px)",cursor:"pointer",transition:"all 0.2s ease"},text:{fontSize:s===0?"15px":"17px",color:p.get("mainText",t),lineHeight:"1.2",marginBottom:"2px"},iconBox:{width:"45px",height:"45px",borderRadius:"14px",backgroundColor:t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",display:"flex",alignItems:"center",justifyContent:"center"}}),wt=()=>{const[t,s]=h.useState("dark"),[n,i]=h.useState(m.prefs[0]),[a,o]=h.useState(m.prefs[4]),[d,r]=Le.useState("volume"),[x,l]=h.useState(fe.hasPremium),[u,g]=h.useState(new Date),[c,f]=h.useState(0),[y,j]=h.useState(0),[b,v]=h.useState([{value:0},{value:0},{value:0}]),[C,B]=h.useState(0),[k,w]=h.useState(0),[D,R]=h.useState(!1);h.useEffect(()=>{const I=A.subscribe(s),$=N.subscribe(L=>i(L==="ru"?0:1)),E=Y.subscribe(o),O=he.subscribe(l);return()=>{I.unsubscribe(),$.unsubscribe(),E.unsubscribe(),O.unsubscribe()}},[]),h.useEffect(()=>{const I=bt(),{currentCycle:$,currentTonnage:E}=I,O=ft();let L=0,G=0,K=0;$.forEach(J=>{const Z=J.tonnage/(J.duration/6e4);Z<O.min?L++:Z<=O.max?G++:K++}),f(I.targetTonnage),j(I.progressPercent),v([{value:L},{value:G},{value:K}]),B(E),w($.length)},[]);const F=t==="light"||t==="speciallight",z=F?"rgba(255,255,255,0.7)":"rgba(30,30,30,0.6)",W=F?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)";return e.jsxs("div",{style:M(t).container,children:[e.jsx($e,{type:0,theme:t,langIndex:n,activeTab:d,onChange:r}),e.jsx("div",{style:{flex:1,width:"100%",maxWidth:"600px",position:"relative",overflowY:"auto",paddingBottom:"100px"},children:e.jsxs(_,{mode:"wait",children:[d==="volume"&&e.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},style:{display:"flex",flexDirection:"column",gap:"15px",padding:"10px"},children:[e.jsxs("div",{style:{...M(t).card,backgroundColor:z,border:`1px solid ${W}`},children:[e.jsxs("div",{style:M(t).cardHeader,children:[e.jsx("span",{style:M(t,a).headerTitle,children:n===0?"Текущий цикл":"Current Cycle"}),e.jsxs("div",{style:M(t).badge,children:[k," ",n===0?"сессий":"sessions"]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"10px 0"},children:Object.keys(m.trainingLog).length>1?e.jsx(He,{data:b,theme:t,totalTonnage:C,sessionCount:k,langIndex:n}):e.jsx("div",{style:{padding:"40px",color:p.get("subText",t),fontSize:"14px"},children:n===0?"Нет данных":"No data available"})})]}),e.jsxs("div",{style:{...M(t).card,backgroundColor:z,border:`1px solid ${W}`},children:[e.jsx(gt,{theme:t,langIndex:n,totalTonnage:C,targetTonnage:c,progressPercent:y}),e.jsx("div",{style:{padding:"0 20px 20px 20px"},children:e.jsx(ut,{theme:t,langIndex:n})})]})]},"volume"),d==="muscles"&&e.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},style:{padding:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"15px",padding:"0 10px"},children:[e.jsx("span",{style:M(t,a).sectionTitle,children:n===0?"Загрузка мышц":"Muscle Load"}),e.jsx(T.div,{whileTap:{scale:.9},onClick:()=>R(!0),style:{cursor:"pointer",opacity:.7},children:e.jsx(ye,{size:18,color:p.get("mainText",t)})})]}),e.jsx(_e,{})]},"muscles"),d==="exercises"&&e.jsx(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},style:{padding:"10px"},children:e.jsx(ct,{})},"exercises")]})}),!x&&e.jsx("div",{onClick:I=>I.stopPropagation(),style:{position:"absolute",inset:0,zIndex:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:A.value==="dark"?"rgba(10, 10, 10, 0.85)":"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(5px)",textAlign:"center"},children:e.jsx("div",{style:{color:A.value==="dark"?"#FFD700":"#D97706",fontSize:"11px",fontWeight:"bold",fontFamily:"Segoe UI"},children:n===0?"ТОЛЬКО ДЛЯ ПРЕМИУМ":"PREMIUM USERS ONLY"})}),e.jsx(_,{children:D&&e.jsx("div",{style:M(t).modalBackdrop,onClick:()=>R(!1),children:e.jsxs(T.div,{initial:{y:50,opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:50,opacity:0,scale:.95},style:M(t).modalContainer,onClick:I=>I.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{margin:0,color:p.get("mainText",t),fontSize:"18px"},children:"Info"}),e.jsx(ie,{size:24,color:p.get("subText",t),onClick:()=>R(!1),style:{cursor:"pointer"}})]}),e.jsx("div",{style:M(t,a).infoContent,children:mt(n)})]})})})]})},gt=({theme:t,langIndex:s,totalTonnage:n,targetTonnage:i,progressPercent:a})=>{const o=a>=100,d=o?"#4ADE80":p.get("iconsHighlited",t);return e.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",color:p.get("subText",t),letterSpacing:"1px",marginBottom:"10px"},children:s===0?"Цель Цикла":"Cycle Target"}),e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"4px",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"48px",fontWeight:"900",color:d,lineHeight:"1",letterSpacing:"-1px"},children:(i/1e3).toFixed(1)}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"bold",color:p.get("subText",t)},children:s===0?"т":"t"})]}),o&&e.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#4ADE80",marginTop:"-5px",marginBottom:"10px"},children:["+ ",((n-i)/1e3).toFixed(1)," ",s===0?"т":"t"]}),e.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",borderRadius:"4px",margin:"15px 0",overflow:"hidden"},children:e.jsx(T.div,{initial:{width:0},animate:{width:`${Math.min(a,100)}%`},transition:{duration:1,ease:"easeOut"},style:{height:"100%",backgroundColor:d,borderRadius:"4px"}})}),e.jsx("div",{style:{fontSize:"13px",color:p.get("subText",t)},children:a>0?e.jsxs(e.Fragment,{children:[s===0?"Выполнено: ":"Done: ",e.jsxs("span",{style:{color:p.get("mainText",t),fontWeight:"bold"},children:[Math.round(a),"%"]}),!o&&e.jsxs("span",{style:{opacity:.7},children:[" • ",s===0?"осталось ":"left ",((i-n)/1e3).toFixed(1)]})]}):s===0?`Реком. объём: ${(ne()/1e3).toFixed(1)} т`:`Suggested: ${(ne()/1e3).toFixed(1)} t`}),o&&e.jsxs("div",{style:M(t).successBadge,children:[e.jsx(be,{size:12})," ",s===0?"Достигнуто":"Achieved"]})]})},ut=({theme:t,langIndex:s})=>{const n=s===0?`Анализ цикла основан на последней программе.

Объём = сумма тоннажа всех сессий.
Цель = прошлый цикл × 1.05.

Тоннаж = вес × повторения.`:`Cycle analysis based on latest program.

Volume = sum of all session tonnage.
Target = last cycle × 1.05.

Tonnage = weight × reps.`;return e.jsx("div",{style:{backgroundColor:t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"12px",fontSize:"11px",color:p.get("subText",t),lineHeight:"1.5",whiteSpace:"pre-wrap",textAlign:"left"},children:n})},M=(t,s)=>({container:{display:"flex",width:"100vw",flexDirection:"column",overflowY:"scroll",overflowX:"hidden",justifyContent:"flex-start",alignItems:"center",backgroundColor:p.get("background",t),height:"90vh",marginTop:"90px",top:"16vh",paddingTop:"10px"},card:{borderRadius:"24px",overflow:"hidden",boxShadow:t==="light"?"0 4px 15px rgba(0,0,0,0.03)":"0 10px 30px rgba(0,0,0,0.2)",backdropFilter:"blur(10px)",transition:"all 0.3s ease"},cardHeader:{padding:"15px 20px",borderBottom:`1px solid ${p.get("border",t)}`,display:"flex",justifyContent:"space-between",alignItems:"center"},headerTitle:{fontSize:s===0?"15px":"17px",fontWeight:"700",color:p.get("mainText",t)},badge:{fontSize:"11px",fontWeight:"bold",padding:"4px 10px",borderRadius:"12px",backgroundColor:t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:p.get("subText",t)},successBadge:{marginTop:"15px",padding:"6px 14px",borderRadius:"20px",background:"linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(59, 130, 246, 0.2))",color:"#4ADE80",fontSize:"12px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px"},sectionTitle:{fontSize:"18px",fontWeight:"bold",color:p.get("mainText",t),paddingLeft:"5px"},modalBackdrop:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(5px)",zIndex:9e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},modalContainer:{width:"100%",maxWidth:"400px",backgroundColor:p.get("background",t),borderRadius:"24px",padding:"25px",boxShadow:"0 20px 50px rgba(0,0,0,0.5)",border:`1px solid ${p.get("border",t)}`},infoContent:{fontSize:s===0?"13px":"15px",color:p.get("mainText",t),lineHeight:"1.6",whiteSpace:"pre-wrap"},premiumOverlay:{position:"absolute",inset:0,zIndex:10,backgroundColor:t==="light"?"rgba(255,255,255,0.85)":"rgba(10,10,10,0.85)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center"},premiumContent:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"30px",borderRadius:"24px",border:`1px solid ${p.get("border",t)}`,background:t==="light"?"rgba(255,255,255,0.9)":"rgba(20,20,20,0.9)"}});function ft(){const t=Object.values(m.trainingLog).flat().filter(r=>r?.completed&&r.tonnage>0&&r.duration>0);if(t.length===0)return{min:0,max:0};const s=t.map(r=>r.tonnage/(r.duration/6e4)),n=s.reduce((r,x)=>r+x,0)/s.length,i=s.reduce((r,x)=>r+Math.pow(x-n,2),0)/s.length,a=Math.sqrt(i),o=Math.max(0,n-.5*a),d=n+.5*a;return{min:o,max:d}}function ne(){const t=Object.values(m.trainingLog).flat().filter(a=>a?.completed&&typeof a.tonnage=="number"&&a.tonnage>0);if(t.length===0)return 0;const s=t.map(a=>a.tonnage).sort((a,o)=>a-o),n=Math.floor(s.length/2);return(s.length%2===0?(s[n-1]+s[n])/2:s[n])*1.05}function ht(){const t=[];for(const[n,i]of Object.entries(m.trainingLog)){const a=Array.isArray(i)?i:Object.values(i);for(const o of a)o?.completed&&o.tonnage>0&&o.duration>0&&t.push({...o,dateKey:n,date:new Date(n)})}if(t.sort((n,i)=>n.date-i.date),t.length===0)return[];const s=t[t.length-1].programId;return t.filter(n=>n.programId===s)}function yt(t){if(t.length===0)return{currentCycle:[],lastFullCycle:[]};if(t.every(o=>o.dayIndex===t[0].dayIndex))return t.length===1?{currentCycle:[t[0]],lastFullCycle:[]}:{currentCycle:[t[t.length-1]],lastFullCycle:[t[t.length-2]]};const n=[];let i=[],a=-1;for(const o of t)o.dayIndex<=a&&i.length>0&&(n.push(i),i=[]),i.push(o),a=o.dayIndex;return i.length>0&&n.push(i),n.length===1?{currentCycle:n[0],lastFullCycle:[]}:{currentCycle:n[n.length-1],lastFullCycle:n[n.length-2]}}function bt(){const t=ht(),{currentCycle:s,lastFullCycle:n}=yt(t),i=s.reduce((r,x)=>r+x.tonnage,0),a=n.reduce((r,x)=>r+x.tonnage,0),o=a>0?a*1.05:0,d=o>0?Math.min(100,i/o*100):0;return{currentCycle:s,lastFullCycle:n,currentTonnage:i,targetTonnage:o,progressPercent:d}}function mt(t){return t===0?`Анализ цикла основан на последней программе тренировок.

Цикл определяется автоматически:
— Для программ с одним днём — каждый сеанс считается отдельным циклом.
— Для программ с несколькими днями — цикл завершается, когда день в программе сбрасывается.

Объём цикла = сумма тоннажа всех сессий.
Цель = объём предыдущего полного цикла × 1.05 (рост на 5%).`:`Cycle analysis is based on your latest training program.

Cycle detection:
— Single-day programs: each session is a cycle.
— Multi-day programs: cycle ends when the day resets.

Cycle volume = total tonnage of sessions.
Target = last complete cycle × 1.05.`}export{wt as default,bt as getCurrentCycleAnalysis};
