import{A as r,U as V,p as X,C as Z,t as H,l as _,j as e,a as O,m as c,F as ee,g as te,h as ie,i as se,k as ne,n as oe,o as ae,M as re,q as le,r as ce,d as L}from"./index-BBPULZPZ.js";import{r as o}from"./recharts-k8ghPecL.js";import{S as de}from"./Slider-H5OH6V2W.js";function $(){return L.concat((r.CustomHabits||[]).filter(n=>!L.some(l=>l.id===n.id)))}const be=()=>{const[n,l]=o.useState("dark"),[s,h]=o.useState(r.prefs[0]),[g,m]=o.useState(0),[u,b]=o.useState(0),[j,w]=o.useState(V.hasPremium),[f,v]=o.useState(0),[k,A]=o.useState(!1),[Q,F]=o.useState(!1),[J,I]=o.useState(!1),[E,M]=o.useState(0),[S,R]=o.useState(66),[D,B]=o.useState(0),[a,P]=o.useState(()=>r.choosenHabits.length>0?r.choosenHabits[0]:-1),x=n==="light"||n==="speciallight";o.useRef(null),o.useEffect(()=>{const i=X.subscribe(w);return()=>{i.unsubscribe()}},[]);const z=Array.from(Object.values(r.habitsByDate)),t={bg:x?"#F2F4F7":Z.get("background",n),panel:x?"rgba(255,255,255,0.7)":"rgba(28,28,30,0.6)",text:x?"#000000":"#FFFFFF",sub:x?"#8E8E93":"#98989E",accent:"#007AFF",orange:"#FF9500",blur:"blur(25px)",border:x?"rgba(0,0,0,0.08)":"rgba(255,255,255,0.08)"};o.useEffect(()=>{B(S)},[S]),o.useEffect(()=>{const i=H.subscribe(l),d=_.subscribe(p=>h(p==="ru"?0:1));return()=>{i.unsubscribe(),d.unsubscribe()}},[]),o.useEffect(()=>{if(a>-1){let i=0,d=0,p=0;const C=new Date().toISOString().split("T")[0];z.forEach(y=>{a in y&&(y[a]>0?p++:(p>i&&(i=p),p=0)),p>i&&(i=p)});for(let y=z.length-2;y>=0;y--)if(a in z[y])if(z[y][a]>0)d++;else break;r.habitsByDate[C]?.[a]>0&&d++,b(i),v(d),R(r.choosenHabitsDaysToForm[r.choosenHabits.indexOf(a)]||66)}},[a,r.habitsByDate]),o.useEffect(()=>{m(Math.min(f/(S||66),1))},[f,S]);const K=i=>{const p=Math.round(i.target.scrollTop/40),C=r.choosenHabits[p];C!==void 0&&C!==a&&P(C)};return e.jsxs("div",{style:{width:"100vw",height:"98vh",marginTop:"25px",display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:t.bg,transition:"all 0.3s ease",overflow:"hidden",position:"relative"},children:[!j&&e.jsx("div",{onClick:i=>i.stopPropagation(),style:{position:"absolute",inset:0,zIndex:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:H.value==="dark"?"rgba(10, 10, 10, 0.85)":"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",textAlign:"center"},children:e.jsx("div",{style:{color:H.value==="dark"?"#FFD700":"#D97706",fontSize:"11px",fontWeight:"bold",fontFamily:"Segoe UI"},children:s===0?"ТОЛЬКО ДЛЯ ПРЕМИУМ":"PREMIUM USERS ONLY"})}),e.jsx(O,{mode:"wait",children:a===-1?e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{marginTop:"40%",padding:"40px",textAlign:"center"},children:e.jsx("p",{style:{color:t.sub},children:s===0?"Добавьте привычку для анализа":"Add a habit to analyze"})},"empty"):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"8vh"},children:[e.jsx("div",{style:{width:"100%",height:"100px",position:"relative",display:"flex",justifyContent:"center",maskImage:"linear-gradient(to bottom, transparent, black 40%, black 60%, transparent)",WebkitMaskImage:"linear-gradient(to bottom, transparent, black 40%, black 60%, transparent)"},children:e.jsxs("div",{onScroll:K,style:{width:"80%",overflowY:"scroll",scrollSnapType:"y mandatory",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx("div",{style:{height:"30px"}}),r.choosenHabits.map(i=>e.jsx("div",{style:{height:"40px",scrollSnapAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontSize:a===i?"22px":"17px",fontWeight:a===i?"800":"500",color:a===i?t.text:t.sub,transition:"0.2s all"},children:$().find(d=>d.id===i)?.name[s]})},i)),e.jsx("div",{style:{height:"30px"}})]})}),e.jsxs(c.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,ease:[.4,0,.2,1]},style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("div",{style:{width:"90%",display:"flex",gap:"12px",margin:"20px 0"},children:[e.jsxs("div",{style:{...U(t),border:`1px solid ${t.accent}30`,boxShadow:x?"none":`0 0 15px ${t.accent}15`},children:[e.jsx(ee,{style:{position:"absolute",right:"-5px",bottom:"-5px",fontSize:"45px",color:t.accent,opacity:.1}}),e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",color:t.accent},children:s===0?"РЕКОРД":"RECORD"}),e.jsx("span",{style:{fontSize:"28px",fontWeight:"900",color:t.text},children:u})]}),e.jsxs("div",{style:{...U(t),border:`1px solid ${t.orange}30`,boxShadow:x?"none":`0 0 15px ${t.orange}15`},children:[e.jsx(te,{style:{position:"absolute",right:"-5px",bottom:"-5px",fontSize:"50px",color:t.orange,opacity:.1}}),e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",color:t.orange},children:s===0?"ТЕКУЩАЯ":"CURRENT"}),e.jsx("span",{style:{fontSize:"28px",fontWeight:"900",color:t.text},children:f})]})]}),e.jsxs("div",{style:{width:"90%",padding:"30px 20px",borderRadius:"32px",backgroundColor:t.panel,backdropFilter:t.blur,display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",boxShadow:"0 8px 30px rgba(0,0,0,0.04)",border:`1px solid ${t.border}`},children:[e.jsxs("div",{style:{position:"relative",width:"180px",height:"180px",display:"flex",justifyContent:"center",alignItems:"center"},children:[e.jsx("div",{style:{position:"absolute",width:"100px",height:"100px",backgroundColor:G("#FF3B30","#34C759",g),filter:"blur(50px)",opacity:.1}}),e.jsxs("svg",{width:"190",height:"170",viewBox:"0 0 150 150",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{stroke:t.border,fill:"none",strokeWidth:"12",r:"60",cx:"75",cy:"75"}),e.jsx(c.circle,{initial:{strokeDashoffset:377},animate:{strokeDashoffset:377-g*377},transition:{duration:1.5,ease:"easeOut"},stroke:G("#FF3B30","#34C759",g),fill:"none",strokeWidth:"12",r:"60",cx:"75",cy:"75",strokeDasharray:"377",strokeLinecap:"round"})]}),e.jsxs("div",{style:{position:"absolute",textAlign:"center"},children:[e.jsxs("span",{style:{fontSize:"38px",fontWeight:"900",color:t.text},children:[Math.round(g*100),"%"]}),e.jsx("div",{style:{fontSize:"10px",color:t.sub,fontWeight:"800"},children:s===0?"ГОТОВО":"DONE"})]})]}),e.jsxs("div",{style:{width:"100%"},children:[e.jsx("div",{style:{display:"flex",width:"100%",height:"12px",gap:"4px",marginBottom:"12px"},children:pe(E,r.habitsByDate,a,x)}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",backgroundColor:t.border,padding:"6px 12px",borderRadius:"15px"},children:[e.jsx(ie,{size:10,color:t.text,onClick:()=>M(i=>i>0?i-1:2)}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"800",color:t.text},children:he(s,E)}),e.jsx(se,{size:10,color:t.text,onClick:()=>M(i=>i<2?i+1:0)})]}),e.jsx("span",{style:{fontSize:"11px",color:t.sub,fontWeight:"700"},children:"Сегодня"})]})]})]}),e.jsxs("div",{style:{width:"90%",marginTop:"20px",display:"flex",gap:"10px"},children:[e.jsxs(c.div,{whileTap:{scale:.95},onClick:()=>A(!0),style:T(t),children:[e.jsx(ne,{size:18,color:t.accent}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"800",color:t.text},children:s===0?"Инфо":"Info"})]}),e.jsxs(c.div,{whileTap:{scale:.95},onClick:()=>I(!0),style:T(t),children:[e.jsx(oe,{size:18,color:t.text}),e.jsx("span",{style:{fontSize:"12px",fontWeight:"800",color:t.text},children:s===0?"Список":"List"})]}),e.jsxs(c.div,{whileTap:{scale:.95},onClick:()=>F(!0),style:T(t),children:[e.jsx(ae,{size:16,color:t.accent}),e.jsxs("div",{style:{textAlign:"left",lineHeight:"1"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"800",color:t.text},children:S}),e.jsx("div",{style:{fontSize:"9px",color:t.sub},children:s===0?"ДНЕЙ":"DAYS"})]})]})]})]},a)]})}),e.jsxs(O,{children:[J&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:W,onClick:()=>I(!1),children:e.jsxs(c.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},style:{position:"absolute",top:0,right:0,bottom:0,width:"75%",backgroundColor:x?"rgba(255,255,255,0.85)":"rgba(28,28,30,0.85)",backdropFilter:"blur(30px)",padding:"60px 20px",overflowY:"auto",borderLeft:`1px solid ${t.border}`},onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[e.jsx("span",{style:{fontSize:"24px",fontWeight:"800",color:t.text},children:s===0?"Привычки":"Habits"}),e.jsx(re,{size:28,color:t.sub,onClick:()=>I(!1),style:{cursor:"pointer"}})]}),r.choosenHabits.map(i=>e.jsxs(c.div,{whileTap:{scale:.98},onClick:()=>{P(i),I(!1)},style:{padding:"18px",borderRadius:"20px",marginBottom:"10px",backgroundColor:a===i?t.accent+"20":"transparent",color:t.text,fontWeight:"600",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[e.jsx("span",{children:$().find(d=>d.id===i)?.name[s]}),e.jsxs("span",{style:{color:t.accent,fontWeight:"800"},children:[le(i),"%"]})]},i))]})}),k&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{...W,justifyContent:"center",alignItems:"flex-end"},onClick:()=>A(!1),children:e.jsxs(c.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},style:{...Y,backgroundColor:t.panel,backdropFilter:t.blur},onClick:i=>i.stopPropagation(),children:[e.jsx("div",{style:N}),e.jsxs("div",{style:{padding:"20px 25px 60px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},children:[e.jsx(ce,{size:24,color:t.accent}),e.jsx("h3",{style:{margin:0,color:t.text},children:"Инсайты"})]}),e.jsx("p",{style:{color:t.text,fontSize:"16px",lineHeight:"1.6",whiteSpace:"pre-line"},children:xe(s,a)})]})]})}),Q&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{...W,justifyContent:"center",alignItems:"flex-end"},onClick:()=>F(!1),children:e.jsxs(c.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},style:{...Y,backgroundColor:t.panel,backdropFilter:t.blur,textAlign:"center"},onClick:i=>i.stopPropagation(),children:[e.jsx("div",{style:N}),e.jsx("h3",{style:{color:t.text,marginBottom:"20px"},children:s===0?"Срок формирования":"Formation Period"}),e.jsx(de,{min:21,max:180,value:D,onChange:(i,d)=>B(d),sx:{color:t.accent,marginBottom:"20px"}}),e.jsxs("div",{style:{fontSize:"28px",fontWeight:"900",color:t.text,marginBottom:"30px"},children:[D," ",s===0?"дней":"days"]}),e.jsxs("div",{style:{display:"flex",gap:"15px",padding:"0 20px"},children:[e.jsx("button",{style:q,onClick:()=>F(!1),children:"Cancel"}),e.jsx("button",{style:{...q,backgroundColor:t.accent,color:"#FFF"},onClick:()=>{const i=r.choosenHabits.indexOf(a);i!==-1&&(r.choosenHabitsDaysToForm[i]=D),R(D),F(!1)},children:"Save"})]})]})})]})]})},U=n=>({backgroundColor:n.panel,backdropFilter:n.blur,padding:"18px",borderRadius:"26px",textAlign:"center",display:"flex",flexDirection:"column",gap:"4px",position:"relative",overflow:"hidden",flex:1}),T=n=>({backgroundColor:n.panel,backdropFilter:n.blur,padding:"15px",borderRadius:"20px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",border:`1px solid ${n.border}`,flex:1}),W={position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:7e3,display:"flex"},Y={width:"100%",borderRadius:"40px 40px 0 0",maxHeight:"80vh",overflowY:"auto"},N={width:"40px",height:"5px",backgroundColor:"#8E8E93",borderRadius:"3px",margin:"15px auto",opacity:.3},q={flex:1,padding:"16px",borderRadius:"18px",border:"none",fontWeight:"800",fontSize:"16px",backgroundColor:"rgba(120,120,128,0.1)",cursor:"pointer"};function pe(n,l,s,h){const m=[7,30,90][n]??7,u=[],b=new Date;for(let j=m-1;j>=0;j--){const w=new Date(b);w.setDate(b.getDate()-j);const f=w.toISOString().split("T")[0],v=l[f]?.[s];let k=h?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)";v>0?k="#34C759":v<=0&&v!==void 0&&(k="#FF3B30"),u.push(e.jsx("div",{style:{flex:1,height:"100%",backgroundColor:k,borderRadius:"4px"}},f))}return u}function G(n,l,s){const h=b=>b.toString(16).padStart(2,"0"),g=Math.ceil(parseInt(n.substring(1,3),16)*(1-s)+parseInt(l.substring(1,3),16)*s),m=Math.ceil(parseInt(n.substring(3,5),16)*(1-s)+parseInt(l.substring(3,5),16)*s),u=Math.ceil(parseInt(n.substring(5,7),16)*(1-s)+parseInt(l.substring(5,7),16)*s);return`#${h(g)}${h(m)}${h(u)}`}const xe=(n,l)=>r.choosenHabitsTypes[r.choosenHabits.indexOf(l)]?n===0?"Избавление от привычки — это перестройка дофаминовых путей. Мозг будет сопротивляться, требуя «награды», но каждый день воздержания физически ослабляет старую нейронную связь. Срыв — это не конец, а часть процесса. Полная перестройка занимает около 90 дней.":"Breaking a habit means rewiring your dopamine pathways. Your brain will resist and crave the old reward, but every day you abstain physically weakens that old neural connection. A slip-up is not a failure, but part of the process. Full rewiring usually takes about 90 days.":n===0?"Формирование привычки — это создание новой «дороги» в мозге. Исследования UCL показывают, что автоматизм наступает в среднем через 66 дней. Сначала требуется сила воли, но регулярность превращает усилие в рефлекс. Пропущенный день не обнуляет прогресс, если вы сразу вернетесь в строй.":"Forming a habit is like building a new highway in your brain. UCL research shows it takes an average of 66 days to reach automaticity. At first, it requires willpower, but consistency turns effort into reflex. Missing one day does not reset your progress, as long as you get back on track immediately.",he=(n,l)=>[["Неделя","Месяц","Квартал"],["Week","Month","Quarter"]][n][l];export{be as default};
