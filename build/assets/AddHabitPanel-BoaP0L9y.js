import{r as o,t as V,l as U,A as u,z as k,B as ze,D as Le,j as t,C as i,E as Fe,G as xe,H as ue,I as pe,J as Re,K as Y,L as $e,O as Ee,P as Me,Q as G,S as W,T as Be,w as Ne,y as Oe,a as X,V as B}from"./index-1gwYXWtw.js";import{I as J,a as Ve}from"./HabitsMain-n8s_RBQG.js";import{M as L}from"./MyInput-DByw8Z7F.js";import"./index-DX_C48QX.js";const b=new Audio("Audio/Click.wav"),T=()=>X.concat((u.CustomHabits||[]).filter(e=>!X.some(c=>c.id===e.id))),w=new Date,Qe=()=>{const[e,c]=o.useState(V.value),[p,r]=o.useState(U.value),[f,j]=o.useState(!1),[d,q]=o.useState(u.prefs[0]),[y,F]=o.useState(!1),[Q,fe]=o.useState(""),[he,A]=o.useState(!1),[C,_]=o.useState(""),[H,Z]=o.useState(""),[ee,te]=o.useState(""),[se,be]=o.useState("default"),[ne,me]=o.useState(-1),[S,R]=o.useState(w.getFullYear()),[I,$]=o.useState(w.getMonth()+1),[v,D]=o.useState(w.getDate()),[N,ie]=o.useState([]),[oe,O]=o.useState(""),[le,ae]=o.useState(T()),[ye,re]=o.useState(null),[E,ce]=o.useState(!1),[we,de]=o.useState(0),[je,Ce]=o.useState("default"),[M,P]=o.useState(!1),g=(n,a)=>{a===2?D(l=>{const x=new Date(S,I,0).getDate();let h=l;return n?l<x&&new Date(S,I-1,l+1).getTime()<=w.getTime()&&(h=l+1):l>1&&(h=l-1),h}):a===1?$(l=>{let x=l;n?l<12&&new Date(S,l,v).getTime()<=w.getTime()&&(x=l+1):l>1&&(x=l-1);const h=new Date(S,x,0).getDate();return v>h&&D(h),x}):a===0&&R(l=>{let x=l;n?l<w.getFullYear()&&new Date(l+1,I-1,v).getTime()<=w.getTime()&&(x=l+1):l>w.getFullYear()-1&&(x=l-1);const h=new Date(x,I,0).getDate();return v>h&&D(h),x})},Se=k(()=>g(!1,0)),Ie=k(()=>g(!0,0)),ve=k(()=>g(!1,1)),De=k(()=>g(!0,1)),Pe=k(()=>g(!1,2)),ke=k(()=>g(!0,2)),Te=()=>{oe.length>0?(ie(n=>[...n,oe]),O("")):B(d===0?"Введите цель":"Enter goal",2e3,!1)},Ae=n=>{ie(a=>a.filter((l,x)=>x!==n))},He=[["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],["January","February","March","April","May","June","July","August","September","October","November","December"]];o.useEffect(()=>{const n=V.subscribe(c),a=U.subscribe(r),l=ze.subscribe(j);return()=>{n.unsubscribe(),a.unsubscribe(),l.unsubscribe()}},[]),o.useEffect(()=>{const n=V.subscribe(c),a=U.subscribe(l=>{q(l==="ru"?0:1)});return()=>{n.unsubscribe(),a.unsubscribe()}},[]),o.useEffect(()=>{ae(T())},[]),o.useEffect(()=>{const n=Le.subscribe(fe);return Q==="AddHabitPanel"?setTimeout(()=>de(1),400):de(0),()=>{n.unsubscribe()}},[]);const z=(n,a)=>{n.length>0?a===0?_(n[0].toUpperCase()+n.toLowerCase().slice(1)):a===1?Z(n[0].toUpperCase()+n.toLowerCase().slice(1)):a===2?te(n[0].toUpperCase()+n.toLowerCase().slice(1)):a===3&&O(n[0].toUpperCase()+n.toLowerCase().slice(1)):a===0?_(""):a===1?Z(""):a===2?te(""):a===3&&O("")};return o.useEffect(()=>{C.length>3&&H.length>3?P(!0):P(!1)},[C,H,ee,se,d]),t.jsxs("div",{style:{...s(e).container,transform:Q==="AddHabitPanel"?"translateX(0)":"translateX(-100%)",backgroundColor:we===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:[!y&&t.jsxs("div",{style:s(e,f).panel,children:[t.jsx("div",{style:s(e).headerText,children:d===0?"добавь привычку":"add habit"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"90%"},children:[t.jsx(Fe,{style:{color:i.get("icons",e),fontSize:"16px",marginTop:"10px",marginLeft:"10px"}}),t.jsx(L,{maxL:10,w:"70%",placeHolder:d===0?"поиск":"search",theme:e,onChange:n=>Ge(n,le,ae)})]}),t.jsx("div",{style:s(e).scrollView,children:le.map(n=>!u.choosenHabits.includes(n.id)&&t.jsx("li",{style:{...s(e).text,borderRadius:"24px",backgroundColor:n.id===ye?i.get("highlitedPanel",e):"transparent"},onClick:()=>{re(n.id),me(n.id),P(!0),m(b)},children:t.jsx("p",{style:s(e).text,children:n.name[d]})},n.id))})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{ue(""),pe(0),m(b)},children:t.jsx(xe,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{F(!0),P(!1)},children:t.jsx(Re,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{M&&(A(!0),m(b))},children:t.jsx(Y,{style:{...s(e).miniIcon,color:M?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),y&&t.jsxs("div",{style:s(e,f).panel,children:[t.jsx("div",{style:s(e).headerText,children:d===0?"или создай свою":"or create your own"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(L,{maxL:25,h:"15%",w:"90%",placeHolder:d===0?"имя":"name",theme:e,onChange:n=>z(n,0)}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"95%"},children:[t.jsx(L,{maxL:25,h:"40%",w:"50%",placeHolder:d===0?"категория":"category",theme:e,onChange:n=>z(n,1),value:H}),t.jsx("select",{style:{...s(e).input,width:"48%"},onChange:n=>z(n.target.value,1),children:Ue(e,d)})]}),t.jsx(L,{maxL:100,h:"20%",w:"90%",placeHolder:d===0?"описание(опционально)":"description(optional)",theme:e,onChange:n=>z(n,2)}),t.jsx("div",{style:s(e).headerText,children:d===0?"выбери иконку(опционально)":"choose icon(optional)"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{width:"80%",marginLeft:"30px",padding:"5px"},children:t.jsxs("div",{style:s(e).button,onClick:()=>ce(!E),children:[!E&&t.jsx($e,{style:s(e).miniIcon}),E&&t.jsx(Ee,{style:s(e).miniIcon})]})}),t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"20%",height:"100%",padding:"8px"},children:J.getIcon(je,{size:48,style:{marginRight:"70px",color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{ue(""),pe(0),m(b)},children:t.jsx(xe,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{F(!1),P(!1),re(null)},children:t.jsx(Me,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{M&&(A(!0),m(b))},children:t.jsx(Y,{style:{...s(e).miniIcon,color:M?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),E&&t.jsx("div",{style:s(e).selectPanel,children:Object.entries(J.ic).map(([n])=>t.jsx("div",{style:{width:"15%",padding:"12px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"8px",transition:"background-color 0.2s",":hover":{backgroundColor:i.get("highlitedPanel",e)}},onClick:()=>{Ce(n),be(n),m(b),ce(!1),C.length>3&&H.length>3&&P(!0)},children:J.getIcon(n,{size:32,style:{color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})},n))}),he&&t.jsx("div",{style:s(e).container,children:t.jsxs("div",{style:s(e).confirmationPanel,children:[t.jsx("p",{style:s(e).text,children:We(d,y,ne,C)}),t.jsxs("div",{style:{...s(e).simplePanelRow,flexDirection:"column",justifyContent:"space-between",alignItems:"center",backgroundColor:i.get("background",e),width:"90%",height:"80%",borderRadius:"24px"},children:[t.jsx("p",{style:s(e).text,children:d===0?"установите дату":"set date"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Se,onClick:()=>{g(!1,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(G,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",S," "]}),t.jsx("div",{...Ie,onClick:()=>{g(!0,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(W,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...ve,onClick:()=>{g(!1,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(G,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",He[d][I-1]," "]}),t.jsx("div",{...De,onClick:()=>{g(!0,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(W,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Pe,onClick:()=>{g(!1,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(G,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",v," "]}),t.jsx("div",{...ke,onClick:()=>{g(!0,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(W,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsx("p",{style:s(e).text,children:d===0?"(опционально) дополнительные цели":"(optional) additional goals"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%",flexDirection:"row",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(L,{w:"80%",h:"70%",maxL:50,placeHolder:d===0?"новая цель":"new goal",onChange:n=>z(n,3),clear:!0}),t.jsx(Y,{style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},onClick:Te})]}),t.jsx("div",{style:{marginTop:"10px",width:"60%",display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",overflowY:"auto",height:"120%"},children:N.map((n,a)=>t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%",height:"20%"},children:[t.jsx("div",{style:s(e).text,children:a+1+": "+n}),t.jsx(Be,{style:{...s(e).miniIcon,fontSize:"14px",marginBottom:"20px",marginLeft:"auto"},onClick:()=>Ae(a)})]},a))})]}),t.jsxs("div",{style:s(e).simplePanelRow,children:[t.jsx("div",{style:s(e).button,onClick:()=>{A(!1),K(D,$,R),m(b)},children:t.jsx(Ne,{style:s(e).miniIcon})}),t.jsx("div",{style:s(e).button,onClick:()=>{const n=`${S}-${I.toString().padStart(2,"0")}-${v.toString().padStart(2,"0")}`,a=N.length>0?N.map(l=>({text:l,isDone:!1})):[];y?Ye(C,H,ee,se,n,a):ge(ne,C,!1,n,a),m(b),A(!1),K(D,$,R),m(b),A(!1),K(D,$,R)},children:t.jsx(Oe,{style:s(e).miniIcon})})]})]})})]})},Ue=(e,c)=>Array.from(new Set(X.map(r=>r.category[c]))).map(r=>t.jsx("option",{value:r,style:{...s(e).text},children:r},r)),ge=(e,c,p,r,f)=>{if(u.IsHabitInChoosenList(e)){B(u.prefs[0]===0?"привычка уже в списке":"habit already in list",2500,!1);return}Ve(e,r,f);const j=p?u.prefs[0]===0?`привычка: ${c} создана и добавлена`:`habit: ${c} was created and added`:u.prefs[0]===0?"привычка добавлена":"habit added";B(j,2500,!0)},Ye=(e,c,p,r,f,j)=>{const d=T(),y=(d.length>0?Math.max(...d.map(F=>F.id)):0)+1;u.IsCustomHabitExists(y)?B(u.prefs[0]===0?"привычка с таким названием уже существует":"habit with this name already exists",2500,!1):(u.AddCustomHabit(e,c,p,r,y),setTimeout(()=>{ge(y,e,!0,f,j)},100))},Ge=(e,c,p)=>{if(e.length>0){const r=T().filter(f=>f.name[u.prefs[0]].toLowerCase().startsWith(e.toLowerCase()));p(r)}else{const r=T();c.length!=r.length&&p(r)}},s=(e,c)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,padding:"20px"},panel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",overflow:"hidden",boxSizing:"border-box",overflowY:"scroll",border:`1px solid ${i.get("border",e)}`,margin:"5px",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:c?"85vh":"65vh"},confirmationPanel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,margin:"5px",marginBottom:"15vw",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:"140vw"},text:{textAlign:"center",fontSize:"12px",color:i.get("mainText",e),marginBottom:"12px"},textDate:{textAlign:"center",fontSize:"18px",color:i.get("mainText",e),marginBottom:"4px"},headerText:{textAlign:"center",margin:"5px",padding:"5px",fontSize:"14px",color:i.get("subText",e)},scrollView:{overflowY:"auto",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"},simplePanel:{marginLeft:"7.5vw",width:"70vw",height:"30vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch",background:"rgba(0, 0, 0, 0.1)",borderRadius:"24px"},input:{backgroundColor:i.get("simplePanel",e),width:"65vw",height:"3vh",borderBottom:`1px solid ${i.get("border",e)}`,borderRadius:"12px",margin:"12px",fontSize:"12px",fontFamily:"Segoe UI",color:i.get("subText",e)},simplePanelRow:{width:"75vw",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-around",userSelect:"none",touchAction:"none"},select:{width:"20vw",height:"6vw",borderRadius:"12px",border:`1px solid ${i.get("border",e)}`,marginTop:"12px",fontSize:"14px",color:i.get("subText",e),backgroundColor:i.get("habitCard",e)},selectOption:{color:i.get("subText",e),backgroundColor:i.get("habitCard",e),fontSize:"8px"},selectPanel:{backgroundColor:i.get("habitCard",e),borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexWrap:"wrap",width:"77vw",maxHeight:"42vh",overflowY:"auto",padding:"16px",gap:"8px",justifyContent:"center",zIndex:1e3},selectIcon:{flex:"{0,0,33.33%}",width:"20vw",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignContent:"center",justifyContent:"center",width:"15vw",marginTop:"12px",fontSize:"12px"},miniIcon:{fontSize:"28px",padding:"5px",marginTop:"10px",color:i.get("icons",e),userSelect:"none",touchAction:"none",filter:`drop-shadow(0 0px 1px ${i.get("iconsShadow",e)})`}});function m(e){u.prefs[2]==0&&e!==null&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),u.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}function We(e,c,p,r){if(c)return e===0?"добавить привычку "+r+"?":"add habit "+r+"?";{const f=T().find(j=>j.id===p).name[e];return e===0?"добавить привычку "+f+"?":"add habit "+f+"?"}}function K(e,c,p){const r=new Date;e(r.getDate()),c(r.getMonth()+1),p(r.getFullYear())}export{Qe as default};
