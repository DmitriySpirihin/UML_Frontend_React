import{r as o,t as J,l as X,f as he,A as f,G as A,H as Ve,I as Ye,j as t,C as i,J as Ue,K as be,L as q,O as me,P as We,Q as K,S as Ge,T as Je,V as Xe,W as Q,X as Z,Y as qe,i as Ke,k as Qe,a as te,Z as O}from"./index-DwAcGTWc.js";import{I as _,a as Ze}from"./HabitsMain-DJdbiPSA.js";import{M as N}from"./MyInput-CYzCuj1l.js";import{S as _e}from"./Slider-yAd5SWN2.js";import"./index-DUDtk6fm.js";const b=new Audio("Audio/Click.wav"),C=()=>te.concat((f.CustomHabits||[]).filter(e=>!te.some(c=>c.id===e.id))),w=new Date,ct=()=>{const[e,c]=o.useState(J.value),[u,x]=o.useState(X.value),[l,j]=o.useState(he.value),[S,H]=o.useState(!1),[d,se]=o.useState(f.prefs[0]),[y,L]=o.useState(!1),[ne,je]=o.useState(""),[Ce,z]=o.useState(!1),[v,ie]=o.useState(""),[F,V]=o.useState(d===0?"–ó–¥–æ—Ä–æ–≤—å–µ":"Health"),[oe,ae]=o.useState(""),[le,Se]=o.useState("default"),[re,ve]=o.useState(-1),[I,R]=o.useState(w.getFullYear()),[D,$]=o.useState(w.getMonth()+1),[P,k]=o.useState(w.getDate()),[Y,ce]=o.useState([]),[de,U]=o.useState(""),[W,Ie]=o.useState(!1),[E,De]=o.useState(66),[ue,xe]=o.useState(C()),[Pe,pe]=o.useState(null),[M,fe]=o.useState(!1),[ke,ge]=o.useState(0),[Te,Ae]=o.useState("default"),[B,T]=o.useState(!1),[He,ze]=o.useState(d===0?"–ó–¥–æ—Ä–æ–≤—å–µ":"Health"),g=(n,r)=>{r===2?k(a=>{const p=new Date(I,D,0).getDate();let h=a;return n?a<p&&new Date(I,D-1,a+1).getTime()<=w.getTime()&&(h=a+1):a>1&&(h=a-1),h}):r===1?$(a=>{let p=a;n?a<12&&new Date(I,a,P).getTime()<=w.getTime()&&(p=a+1):a>1&&(p=a-1);const h=new Date(I,p,0).getDate();return P>h&&k(h),p}):r===0&&R(a=>{let p=a;n?a<w.getFullYear()&&new Date(a+1,D-1,P).getTime()<=w.getTime()&&(p=a+1):a>w.getFullYear()-1&&(p=a-1);const h=new Date(p,D,0).getDate();return P>h&&k(h),p})},Le=A(()=>g(!1,0)),Fe=A(()=>g(!0,0)),Re=A(()=>g(!1,1)),$e=A(()=>g(!0,1)),Ee=A(()=>g(!1,2)),Me=A(()=>g(!0,2)),Be=()=>{de.length>0?(ce(n=>[...n,de]),U("")):O(d===0?"–í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—å":"Enter goal",2e3,!1)},Ne=n=>{ce(r=>r.filter((a,p)=>p!==n))},Oe=[["—è–Ω–≤–∞—Ä—è","—Ñ–µ–≤—Ä–∞–ª—è","–º–∞—Ä—Ç–∞","–∞–ø—Ä–µ–ª—è","–º–∞—è","–∏—é–Ω—è","–∏—é–ª—è","–∞–≤–≥—É—Å—Ç–∞","—Å–µ–Ω—Ç—è–±—Ä—è","–æ–∫—Ç—è–±—Ä—è","–Ω–æ—è–±—Ä—è","–¥–µ–∫–∞–±—Ä—è"],["January","February","March","April","May","June","July","August","September","October","November","December"]];o.useEffect(()=>{const n=J.subscribe(c),r=X.subscribe(x),a=Ve.subscribe(H),p=he.subscribe(j);return()=>{n.unsubscribe(),r.unsubscribe(),a.unsubscribe(),p.unsubscribe()}},[]),o.useEffect(()=>{const n=J.subscribe(c),r=X.subscribe(a=>{se(a==="ru"?0:1)});return()=>{n.unsubscribe(),r.unsubscribe()}},[]),o.useEffect(()=>{xe(C())},[]),o.useEffect(()=>{const n=Ye.subscribe(je);return ne==="AddHabitPanel"?setTimeout(()=>ge(1),400):ge(0),()=>{n.unsubscribe()}},[]);const G=(n,r)=>{n.length>0?r===0?ie(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===1?V(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===2?ae(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===3&&U(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===0?ie(""):r===1?V(""):r===2?ae(""):r===3&&U("")};return o.useEffect(()=>{v.length>3&&F.length>3?T(!0):T(!1)},[v,F,oe,le,d]),t.jsxs("div",{style:{...s(e).container,transform:ne==="AddHabitPanel"?"translateX(0)":"translateX(-100%)",backgroundColor:ke===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:[!y&&t.jsxs("div",{style:s(e,S).panel,children:[t.jsx("div",{style:s(e,!1,l).headerText,children:d===0?"–¥–æ–±–∞–≤—å –ø—Ä–∏–≤—ã—á–∫—É":"add habit"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"90%"},children:[t.jsx(Ue,{style:{color:i.get("icons",e),fontSize:"16px",marginTop:"10px",marginLeft:"10px"}}),t.jsx(N,{maxL:10,w:"70%",placeHolder:d===0?"–ø–æ–∏—Å–∫":"search",theme:e,onChange:n=>tt(n,ue,xe)})]}),t.jsx("select",{style:{...s(e,!1,l).input,width:"80%",marginLeft:"10%"},onChange:n=>ze(n.target.value),children:ye(e,d,l)}),t.jsx("div",{style:s(e).scrollView,children:ue.map(n=>!f.choosenHabits.includes(n.id)&&n.category[d]===He&&t.jsx("div",{style:{...s(e).text,alignContent:"center",height:"40px",borderRadius:"12px",backgroundColor:n.id===Pe?i.get("highlitedPanel",e):"transparent"},onClick:()=>{pe(n.id),Ie(C()[n.id].category[0]==="–û—Ç–∫–∞–∑ –æ—Ç –≤—Ä–µ–¥–Ω–æ–≥–æ"),ve(n.id),T(!0),m(b)},children:n.name[d]+" "+(n.isCustom?" üîñ":"")},n.id))})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{q(""),me(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{L(!0),T(!1)},children:t.jsx(We,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B&&(z(!0),m(b))},children:t.jsx(K,{style:{...s(e).miniIcon,color:B?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),y&&t.jsxs("div",{style:s(e,S).panel,children:[t.jsx("div",{style:s(e).headerText,children:d===0?"–∏–ª–∏ —Å–æ–∑–¥–∞–π —Å–≤–æ—é":"or create your own"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(N,{maxL:25,h:"15%",w:"90%",placeHolder:d===0?"–∏–º—è":"name",theme:e,onChange:n=>G(n,0)}),t.jsx("select",{style:{...s(e,!1,l).input,width:"48%"},onChange:n=>V(n.target.value),children:ye(e,d,l)}),t.jsx(N,{maxL:100,h:"20%",w:"90%",placeHolder:d===0?"–æ–ø–∏—Å–∞–Ω–∏–µ(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)":"description(optional)",theme:e,onChange:n=>G(n,2)}),t.jsx("div",{style:s(e,!1,l).headerText,children:d===0?"–≤—ã–±–µ—Ä–∏ –∏–∫–æ–Ω–∫—É(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)":"choose icon(optional)"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{width:"80%",marginLeft:"30px",padding:"5px"},children:t.jsxs("div",{style:s(e).button,onClick:()=>fe(!M),children:[!M&&t.jsx(Ge,{style:s(e).miniIcon}),M&&t.jsx(Je,{style:s(e).miniIcon})]})}),t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"20%",height:"100%",padding:"8px"},children:_.getIcon(Te,{size:48,style:{marginRight:"70px",color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{q(""),me(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{L(!1),T(!1),pe(null)},children:t.jsx(Xe,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B&&(z(!0),m(b))},children:t.jsx(K,{style:{...s(e).miniIcon,color:B?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),M&&t.jsx("div",{style:s(e).selectPanel,children:Object.entries(_.ic).map(([n])=>t.jsx("div",{style:{width:"15%",padding:"12px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"8px",transition:"background-color 0.2s",":hover":{backgroundColor:i.get("highlitedPanel",e)}},onClick:()=>{Ae(n),Se(n),m(b),fe(!1),v.length>3&&F.length>3&&T(!0)},children:_.getIcon(n,{size:32,style:{color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})},n))}),Ce&&t.jsx("div",{style:s(e).container,children:t.jsxs("div",{style:s(e).confirmationPanel,children:[t.jsx("p",{style:s(e,!1,l).text,children:st(d,y,re,v)}),t.jsxs("div",{style:{...s(e).simplePanelRow,flexDirection:"column",justifyContent:"space-between",alignItems:"center",backgroundColor:i.get("background",e),width:"90%",height:"80%",borderRadius:"24px"},children:[t.jsx("p",{style:s(e,!1,l).subtext,children:d===0?"—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞—Ç—É":"set date"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Le,onClick:()=>{g(!1,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",I," "]}),t.jsx("div",{...Fe,onClick:()=>{g(!0,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Re,onClick:()=>{g(!1,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",Oe[d][D-1]," "]}),t.jsx("div",{...$e,onClick:()=>{g(!0,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Ee,onClick:()=>{g(!1,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",P," "]}),t.jsx("div",{...Me,onClick:()=>{g(!0,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsx("p",{style:s(e,!1,l).subtext,children:d===0?"(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–∏":"(optional) additional goals"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%",flexDirection:"row",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(N,{w:"80%",h:"70%",maxL:50,placeHolder:d===0?"–Ω–æ–≤–∞—è —Ü–µ–ª—å":"new goal",onChange:n=>G(n,3),clear:!0}),t.jsx(K,{style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},onClick:Be})]}),t.jsx("div",{style:{marginTop:"10px",width:"60%",display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",overflowY:"auto",height:"90%"},children:Y.map((n,r)=>t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%",height:"20%"},children:[t.jsx("div",{style:s(e,!1,l).text,children:r+1+": "+n}),t.jsx(qe,{style:{...s(e).miniIcon,fontSize:"14px",marginBottom:"20px",marginLeft:"auto"},onClick:()=>Ne(r)})]},r))}),t.jsx(_e,{style:s(e).slider,min:21,max:180,value:E,valueLabelDisplay:"auto",onChange:n=>De(n.target.value)}),t.jsx("div",{style:{...s(e,!1,l).subtext,marginTop:"5px",width:"90%"},children:nt(d,E,W)})]}),t.jsxs("div",{style:s(e).simplePanelRow,children:[t.jsx("div",{style:s(e).button,onClick:()=>{z(!1),ee(k,$,R),m(b)},children:t.jsx(Ke,{style:s(e).miniIcon})}),t.jsx("div",{style:s(e).button,onClick:()=>{const n=`${I}-${D.toString().padStart(2,"0")}-${P.toString().padStart(2,"0")}`,r=Y.length>0?Y.map(a=>({text:a,isDone:!1})):[];y?et(v,F,oe,le,n,r,W,E):we(re,v,!1,n,r,W,E),m(b),z(!1),q(""),ee(k,$,R),m(b),z(!1),ee(k,$,R)},children:t.jsx(Qe,{style:s(e).miniIcon})})]})]})})]})},ye=(e,c,u)=>Array.from(new Set(te.map(l=>l.category[c]))).map(l=>t.jsx("option",{value:l,style:{...s(e,!1,u).text},children:l},l)),we=(e,c,u,x,l,j,S)=>{if(f.IsHabitInChoosenList(e)){O(f.prefs[0]===0?"–ø—Ä–∏–≤—ã—á–∫–∞ —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ":"habit already in list",2500,!1);return}Ze(e,x,l,j,S);const H=u?f.prefs[0]===0?`–ø—Ä–∏–≤—ã—á–∫–∞: ${c} —Å–æ–∑–¥–∞–Ω–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞`:`habit: ${c} was created and added`:f.prefs[0]===0?"–ø—Ä–∏–≤—ã—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞":"habit added";O(H,2500,!0)},et=(e,c,u,x,l,j,S,H)=>{const d=C(),y=(d.length>0?Math.max(...d.map(L=>L.id)):0)+1;f.IsCustomHabitExists(y)?O(f.prefs[0]===0?"–ø—Ä–∏–≤—ã—á–∫–∞ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç":"habit with this name already exists",2500,!1):(f.AddCustomHabit(e,c,u,x,y),setTimeout(()=>{we(y,e,!0,l,j,S,H)},100))},tt=(e,c,u)=>{if(e.length>0){const x=C().filter(l=>l.name[f.prefs[0]].toLowerCase().startsWith(e.toLowerCase()));u(x)}else{const x=C();c.length!=x.length&&u(x)}},s=(e,c,u)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,padding:"20px"},panel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",overflow:"hidden",boxSizing:"border-box",overflowY:"scroll",border:`1px solid ${i.get("border",e)}`,margin:"5px",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:c?"85vh":"65vh"},confirmationPanel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,margin:"5px",marginBottom:"15vw",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:"170vw"},text:{textAlign:"center",fontSize:u?"13px":"15px",color:i.get("mainText",e),marginBottom:"12px"},subtext:{textAlign:"center",fontSize:u?"11px":"13px",color:i.get("subText",e),marginBottom:"12px"},textDate:{textAlign:"center",fontSize:"18px",color:i.get("mainText",e),marginBottom:"4px"},headerText:{textAlign:"center",margin:"5px",padding:"5px",fontSize:u?"13px":"15px",color:i.get("subText",e)},scrollView:{overflowY:"auto",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"},simplePanel:{marginLeft:"7.5vw",width:"70vw",height:"30vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch",background:"rgba(0, 0, 0, 0.1)",borderRadius:"24px"},input:{backgroundColor:i.get("simplePanel",e),width:"65vw",height:"3vh",borderBottom:`1px solid ${i.get("border",e)}`,borderRadius:"12px",margin:"12px",fontSize:u?"13px":"15px",fontFamily:"Segoe UI",color:i.get("subText",e)},simplePanelRow:{width:"75vw",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-around",userSelect:"none",touchAction:"none"},select:{width:"20vw",height:"6vw",borderRadius:"12px",border:`1px solid ${i.get("border",e)}`,marginTop:"12px",fontSize:u?"13px":"15px",color:i.get("subText",e),backgroundColor:i.get("habitCard",e)},selectOption:{color:i.get("subText",e),backgroundColor:i.get("habitCard",e),fontSize:u?"11px":"13px"},selectPanel:{backgroundColor:i.get("habitCard",e),borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexWrap:"wrap",width:"77vw",maxHeight:"42vh",overflowY:"auto",padding:"16px",gap:"8px",justifyContent:"center",zIndex:1e3},selectIcon:{flex:"{0,0,33.33%}",width:"20vw",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignContent:"center",justifyContent:"center",width:"15vw",marginTop:"12px",fontSize:"12px"},miniIcon:{fontSize:"28px",padding:"5px",marginTop:"10px",color:i.get("icons",e),userSelect:"none",touchAction:"none",filter:`drop-shadow(0 0px 1px ${i.get("iconsShadow",e)})`},slider:{width:"70%",userSelect:"none",touchAction:"none",color:i.get("icons",e)}});function m(e){f.prefs[2]==0&&e!==null&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),f.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}function st(e,c,u,x){if(c)return e===0?"–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É "+x+"?":"add habit "+x+"?";{const l=C().find(j=>j.id===u).name[e];return e===0?"–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É "+l+"?":"add habit "+l+"?"}}function nt(e,c,u){return u?e===0?"–º–Ω–µ –Ω—É–∂–Ω–æ "+c+" –¥–Ω–µ–π —á—Ç–æ–±—ã –±—Ä–æ—Å–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É":"i need "+c+" days to quit":e===0?"–º–Ω–µ –Ω—É–∂–Ω–æ "+c+" –¥–Ω–µ–π –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏":"it takes "+c+" days to form a habit"}function ee(e,c,u){const x=new Date;e(x.getDate()),c(x.getMonth()+1),u(x.getFullYear())}export{ct as default};
