import{A as m,t as w,f as z,P as F,l as O,j as n,C as s,bA as ne,bB as se,bC as oe,bD as re,bE as ie,i as J,S as E,k as ae,aW as le,aA as ce}from"./index-CctTinAl.js";import{r as o}from"./recharts-Bg6K2Pzo.js";import{M as de}from"./MyInput-BxKdnKJK.js";import{S as X}from"./Slider-DLWkaKYj.js";const ue=(e,t,r,a,i)=>{const g={bedtime:r,duration:t,mood:a,note:i??""};m.sleepingLog={...m.sleepingLog,[e]:g}};new Audio("Audio/Click.wav");const I=(e,t)=>[s.get("difficulty3",e),s.get("difficulty2",e),s.get("difficulty1",e),s.get("difficulty0",e),s.get("difficulty5",e)][t],pe=4,ge=12,xe=10,fe=pe*60*60*1e3,be=480*60*1e3,he=ge*60*60*1e3,K=xe*60*1e3,ye=({dateString:e})=>{const[t,r]=o.useState(w.value),[a,i]=o.useState(z.value),[g,l]=o.useState(m.prefs[0]),[y,j]=o.useState(F.value),[p,f]=o.useState(0),[d,S]=o.useState(4),[D,_]=o.useState(be),[M,P]=o.useState(1320*60*1e3),[H,N]=o.useState("");o.useEffect(()=>{const x=w.subscribe(r),k=z.subscribe(i);return()=>{x.unsubscribe(),k.unsubscribe()}},[]),o.useEffect(()=>{const x=w.subscribe(r),k=O.subscribe(B=>{l(B==="ru"?0:1)});return()=>{x.unsubscribe(),k.unsubscribe()}},[]),o.useEffect(()=>{const x=F.subscribe(j);return y==="SleepNew"?setTimeout(()=>f(1),400):f(0),()=>{x.unsubscribe()}},[y]);const C=async()=>{ue(e,D,M,d,H),await le(),E("")};return n.jsx("div",{style:{...u(t).container,transform:y==="SleepNew"&&Se(e)?"translateX(0)":"translateX(-100%)",backgroundColor:p===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:n.jsxs("div",{style:u(t).panel,children:[n.jsx("p",{style:u(t,a).text,children:g===0?"–í–æ —Å–∫–æ–ª—å–∫–æ —É—Å–Ω—É–ª?":"What time did you go to bed?"}),n.jsxs("div",{style:{width:"100%"},children:[n.jsx("p",{style:u(t,a).textDate,children:V(M)}),n.jsx(X,{onChange:x=>P(x.target.value),min:0,max:1440*60*1e3,step:K,value:M,style:u(t).slider})]}),n.jsx("p",{style:u(t,a).text,children:g===0?"–°–∫–æ–ª—å–∫–æ —Å–ø–∞–ª —Å–µ–≥–æ–¥–Ω—è?":"How much did you sleep today?"}),n.jsxs("div",{style:{width:"100%"},children:[n.jsx("p",{style:u(t,a).textDate,children:V(D)}),n.jsx(X,{onChange:x=>_(x.target.value),min:fe,max:he,step:K,value:D,style:u(t).slider})]}),n.jsx("p",{style:u(t,a).text,children:g===0?"–ö–∞–∫ —Å–∞–º–æ—á—É–≤—Å—Ç–∏–µ?":"How do you feel?"}),n.jsxs("div",{style:u(t).simplePanelRow,children:[n.jsx(ne,{style:{...u(t).icon,color:d===1?I(t,0):s.get("simplePanel",t)},onClick:()=>S(1)}),n.jsx(se,{style:{...u(t).icon,color:d===2?I(t,1):s.get("simplePanel",t)},onClick:()=>S(2)}),n.jsx(oe,{style:{...u(t).icon,color:d===3?I(t,2):s.get("simplePanel",t)},onClick:()=>S(3)}),n.jsx(re,{style:{...u(t).icon,color:d===4?I(t,3):s.get("simplePanel",t)},onClick:()=>S(4)}),n.jsx(ie,{style:{...u(t).icon,color:d===5?I(t,4):s.get("simplePanel",t)},onClick:()=>S(5)})]}),n.jsx(de,{maxL:500,h:"20%",w:"90%",placeHolder:g===0?"–ó–∞–º–µ—Ç–∫–∞(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ , –º–æ–∂–µ—à—å –∑–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π —Å–æ–Ω)":"Notes(optional , can write your dream)",theme:t,onChange:x=>N(x)}),n.jsxs("div",{style:{...u(t).simplePanelRow,marginTop:"55px"},children:[n.jsx(J,{style:{...u(t).icon,fontSize:"38px"},onClick:()=>E("")}),n.jsx(ae,{style:{...u(t).icon,fontSize:"38px"},onClick:()=>C()})]})]})})},u=(e,t)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,width:"100vw"},panel:{alignItems:"center",justifyItems:"center",borderRadius:"24px",border:`1px solid ${s.get("border",e)}`,margin:"5px",backgroundColor:s.get("background",e),boxShadow:`4px 4px 6px ${s.get("shadow",e)}`,width:"95vw",height:"70vh",marginBottom:"16%"},text:{textAlign:"center",fontSize:t?"13px":"15px",color:s.get("mainText",e),marginBottom:"12px"},subtext:{textAlign:"center",fontSize:t?"11px":"13px",color:s.get("subText",e),marginBottom:"12px"},textDate:{textAlign:"center",fontSize:"18px",color:s.get("mainText",e),marginBottom:"4px"},simplePanelRow:{width:"85vw",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-around",userSelect:"none",touchAction:"none"},icon:{fontSize:"58px",padding:"5px",marginTop:"10px",color:s.get("icons",e),userSelect:"none",touchAction:"none"},slider:{width:"90%",userSelect:"none",touchAction:"none",color:s.get("icons",e)}}),V=e=>{const t=Math.floor(e/6e4),r=Math.floor(t/60),a=t%60;return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`};function Se(e){const t=new Date(e),r=new Date;t.setHours(0,0,0,0),r.setHours(0,0,0,0);const a=t<=r;return a||E(""),a}new Audio("Audio/Click.wav");const me=()=>{const[e,t]=o.useState(w.value),[r,a]=o.useState(z.value),[i,g]=o.useState(m.prefs[0]),[l,y]=o.useState(F.value),[j,p]=o.useState(0);return o.useEffect(()=>{const f=w.subscribe(t),d=z.subscribe(a);return()=>{f.unsubscribe(),d.unsubscribe()}},[]),o.useEffect(()=>{const f=w.subscribe(t),d=O.subscribe(S=>{g(S==="ru"?0:1)});return()=>{f.unsubscribe(),d.unsubscribe()}},[]),o.useEffect(()=>{const f=F.subscribe(y);return l==="SleepInsight"?setTimeout(()=>p(1),400):p(0),()=>{f.unsubscribe()}},[l]),n.jsx("div",{style:{...G(e).container,transform:l==="SleepInsight"?"translateX(0)":"translateX(-100%)",backgroundColor:j===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:n.jsxs("div",{style:G(e).panel,children:[n.jsx("div",{style:{fontSize:r===0?"15px":"18px",color:s.get("mainText",e),fontWeight:"bold"},children:i===0?"–ò–ò –∞–Ω–∞–ª–∏–∑ü§ñ‚ú®":"AI analysisü§ñ‚ú®"}),n.jsx("div",{style:{width:"90%",height:"80%",overflowY:"scroll",borderTop:`1px solid ${s.get("border",e)}`,borderBottom:`1px solid ${s.get("border",e)}`,padding:"16px",fontSize:r===0?"14px":"16px",color:s.get("mainText",e),textAlign:"left"},children:"–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ —Å–æ–±–æ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é!;–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫–∞ –Ω–∏–∑–∫–∞—è: —Ö–æ–¥—å–±–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ª–∏—à—å 3 –∏–∑ 7 –¥–Ω–µ–π, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, –¥—ã—Ö–∞–Ω–∏—è –∏ –∑–∞–∫–∞–ª–∏–≤–∞–Ω–∏—è –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ. –û–¥–Ω–∞–∫–æ —Å–æ–Ω –∏ –æ—Ç–∫–∞–∑ –æ—Ç –∫—É—Ä–µ–Ω–∏—è ‚Äî —Ç–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã.–¢—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–µ—Ä–∂–∏–≤–∞–µ—à—å –æ—Ç–∫–∞–∑ –æ—Ç –∫—É—Ä–µ–Ω–∏—è ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å! –°–æ–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞ –¥–Ω—è —Å—Ç–∞–ª –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ 5/5), –∞ –∑–Ω–∞—á–∏—Ç, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–ª—É—á—à–∞–µ—Ç—Å—è.;–ü—Ä–æ–±–ª–µ–º—ã: —Ö–æ–¥—å–±–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∞ –≤ 4 –¥–Ω—è—Ö –ø–æ–¥—Ä—è–¥, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º, –¥—ã—Ö–∞–Ω–∏—é, –º–µ–¥–∏—Ç–∞—Ü–∏–∏ (–∫—Ä–æ–º–µ –æ–¥–Ω–æ–≥–æ –¥–Ω—è) –∏ –∑–∞–∫–∞–ª–∏–≤–∞–Ω–∏—é. –≠—Ç–æ –∫–ª—é—á–µ–≤—ã–µ –∑–æ–Ω—ã —Ä–æ—Å—Ç–∞.;–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –Ω–µ–¥–µ–ª—é:–ì—É–ª—è–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –¥–∞–∂–µ 20 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ —É–∂–∏–Ω–∞.–î–æ–±–∞–≤—å 5‚Äë–º–∏–Ω—É—Ç–Ω—É—é –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–∞–∫—Ç–∏–∫—É —É—Ç—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4‚Äë7‚Äë8).–°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–π –æ—Ç—Ö–æ–¥ –∫–æ —Å–Ω—É ‚Äî –ª–æ–∂–∏—Å—å –¥–æ 23:30, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞.–ü–æ–ø—Ä–æ–±—É–π 1 –∫–æ—Ä–æ—Ç–∫—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (10‚Äì15 –º–∏–Ω) –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ ‚Äî —Ö–æ—Ç—å —Ä–∞–∑!–ü–æ–≤—Ç–æ—Ä–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—é –≤ —Å–ø–æ–∫–æ–π–Ω—ã–π –≤–µ—á–µ—Ä ‚Äî –¥–∞–∂–µ 5 –º–∏–Ω—É—Ç —É–ª—É—á—à–∞—Ç —Ñ–æ–∫—É—Å –∏ –æ—Ç–¥—ã—Ö.–¢—ã —É–∂–µ –Ω–∞ –ø—É—Ç–∏ ‚Äî —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤—å –Ω–µ–º–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ!"}),n.jsxs("div",{children:[n.jsx(J,{onClick:()=>{E("")},style:{fontSize:"42px",color:s.get("icons",e)}}),n.jsx("div",{style:{fontSize:"9px",color:s.get("subText",e)},children:i===0?"–∑–∞–∫—Ä—ã—Ç—å":"close"})]})]})})},G=(e,t)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,width:"100vw"},panel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around",borderRadius:"24px",border:`1px solid ${s.get("border",e)}`,margin:"5px",backgroundColor:s.get("background",e),boxShadow:`4px 4px 6px ${s.get("shadow",e)}`,marginTop:"10vh",width:"95vw",height:"79vh",padding:"5px",marginBottom:"16%"},text:{textAlign:"center",fontSize:"15px",color:s.get("mainText",e),marginBottom:"12px"}}),we=e=>(e.getDay()+6)%7,A=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`},Y=new Audio("Audio/Click.wav"),je=(e,t)=>[s.get("difficulty3",e),s.get("difficulty2",e),s.get("difficulty1",e),s.get("difficulty0",e),s.get("difficulty5",e)][t]||s.get("background",e),q=e=>{if(typeof e!="number"||e<0)return"--:--";const t=Math.floor(e/(60*1e3)),r=Math.floor(t/60),a=t%60;return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`};function L(e){m.prefs[2]===0&&e&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),m.prefs[3]===0&&window.Telegram?.WebApp?.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}const ve=e=>{if(typeof e!="number"||e<0)return 0;const t=3600*1e3,r=4,a=12,i=r*t,g=a*t;if(e<=i)return 0;if(e>=g)return 100;const l=g-i,y=(e-i)/l;return Math.round(y*100)},Te=()=>{const[e,t]=o.useState("dark"),[r,a]=o.useState(m.prefs[0]),[i,g]=o.useState(new Date),[l,y]=o.useState(new Date),j=o.useRef(l),[p,f]=o.useState(m.prefs[4]),[d,S]=o.useState(null);o.useEffect(()=>{const c=w.subscribe(t),v=O.subscribe($=>a($==="ru"?0:1)),b=z.subscribe(f);return()=>{c.unsubscribe(),v.unsubscribe(),b.unsubscribe()}},[]),o.useEffect(()=>{j.current=l},[l]),o.useEffect(()=>{const c=ce.subscribe(()=>{const v=new Date,b=j.current;b>v||(A(b),A(v))});return()=>c.unsubscribe()},[]);const D=new Date(i.getFullYear(),i.getMonth(),1),M=new Date(i.getFullYear(),i.getMonth()+1,0).getDate(),P=(D.getDay()+6)%7,H=[["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"],["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]],N=[["–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫","–í—Ç–æ—Ä–Ω–∏–∫","–°—Ä–µ–¥–∞","–ß–µ—Ç–≤–µ—Ä–≥","–ü—è—Ç–Ω–∏—Ü–∞","–°—É–±–±–æ—Ç–∞","–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"],["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]],C=Array(P).fill(null);for(let c=1;c<=M;c++)C.push(c);const x=[];for(let c=0;c<C.length;c+=7)x.push(C.slice(c,c+7));const k=()=>{g(new Date(i.getFullYear(),i.getMonth()-1)),L(Y)},B=()=>{g(new Date(i.getFullYear(),i.getMonth()+1)),L(Y)},R=i.getMonth(),W=i.getFullYear();return n.jsxs("div",{style:h(e,p).container,children:[n.jsxs("div",{style:h(e,p).panel,children:[n.jsxs("div",{style:h(e,p).calendarHead,children:[n.jsxs("h1",{style:h(e,p).header,children:[i.getFullYear(),"/",String(i.getMonth()+1).padStart(2,"0")]}),n.jsx("div",{onClick:k,style:{cursor:"pointer"},children:n.jsx("h1",{style:h(e,p).header,children:"<"})}),n.jsx("div",{onClick:B,style:{cursor:"pointer"},children:n.jsx("h1",{style:h(e,p).header,children:">"})})]}),n.jsxs("table",{style:h(e,p).table,children:[n.jsx("thead",{children:n.jsx("tr",{children:H[r].map(c=>n.jsx("th",{children:n.jsx("p",{style:{textAlign:"center",fontSize:"12px",color:c==="–í—Å"||c==="Sun"?"#873535ff":s.get("subText",e)},children:c})},c))})}),n.jsx("tbody",{children:x.map((c,v)=>n.jsx("tr",{children:c.map((b,$)=>{if(b===null)return n.jsx("td",{},$);const Q=new Date(W,R,b),Z=A(Q),T=m.sleepingLog?.[Z],U=b===l.getDate()&&R===l.getMonth()&&W===l.getFullYear();let ee=s.get("background",e);return n.jsx("td",{children:n.jsxs("div",{style:{...h(e,p).cell,backgroundColor:ee,border:`3px solid ${U?s.get("currentDateBorder",e):"transparent"}`,color:U?s.get("textHighlight",e):s.get("mainText",e),display:"flex",alignItems:"flex-end",justifyContent:"center",position:"relative",overflow:"hidden",cursor:"pointer"},onClick:()=>{const te=new Date(W,R,b);y(te),L(Y),S(T||null)},children:[T&&typeof T.duration=="number"&&n.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:`${ve(T.duration)}%`,backgroundColor:je(e,T.mood-1),backdropFilter:"blur(2px)",zIndex:0}}),n.jsx("span",{style:{position:"relative",zIndex:1},children:b})]})},$)})},v))})]})]}),n.jsxs("p",{style:{...h(e,p).subtext,fontSize:"18px",textAlign:"center",marginTop:"12px"},children:[l.getDate(),"-",l.getMonth()+1,"-",l.getFullYear()," ",N[r][we(l)]]}),d&&n.jsxs("div",{style:h(e,p).sleepInfoPanel,children:[n.jsxs("p",{children:[n.jsx("strong",{children:r===0?"–í—Ä–µ–º—è –æ—Ç–±–æ—è:":"Bedtime:"})," ",q(d.bedtime)]}),n.jsxs("p",{children:[n.jsx("strong",{children:r===0?"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:":"Duration:"})," ",q(d.duration)]}),n.jsxs("p",{children:[n.jsx("strong",{children:r===0?"–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:":"Mood:"})," ","‚òÖ".repeat(d.mood),"‚òÜ".repeat(5-d.mood)]}),d.note&&n.jsxs("div",{children:[n.jsx("strong",{children:r===0?"–ó–∞–º–µ—Ç–∫–∞:":"Note:"})," ",d.note]})]}),n.jsx(ye,{dateString:A(l)}),n.jsx(me,{dateString:A(l)})]})},h=(e,t)=>({container:{backgroundColor:s.get("background",e),display:"flex",flexDirection:"column",overflowY:"scroll",justifyContent:"start",alignItems:"center",height:"78vh",paddingTop:"5vh",width:"100vw",fontFamily:"Segoe UI"},panel:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center",justifyContent:"start",borderBottom:`1px solid ${s.get("border",e)}`},calendarHead:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",height:"10%",background:s.get("headGradient",e)},header:{fontFamily:"Segoe UI",padding:"2vw",marginLeft:"6vw",marginRight:"6vw",fontSize:"36px",fontWeight:"bold",color:s.get("subText",e)},table:{borderCollapse:"collapse",width:"90%",textAlign:"center",tableLayout:"fixed"},cell:{boxSizing:"border-box",width:"13vw",height:"13vw",borderRadius:"12px",fontSize:"16px",fontWeight:"bold",fontFamily:"Segoe UI"},subtext:{textAlign:"left",fontSize:t===0?"11px":"13px",color:s.get("subText",e),marginLeft:"10px",marginBottom:"12px"},sleepInfoPanel:{marginTop:"16px",padding:"12px",backgroundColor:s.get("card",e),borderRadius:"8px",fontSize:t===0?"13px":"15px",color:s.get("text",e),maxWidth:"90vw",width:"100%"}});export{Te as default};
