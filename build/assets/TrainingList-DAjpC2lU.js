import{r as p,A as m,t as q,l as H,f as J,j as s,C as o}from"./index-DCMt989U.js";import{b as Q,c as V}from"./index-Davgp1jK.js";const X=(e,y)=>{const r=new Date(e),u={weekday:"long"},l=y===0?"ru-RU":"en-US";return r.toLocaleDateString(l,u)},Z=e=>`${Math.floor(e/6e4)} min`,$=["#00c6ff","#0072ff","#ff416c","#ff4b2b","#38ef7d","#11998e","#f09819","#edde5d","#834d9b","#d04ed6","#1d976c","#93f9b9","#5d29c3","#a968f2","#ff7e5f","#feb47b","#2af598","#009efd","#ff6b6b","#ffa500","#114357","#f29492","#43e97b","#38f9d7","#92fe9d","#00c9ff","#2c3e50","#3498db","#c33764","#1d2671","#ff9a9e","#fecfef","#a8ff78","#78ffd6","#b993d6","#8ca6db","#ff758c","#ff7eb3","#4facfe","#00f2fe"],oe=()=>{const[e,y]=p.useState("dark"),[r,u]=p.useState(m.prefs[0]==="ru"?0:1),[l,k]=p.useState(m.prefs[1]),[B,M]=p.useState(null),[i,W]=p.useState(0),[g,D]=p.useState(0),[T,w]=p.useState(0);p.useEffect(()=>{const t=q.subscribe(y),n=H.subscribe(d=>u(d==="ru"?0:1));return()=>{n.unsubscribe(),t.unsubscribe()}},[]),p.useEffect(()=>{const t=J.subscribe(k);return()=>t.unsubscribe()},[]);const{allTrainings:L,sessionColorMap:A}=p.useMemo(()=>{const t=[],n=new Map;let d=0;for(const[a,x]of Object.entries(m.trainingLog||{}))x.forEach((j,I)=>t.push({date:a,idx:I,session:j}));t.sort((a,x)=>(x.session.startTime||0)-(a.session.startTime||0)),t.forEach(({session:a})=>{const x=`${a.programId||0}-${a.dayIndex||0}`;n.has(x)||(n.set(x,$[d%$.length]),d++)});let c=t;return i===1?c=t.filter(a=>a.session.programId===g):i===2&&(c=t.filter(a=>a.session.programId===g&&a.session.dayIndex===T)),{allTrainings:c,sessionColorMap:n}},[m.trainingLog,i,g,T]),S=p.useMemo(()=>{const t=new Set;return Object.values(m.trainingLog||{}).forEach(n=>n.forEach(d=>t.add(d.programId||0))),Array.from(t).map(n=>{const d=m.programs[n];return{id:n,name:d?.name?.[r]||`Program ${n}`}}).sort((n,d)=>n.name.localeCompare(d.name))},[r]),h=p.useMemo(()=>{if(i!==2||g==null)return[];const n=m.programs[g]?.schedule||[];return n.map((d,c)=>({index:c,name:n[c]?.name?.[r]||`Day ${c+1}`}))},[i,g,r]);p.useEffect(()=>{(i===1||i===2)&&S.length>0&&g===0&&D(S[0].id),i===2&&h.length>0&&w(h[0].index)},[i,S,h,g]);const N=r===0?"все":"all",P=r===0?"программа":"program",F=r===0?"день":"day";return s.jsxs("div",{style:f(e).container,children:[s.jsxs("div",{style:f(e).filterContainer,children:[s.jsx("div",{style:f(e).textToggles,children:[{key:0,label:N},{key:1,label:P},{key:2,label:F}].map(({key:t,label:n})=>s.jsxs("span",{onClick:()=>W(t),style:{padding:"6px 8px",cursor:"pointer",fontSize:i===t?l===0?"14px":"16px":l===0?"13px":"14px",fontWeight:i===t?"600":"400",color:i===t?o.get("mainText",e):o.get("subText",e),opacity:i===t?1:.8,transition:"all 0.2s ease"},children:[n,t<2&&s.jsx("span",{style:{margin:"0 10px",color:o.get("border",e),fontSize:l===0?"13px":"15px"},children:"|"})]},t))}),(i===1||i===2)&&s.jsx("select",{value:g,onChange:t=>{const n=Number(t.target.value);D(n),i===2&&h.length>0&&w(h[0]?.index||0)},style:f(e).select,children:S.map(t=>s.jsx("option",{value:t.id,children:t.name},t.id))}),i===2&&s.jsx("select",{value:T,onChange:t=>w(Number(t.target.value)),style:f(e).select,children:h.map(t=>s.jsx("option",{value:t.index,children:t.name},t.index))})]}),L.length>0?L.map(t=>{const{date:n,idx:d,session:c}=t,a=`${n}-${d}`,x=B===a,j=c.programId||0,I=c.dayIndex||0,R=`${j}-${I}`,U=A.get(R)||$[0],z=m.programs[j],O=z?.name?.[r]||`Program ${j}`,G=z?.schedule?.[I]?.name?.[r]||`Day ${I+1}`;return s.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{style:{...f(e,!1,!1,l).sessionPanel,borderTop:`3px ridge ${U}`,backgroundColor:x?o.get("trainingGroupSelected",e):o.get("bottomPanel",e),paddingLeft:"12px",paddingRight:"12px",cursor:"pointer"},onClick:()=>M(x?null:a),children:[s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{style:f(e,!1,!1,l).text,children:[n," • ",X(n,r)]}),s.jsxs("div",{style:f(e,!1,!1,l).subtext,children:[O," • ",G]})]}),x?s.jsx(Q,{size:20,color:o.get("icons",e),style:{marginRight:"20px"}}):s.jsx(V,{size:20,color:o.get("icons",e),style:{marginRight:"20px"}})]}),x&&s.jsxs("div",{style:{width:"100%",paddingLeft:"12px",paddingRight:"12px",paddingBottom:"12px"},children:[s.jsxs("div",{style:f(e,!1,!1,l).subtext,children:[Z(c.duration||0)," • ",(c.tonnage/1e3).toFixed(2)," ",r===0?"тонн":"tons"]}),Object.entries(c.exercises||{}).filter(([v,C])=>C?.sets?.length>0).map(([v,C])=>{const K=parseInt(v,10),Y=m.exercises[K]?.name?.[r]||`Exercise ${v}`;return s.jsxs("div",{style:{...f(e,!1,!1,l).exercisesPanel,backgroundColor:o.get("background",e),borderBottom:`1px solid ${o.get("border",e)}`,width:"100%"},children:[s.jsxs("div",{style:{fontSize:l===0?"13px":"15px",color:o.get("mainText",e),marginBottom:"6px"},children:[Y,s.jsxs("span",{style:{...f(e,!1,!1,l).subtext,marginLeft:"20px"},children:[(C.totalTonnage/1e3).toFixed(2)," ",r===0?"тонн":"tons"]})]}),C.sets.map((b,E)=>{const _=b.type===0?o.get("trainingIsolatedFont",e):o.get("trainingBaseFont",e);return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:l===0?"13px":"15px",color:_,fontWeight:"500",borderBottom:`1px solid ${o.get("border",e)}`,marginTop:"4px"},children:[s.jsxs("span",{children:[E+1,":"]}),s.jsx("span",{children:b.weight}),s.jsx("span",{children:r===0?"кг":"kg"}),s.jsx("span",{children:"×"}),s.jsx("span",{children:b.reps}),b.time!=null&&b.time>0&&s.jsxs("span",{children:["(",Math.round(b.time/1e3),"s)"]})]},E)})]},v)})]})]},a)}):s.jsx("div",{style:{padding:"32px 20px",color:o.get("subText",e),fontSize:l===0?"13px":"15px",textAlign:"center"},children:r===0?"Тренировки не найдены":"No trainings found"})]})},f=(e,y,r,u)=>({container:{backgroundColor:o.get("background",e),display:"flex",flexDirection:"column",overflowY:"auto",alignItems:"center",height:"78vh",paddingTop:"5vh",width:"100vw",fontFamily:"Segoe UI",boxSizing:"border-box",padding:"0 8px"},filterContainer:{display:"flex",gap:"12px",paddingTop:"12px",width:"95%",maxWidth:"800px",flexWrap:"wrap",justifyContent:"center",marginBottom:"16px"},textToggles:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",padding:"8px 0",width:"100%",maxWidth:"400px",userSelect:"none"},select:{borderBottom:`1px solid ${o.get("border",e)}`,backgroundColor:o.get("background",e),color:o.get("subText",e),fontSize:u===0?"11px":"13px",width:"80%",borderTop:"none",borderLeft:"none",borderRight:"none",outline:"none"},sessionPanel:{display:"flex",flexDirection:"row",width:"100%",maxWidth:"800px",height:"6vh",alignItems:"center",justifyContent:"center"},exercisesPanel:{display:"flex",flexDirection:"column",width:"100%",maxWidth:"800px",alignItems:"flex-start",justifyContent:"flex-start"},text:{textAlign:"left",fontSize:u===0?"13px":"15px",color:o.get("mainText",e),marginBottom:"4px"},subtext:{textAlign:"left",fontSize:u===0?"11px":"13px",color:o.get("subText",e),marginBottom:"4px"}});export{oe as default};
