import{R as m,r as u,A as l,t as tt,g as et,l as F,j as i,C as o,b as P,I as at,s as E,J as nt,a as st,K as rt,m as ot,L as it,M as ct}from"./index-BskJfhA8.js";import{B as dt,a as lt,M as B,b as $,A as ut,c as pt,C as ft,d as bt}from"./Calendar_Light-BCEklUL6.js";import{b as gt,c as ht}from"./SaveHelper-C_K9d4BY.js";import{u as xt,a as yt,b as N}from"./index-DLBi4qU-.js";const L=new Date().toISOString().split("T")[0],mt=new Audio(new URL("/UML_Frontend_React/assets/Click-5rJ2A-_B.wav",import.meta.url).href),Ct=new Audio(new URL("/UML_Frontend_React/assets/IsDone-CY5KfW9n.wav",import.meta.url).href),K=new Audio(new URL("/UML_Frontend_React/assets/Skip-C95holY4.wav",import.meta.url).href),_=new Audio(new URL("/UML_Frontend_React/assets/SwitchPanel-CJjFfFgV.wav",import.meta.url).href),wt=new Audio(new URL("/UML_Frontend_React/assets/Transition-DNEfmScM.wav",import.meta.url).href);let St,Dt,kt;const _t=()=>{const[t,r]=m.useState("dark"),[d,a]=m.useState("dark"),[s,e]=m.useState([]),[b,C]=m.useState([]),[x,D]=u.useState(l.prefs[0]),[f,y]=u.useState(l.choosenHabits.length>0);m.useEffect(()=>{const c=tt.subscribe(r);return()=>c.unsubscribe()},[]),m.useEffect(()=>{const c=et.subscribe(a);return()=>c.unsubscribe()},[]),m.useEffect(()=>{const c=F.subscribe(g=>{D(g==="ru"?0:1)});return()=>c.unsubscribe()},[]),m.useEffect(()=>{e(l.choosenHabits)},[]),m.useEffect(()=>{if(s.length>0){const c=new Set;s.forEach(g=>{const h=T().find(S=>S.id===g);h&&h.category&&h.category[x]&&c.add(h.category[x])}),C(Array.from(c))}},[s]);const R=c=>{e(g=>{const h=new Set(g);return h.has(c)?g:(l.addHabit(L,c),[...h,c])}),y(l.choosenHabits.length>0)};return St=c=>{if(s.includes(c)){l.removeHabit(L,c),e(v=>v.filter(H=>H!==c));const S=(T().find(v=>v.id===c)?.name||["",""])[x]||(x===0?"Привычка":"Habit"),k=x===0?`Привычка: '${S}' удалена`:`Habit: '${S}' deleted`;at(k,2e3),y(l.choosenHabits.length>0)}},Dt=R,i.jsxs("div",{style:j(t).container,children:[!f&&i.jsx("div",{style:{...j(t).panel,justifyContent:"center",alignItems:"center",marginTop:"30%"},children:i.jsx("p",{style:{...j(t).subText,fontSize:"12px",margin:"10%",whiteSpace:"pre-line",color:o.get("subText",t)},children:It(x)})}),f&&i.jsx("div",{style:j(t).scrollView,children:vt({theme:t,habitsCards:s,categories:b})}),i.jsx(Rt,{theme:t,globalTheme:d})]})};function T(){return P.concat((l.CustomHabits||[]).filter(t=>!P.some(r=>r.id===t.id)))}function vt({theme:t,habitsCards:r,categories:d}){return d.map(a=>{const s=r.map(e=>T().find(b=>b.id===e)).filter(e=>e&&e.category&&Array.isArray(e.category)&&e.category[0]===a);return i.jsx(jt,{text:a,theme:t,children:s.map(e=>{const b=(e.isCustom,e.src);return i.jsx(Lt,{id:e.id,text:e.name,descr:e.description,imgsrc:b,theme:t},e.id)})},a)})}function Lt({id:t=0,text:r=["Название","Name"],descr:d=["Описание","Description"],imgsrc:a,theme:s}){const[e,b]=u.useState(l.habitsByDate[L]?.[t]),[C,x]=u.useState(l.prefs[0]),[D,f]=u.useState(null),y=100,R=-y,[A,c]=u.useState(!0);let g=o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",s),h=o.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",s),S=o.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",s);const[k,v]=u.useState(!1),[H,I]=u.useState(g);u.useEffect(()=>{const p=F.subscribe(n=>{x(n==="ru"?0:1)});return()=>p.unsubscribe()},[]),u.useEffect(()=>{l.changeStatus(L,t,e)},[e]),u.useEffect(()=>((async()=>{try{if(typeof a=="string"&&(a.startsWith("data:")||a.startsWith("http")||a.startsWith("blob:")))f(a);else if(a&&typeof a=="string"&&a.startsWith("icon_"))try{console.log("Loading custom icon with key:",a);const n=await ht(a);n?(console.log("Successfully loaded custom icon:",a),f(n)):(console.warn("Custom icon not found, using default:",a),f(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href))}catch(n){console.error("Error loading custom icon:",n),f(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href)}else a&&typeof a=="object"&&"default"in a?f(a.default||a):(console.warn("No valid icon source provided, using default"),f(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href))}catch(n){console.error("Error in icon loading logic:",n),f(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href)}})(),()=>{a&&typeof a=="string"&&a.startsWith("blob:")&&URL.revokeObjectURL(a)}),[a]);const M=Array.isArray(r)?r[C]:r,z=Array.isArray(d)?d[C]:d;u.useEffect(()=>{I(o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",s))},[s,e]);const W=xt(0),U=yt(W,[-1,1],[R,y]),Y=()=>{g=o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",s),h=o.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",s),S=o.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",s)},O=(p,n)=>{(e===1&&n.offset.x<0||e!==1)&&I(At(g,n.offset.x>0?S:h,Math.abs(n.offset.x)/y)),Math.abs(n.offset.x)>y&&A&&(J(n.offset.x>0),N(U,0,{type:"tween",duration:.2}),c(!1))},V=()=>{A&&N(U,0,{type:"tween",duration:.2}),I(o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",s)),c(!0)},J=p=>{let n=0;if(p)e===0?n=1:e===-1?n=0:n=1,l.habitsByDate[L][t]=n;else{if(e===0)n=-1;else if(e===1)n=0;else{n=-1,kt=t;const Z=l.prefs[0]===0?`Вы уверены, что хотите удалить привычку: '${M}' ?`:`Are you sure you want to delete '${M}' habit?`;ct(Z)}l.habitsByDate[L][t]=n}n===1?w(Ct,50):n===-1&&w(K,50),I(o.get(n===1?"habitCardDone":n===-1?"habitCardSkipped":"habitCard",s)),b(n)},X=()=>{w(mt,50);const p=!k;v(p),it(p?t:null)};u.useEffect(()=>{const p=rt.subscribe(n=>{v(n===t)});return()=>p.unsubscribe()},[t]);const G={display:"flex",flexDirection:"column",alignItems:"stretch",borderRadius:"24px",margin:"10px",overflow:"hidden",borderStyle:"solid",borderColor:o.get("border",s),borderWidth:1,position:"relative",backgroundColor:H,x:U},q={fontSize:"14px",color:o.get("mainText",s),marginLeft:"20px"},Q={textAlign:"left",fontSize:"10px",color:o.get("subText",s),marginLeft:"70px"};return i.jsxs(ot.div,{id:t,style:G,onClick:X,drag:A?"x":!1,dragConstraints:{left:R,right:e===1?0:y},onDragStart:Y,dragElastic:0,onDrag:O,onDragEnd:V,animate:{height:k?"10vh":"4.5vh",outline:k?"3px solid "+o.get("border",s):"1px solid "+o.get("border",s)},transition:{type:"tween",duration:.4,ease:"easeInOut"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",maxHeight:"40px",paddingBottom:"5px"},children:[D&&i.jsx("img",{src:D,style:{width:"24px",objectFit:"contain",marginLeft:"15px",marginTop:"8px"},onError:p=>{p.target.onerror=null,p.target.src=new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href},alt:""}),i.jsx("h2",{style:q,children:M})]}),k&&i.jsx("div",{style:{paddingBottom:"25px"},children:i.jsx("p",{style:Q,children:z})})]})}function jt({text:t=["Имя","Name"],children:r,theme:d}){const[a,s]=u.useState(l.prefs[0]);u.useEffect(()=>{const b=F.subscribe(C=>{s(C==="ru"?0:1)});return()=>b.unsubscribe()},[]);const e=Array.isArray(t)?t[a]:t;return i.jsxs("div",{style:j(d).categoryPanel,children:[i.jsx("h2",{style:{textAlign:"center",fontSize:"14px",color:o.get("mainText",d)},children:e}),r]})}function Rt({globalTheme:t,theme:r}){const d={position:"fixed",bottom:"0",left:"0",width:"100vw",height:"10vh",borderTopLeftRadius:"24px",borderTopRightRadius:"24px",backgroundColor:o.get("bottomPanel",r),display:"flex",justifyContent:"space-around",alignItems:"center",zIndex:900,boxShadow:`0px -2px 0px ${o.get("bottomPanelShadow",r)}`},a={width:"35px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"};return i.jsxs("div",{style:d,children:[i.jsx("img",{src:t==="dark"?dt:lt,style:a,onClick:()=>{E("MainMenu"),gt(),w(K,50)}}),i.jsx("img",{src:t==="dark"?B:$,style:a,onClick:()=>{E("HabitMetrics"),w(_,50)}}),i.jsx("img",{src:t==="dark"?ut:pt,style:a,onClick:()=>{nt(!0),w(wt,50)}}),i.jsx("img",{src:t==="dark"?B:$,style:a,onClick:()=>{st(!0),w(_,50)}}),i.jsx("img",{src:t==="dark"?ft:bt,style:a,onClick:()=>{E("HabitCalendar"),w(_,50)}})]})}const j=t=>({container:{backgroundColor:o.get("background",t),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI"},categoryPanel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${o.get("border",t)}`,margin:"5px",background:o.get("panelGradient",t),boxShadow:`4px 4px 6px ${o.get("shadow",t)}`},text:{textAlign:"left",fontSize:"10px",color:o.get("subText",t),marginLeft:"30px",marginBottom:"12px"},scrollView:{width:"85vw",height:"74vh",overflowY:"auto",marginTop:"17vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"}});function At(t,r,d){if(!t||!r)return t||r||"#000000";d=Math.max(0,Math.min(1,d)),t=t.replace("#",""),r=r.replace("#","");const a=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),e=parseInt(t.slice(4,6),16),b=parseInt(r.slice(0,2),16),C=parseInt(r.slice(2,4),16),x=parseInt(r.slice(4,6),16),D=Math.round(a+(b-a)*d),f=Math.round(s+(C-s)*d),y=Math.round(e+(x-e)*d);return"#"+D.toString(16).padStart(2,"0")+f.toString(16).padStart(2,"0")+y.toString(16).padStart(2,"0")}function It(t){return t===0?`Вы еще не добавили ни одной привычки

 Вы можете выбрать из списка или добавить свою привычку.

Выбранные привычки будут обновляться автоматически каждый день, если вы пропустите день, привычка будет не выполнена для этого дня.

Вы должны выполнить свою привычку и затем свайпнуть вправо, чтобы отметить её как выполненную.

Чтобы сформировать привычку, вам нужно выполнить ее 66 дней подряд.

Вы можете просмотреть прогресс ваших привычек в панели метрик и календаре.


 * Чтобы начать, нажмите кнопку "+" ниже`:`You have not added any habits yet

 You can choose from the list or add your own habit.

Choosen habits will update automatically every day, if you skip a day, the habit will be skipped for that day.

You need to perform your habit and then swipe right to mark it as done.

To form a habit you need to perform it for 66 days in a row.

You can view a progress of your habits in the metrics panel and calendar.


 * To get started tap the "+" button below`}function w(t,r){l.prefs[2]==0&&t!==null&&(t.paused||(t.pause(),t.currentTime=0),t.volume=.5,t.play()),l.prefs[3]==0&&navigator.vibrate(r)}export{Dt as addHabitFn,kt as currentId,_t as default,St as removeHabitFn};
