import{A as a,U as j,t as _,l as ee,f as te,p as ie,C as s,j as e,m as g,L as se,z as ne,B as oe,D as le,bO as re,G as ae,ca as de,be as ce,bf as pe,cb as xe,cc as ge,b as he,cd as ue,ce as fe,c3 as be,cf as ye,a as me,M as je,a1 as ve,y as Ce}from"./index-Bsoi3VJE.js";import{r as c}from"./recharts-Bg6K2Pzo.js";import{s as M}from"./PaymentService-xvyfjYN6.js";import{e as A,f as P}from"./index-Bu7J8xyl.js";import{S as F}from"./ScrollPicker-Dx2rZwyT.js";const Se=[["Набор массы","Mass gain"],["Сила","Strength"],["Жиросжигание","Weight loss"],["Здоровье","Health"]],T=(t,r,i=1)=>{const l=[];for(let o=t;o<=r;o+=i)l.push(i===1?o:parseFloat(o.toFixed(1)));return l},We=()=>{const[t,r]=c.useState("dark"),[i,l]=c.useState(a.prefs[0]),[o,h]=c.useState(a.prefs[4]),[p,b]=c.useState(j.hasPremium),[u,Ie]=c.useState(j.friends||[]),[O,S]=c.useState(!1),[D,H]=c.useState(a.pData.age||25),[w,z]=c.useState(a.pData.gender||0),[R,U]=c.useState(a.pData.height||175),[B,N]=c.useState(a.pData.wrist||17),[L,E]=c.useState(a.pData.goal||0),[X,V]=c.useState(!1),Y=c.useMemo(()=>T(10,100),[]),q=c.useMemo(()=>T(50,250),[]),J=c.useMemo(()=>T(10,40,.5),[]),k=c.useMemo(()=>Se.map(x=>x[i]),[i]);c.useEffect(()=>{const x=_.subscribe(r),y=ee.subscribe(Z=>l(Z==="ru"?0:1)),f=te.subscribe(h),m=ie.subscribe(b);return()=>{x.unsubscribe(),y.unsubscribe(),f.unsubscribe(),m.unsubscribe()}},[]);const d=c.useMemo(()=>{const x=Te(),y=[{title:["Новичок","Novice"],color:"#4f4f4f"},{title:["Искатель","Seeker"],color:"#4CAF50"},{title:["Достигатор","Achiever"],color:"#2196F3"},{title:["Элита","Elite"],color:"#9C27B0"},{title:["Легенда","Legend"],color:"#FFD700"}];let f=0;const m=x.level.current;return m>=50?f=4:m>=20?f=3:m>=10?f=2:m>=5&&(f=1),{...x,level:{...x.level,title:y[f].title[i],color:y[f].color},body:{age:a.pData?.age||"--",height:a.pData?.height||"--",gender:a.pData?.gender,goal:k[a.pData?.goal]||"--"}}},[i,a.trainingLog,a.choosenHabits,a.pData]),K=()=>be(""),Q=async()=>{a.pData={filled:!0,age:D,gender:w,height:R,wrist:B,goal:L},await Ce(),S(!1)},n=v(t),W=p?"#FFD700":s.get("accent",t);return e.jsxs(g.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},style:n.container,children:[e.jsxs("div",{style:n.header,children:[e.jsx("span",{style:n.headerTitle,children:i===0?"Профиль":"Profile"}),e.jsx("div",{style:{width:40}})]}),e.jsxs("div",{style:n.scrollContent,className:"no-scrollbar",children:[e.jsxs("div",{style:n.heroSection,children:[e.jsxs("div",{style:{...n.avatarWrapper,borderColor:W},children:[j.photo?e.jsx("img",{src:j.photo,style:n.avatarImg,alt:"user"}):e.jsx("div",{style:n.avatarPlaceholder,children:j.name?.charAt(0).toUpperCase()}),p&&e.jsx("div",{style:n.premiumMiniBadge,children:e.jsx(se,{size:10})}),e.jsxs("div",{style:{...n.levelBadge,backgroundColor:d.level.color,boxShadow:`0 4px 15px ${d.level.color}60`},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"700",textTransform:"uppercase"},children:"LVL"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"900",lineHeight:1},children:d.level.current})]})]}),e.jsx("h2",{style:n.userName,children:j.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px"},children:[e.jsx("span",{style:{...n.userTitle,color:d.level.color},children:d.level.title}),d.body.gender!==void 0&&e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 8px",borderRadius:"12px",backgroundColor:d.body.gender===0?"rgba(59, 130, 246, 0.15)":"rgba(236, 72, 153, 0.15)",color:d.body.gender===0?"#3B82F6":"#EC4899"},children:d.body.gender===0?e.jsx(A,{size:14}):e.jsx(P,{size:14})})]}),e.jsxs("div",{style:n.xpContainer,children:[e.jsxs("div",{style:n.xpInfo,children:[e.jsx("span",{children:"XP"}),e.jsxs("span",{children:[Math.floor(d.level.xp)," / ",d.level.needed]})]}),e.jsx("div",{style:n.xpTrack,children:e.jsx(g.div,{initial:{width:0},animate:{width:`${d.level.percent}%`},transition:{duration:1,ease:"easeOut"},style:{...n.xpFill,backgroundColor:d.level.color}})})]})]}),e.jsxs("div",{style:n.metricsScrollContainer,children:[e.jsx(C,{icon:e.jsx(ne,{}),label:i===0?"Привычки":"Habits",value:d.counts.habits,color:"#FFD700",theme:t}),e.jsx(C,{icon:e.jsx(oe,{}),label:i===0?"Тренировки":"Trainings",value:d.counts.training,color:"#FF4D4D",theme:t}),e.jsx(C,{icon:e.jsx(le,{}),label:i===0?"Ментал":"Mental",value:d.counts.mental,color:"#4DA6FF",theme:t}),e.jsx(C,{icon:e.jsx(re,{}),label:i===0?"Восстан.":"Recovery",value:d.counts.recovery,color:"#4DFF88",theme:t}),e.jsx(C,{icon:e.jsx(ae,{}),label:i===0?"Сон":"Sleep",value:d.counts.sleep,color:"#A64DFF",theme:t})]}),e.jsxs("div",{style:n.infoGrid,children:[e.jsx(I,{icon:e.jsx(de,{}),label:i===0?"Возраст":"Age",value:`${d.body.age}`,theme:t}),e.jsx(I,{icon:e.jsx(ce,{}),label:i===0?"Рост":"Height",value:`${d.body.height} cm`,theme:t}),e.jsx(I,{icon:e.jsx(pe,{}),label:i===0?"Цель":"Goal",value:d.body.goal,theme:t,fullWidth:!0})]}),e.jsxs("div",{style:{marginTop:"25px",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",padding:"0 5px"},children:[e.jsxs("div",{onClick:()=>V(x=>!x),style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(xe,{color:s.get("subText",t)}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"800",color:s.get("mainText",t),textTransform:"uppercase"},children:i===0?"Друзья":"Friends"})]}),u.length>0&&e.jsxs(g.button,{whileTap:{scale:.9},onClick:M,style:{background:"none",border:"none",color:W,fontWeight:"700",fontSize:"12px",cursor:"pointer"},children:["+ ",i===0?"Пригласить":"Invite"]})]}),u.length===0?e.jsxs("div",{style:n.emptyState,children:[e.jsx("span",{style:{fontSize:"14px",color:s.get("subText",t),textAlign:"center",marginBottom:"10px"},children:i===0?"У вас пока нет друзей в приложении.":"No friends yet. Invite them to earn Premium!"}),e.jsxs(g.button,{whileTap:{scale:.95},onClick:M,style:{...n.priBtn,width:"auto",padding:"10px 25px",fontSize:"14px"},children:[e.jsx(ge,{style:{marginRight:"8px"}})," ",i===0?"Пригласить друга":"Invite a Friend"]})]}):X?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:u.map((x,y)=>e.jsx(ke,{friend:x,theme:t,lang:i},y))}):null]}),!p&&e.jsx(g.div,{whileTap:{scale:.98},onClick:()=>he("premium"),style:{...n.premiumCard,background:p?"linear-gradient(135deg, #FFD700 0%, #FFA000 100%)":"linear-gradient(135deg, #232526 0%, #414345 100%)"},children:e.jsxs("div",{style:n.premiumInfo,children:[e.jsx("div",{style:{color:p?"#000":"#FFD700"},children:e.jsx(ue,{size:28})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{...n.premTitle,color:p?"#000":"#FFF"},children:p?"UltyMyLife Premium":i===0?"Активировать Premium":"Activate Premium"}),e.jsx("span",{style:{...n.premSub,color:p?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.6)"},children:p?i===0?"Все функции разблокированы":"All features unlocked":i===0?"Статистика, ИИ и облако":"Analytics, AI & Cloud"})]})]})}),e.jsxs("div",{style:n.actionList,children:[e.jsx(G,{icon:e.jsx(fe,{}),label:i===0?"Изменить персональные данные":"Edit personal data",theme:t,onClick:()=>S(!0)}),e.jsx(G,{onClick:K,icon:e.jsx(ye,{}),label:i===0?"Выйти":"Logout",theme:t,noBorder:!0,color:"#FF4D4D"})]}),e.jsx("div",{style:{height:"100px"}})]}),e.jsx(me,{children:O&&e.jsxs(Fe,{onClose:()=>S(!1),theme:t,children:[e.jsx("h3",{style:n.modalTitle,children:i===0?"Параметры тела":"Body Metrics"}),e.jsxs("div",{style:{padding:"20px 0"},children:[e.jsxs("div",{style:{...n.pickerRow,justifyContent:"space-around"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:n.pickerLabel,children:i===0?"Возраст":"Age"}),e.jsx(F,{items:Y,value:D,onChange:H,theme:t,width:"100px"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:n.pickerLabel,children:i===0?"Рост (см)":"Height"}),e.jsx(F,{items:q,value:R,onChange:U,theme:t,width:"100px"})]})]}),e.jsxs("div",{style:{...n.pickerRow,justifyContent:"space-around",marginTop:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:n.pickerLabel,children:i===0?"Запястье (см)":"Wrist"}),e.jsx(F,{items:J,value:B,onChange:N,theme:t,width:"100px"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100px"},children:[e.jsx("span",{style:{...n.pickerLabel,marginBottom:"10px"},children:i===0?"Пол":"Gender"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx($,{active:w===0,icon:e.jsx(A,{}),color:"#5fb6c6",onClick:()=>z(0),theme:t}),e.jsx($,{active:w===1,icon:e.jsx(P,{}),color:"#c65f9d",onClick:()=>z(1),theme:t})]})]})]}),e.jsxs("div",{style:{...n.pickerRow,flexDirection:"column",marginTop:"15px"},children:[e.jsx("span",{style:n.pickerLabel,children:i===0?"Цель":"Goal"}),e.jsx(F,{items:k,value:k[L],onChange:x=>E(k.indexOf(x)),theme:t,width:"200px"})]})]}),e.jsx(we,{onClose:()=>S(!1),onConfirm:Q,theme:t})]})})]})},ke=({friend:t,theme:r,lang:i})=>{const l=t.level||1,o=t.xp||0,h=l*500,p=Math.min(100,Math.max(0,o/h*100));return e.jsxs("div",{style:{backgroundColor:s.get("simplePanel",r),borderRadius:"16px",padding:"10px 15px",display:"flex",alignItems:"center",gap:"12px",border:`1px solid ${s.get("border",r)}30`},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"900",color:s.get("mainText",r),flexShrink:0},children:t.name?t.name.charAt(0).toUpperCase():"?"}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:"700",color:s.get("mainText",r)},children:t.name}),e.jsxs("span",{style:{fontSize:"10px",fontWeight:"800",color:s.get("accent",r),backgroundColor:"rgba(255,215,0,0.1)",padding:"2px 6px",borderRadius:"6px"},children:["LVL ",l]})]}),e.jsx("div",{style:{width:"100%",height:"4px",backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"2px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${p}%`,height:"100%",backgroundColor:s.get("accent",r),borderRadius:"2px"}})})]})]})},Fe=({children:t,onClose:r,theme:i})=>e.jsx("div",{style:v(i).backdrop,onClick:r,children:e.jsxs(g.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},style:v(i).sheet,onClick:l=>l.stopPropagation(),children:[e.jsx("div",{style:v(i).handle}),t]})}),$=({active:t,icon:r,color:i,onClick:l,theme:o})=>e.jsx(g.div,{whileTap:{scale:.9},onClick:l,style:{width:"40px",height:"40px",borderRadius:"12px",backgroundColor:t?i:o==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",color:t?"#fff":s.get("subText",o),border:t?"none":`1px solid ${s.get("border",o)}`},children:r}),we=({onClose:t,onConfirm:r,theme:i})=>e.jsxs("div",{style:{display:"flex",gap:"15px",marginTop:"25px"},children:[e.jsx(g.button,{whileTap:{scale:.95},onClick:t,style:v(i).secBtn,children:e.jsx(je,{size:22})}),e.jsx(g.button,{whileTap:{scale:.95},onClick:r,style:v(i).priBtn,children:e.jsx(ve,{size:22})})]}),C=({icon:t,label:r,value:i,color:l,theme:o})=>e.jsxs("div",{style:{minWidth:"85px",height:"55px",backgroundColor:s.get("simplePanel",o),borderRadius:"18px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginRight:"10px",border:`1px solid ${s.get("border",o)}50`,flexShrink:0},children:[e.jsx("div",{style:{color:l,fontSize:"18px",marginBottom:"6px"},children:t}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"900",color:s.get("mainText",o)},children:i}),e.jsx("div",{style:{fontSize:"10px",color:s.get("subText",o),fontWeight:"bold"},children:r})]}),I=({icon:t,label:r,value:i,theme:l,fullWidth:o})=>e.jsxs("div",{style:{gridColumn:o?"span 2":"span 1",backgroundColor:s.get("simplePanel",l),borderRadius:"18px",padding:"15px",display:"flex",alignItems:"center",gap:"12px",border:`1px solid ${s.get("border",l)}50`},children:[e.jsx("div",{style:{color:s.get("accent",l),fontSize:"18px"},children:t}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:"10px",color:s.get("subText",l),fontWeight:"bold",textTransform:"uppercase"},children:r}),e.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:s.get("mainText",l)},children:i})]})]}),G=({icon:t,label:r,theme:i,noBorder:l,color:o,onClick:h})=>e.jsxs(g.div,{whileTap:{backgroundColor:"rgba(255,255,255,0.05)"},onClick:h,style:{display:"flex",alignItems:"center",padding:"18px",cursor:"pointer",borderBottom:l?"none":`1px solid ${s.get("border",i)}30`},children:[e.jsx("div",{style:{marginRight:"15px",color:o||s.get("subText",i),fontSize:"18px"},children:t}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"600",color:o||s.get("mainText",i),flex:1},children:r})]}),v=(t,r)=>{const i=s.get("mainText",t),l=s.get("subText",t),o=s.get("simplePanel",t);return{container:{backgroundColor:s.get("background",t),display:"flex",flexDirection:"column",height:"100vh",width:"100vw",fontFamily:"Segoe UI, sans-serif",zIndex:3e3,position:"fixed",top:0,left:0},header:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",padding:"50px 20px 20px 20px",position:"relative"},backBtn:{position:"absolute",left:"20px",width:"40px",height:"40px",borderRadius:"14px",backgroundColor:o,color:i,display:"flex",alignItems:"center",justifyContent:"center"},headerTitle:{fontSize:"17px",fontWeight:"800",color:i,letterSpacing:"0.5px"},scrollContent:{flex:1,overflowY:"auto",padding:"0 20px"},heroSection:{display:"flex",flexDirection:"column",alignItems:"center",margin:"10px 0 20px 0",position:"relative"},avatarWrapper:{width:"80px",height:"80px",borderRadius:"20px",border:"3px solid",padding:"6px",position:"relative",marginBottom:"15px"},avatarImg:{width:"100%",height:"100%",borderRadius:"12px",objectFit:"cover"},avatarPlaceholder:{width:"100%",height:"100%",borderRadius:"32px",backgroundColor:o,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"38px",fontWeight:"900",color:i},premiumMiniBadge:{position:"absolute",bottom:"0px",right:"0px",backgroundColor:"#FFD700",color:"#000",width:"28px",height:"28px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.4)",border:"2px solid #000",zIndex:1},levelBadge:{position:"absolute",top:"-10px",right:"-15px",color:"#FFF",padding:"4px 10px",borderRadius:"12px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:`3px solid ${s.get("background",t)}`,zIndex:2},userName:{fontSize:"26px",fontWeight:"900",color:i,margin:0},userTitle:{fontSize:"13px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px"},xpContainer:{width:"100%",marginTop:"15px",padding:"0 10px"},xpInfo:{display:"flex",justifyContent:"space-between",fontSize:"11px",fontWeight:"700",color:l,marginBottom:"6px"},xpTrack:{width:"100%",height:"8px",backgroundColor:o,borderRadius:"4px",overflow:"hidden"},xpFill:{height:"100%",borderRadius:"4px"},metricsScrollContainer:{display:"flex",overflowX:"auto",padding:"5px",margin:"15px 0",scrollbarWidth:"none",msOverflowStyle:"none"},infoGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",margin:"10px 0"},emptyState:{backgroundColor:o,borderRadius:"24px",padding:"25px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:`1px dashed ${s.get("border",t)}50`},premiumCard:{borderRadius:"24px",padding:"20px",margin:"15px 0"},premiumInfo:{display:"flex",alignItems:"center",gap:"18px"},premTitle:{fontSize:"17px",fontWeight:"900"},premSub:{fontSize:"12px",fontWeight:"bold"},actionList:{backgroundColor:o,borderRadius:"28px",overflow:"hidden",marginTop:"10px"},backdrop:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(5px)",zIndex:3e3,display:"flex",alignItems:"flex-end",justifyContent:"center"},sheet:{width:"100%",maxWidth:"600px",backgroundColor:s.get("background",t),borderTopLeftRadius:"30px",borderTopRightRadius:"30px",padding:"20px 20px 40px 20px",boxShadow:"0 -10px 40px rgba(0,0,0,0.3)",borderTop:`1px solid ${s.get("border",t)}`,display:"flex",flexDirection:"column"},handle:{width:"40px",height:"4px",backgroundColor:s.get("subText",t),borderRadius:"2px",margin:"0 auto 20px auto",opacity:.3},modalTitle:{fontSize:"18px",fontWeight:"800",color:i,margin:"0 0 20px 0",textAlign:"center"},pickerLabel:{fontSize:"12px",color:l,marginBottom:"5px"},pickerRow:{display:"flex",alignItems:"center",backgroundColor:t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"15px"},secBtn:{flex:1,padding:"15px",borderRadius:"16px",border:"none",backgroundColor:s.get("skipped",t),color:l,cursor:"pointer",display:"flex",justifyContent:"center"},priBtn:{flex:1,padding:"15px",borderRadius:"16px",border:"none",backgroundColor:s.get("done",t),color:"#fff",cursor:"pointer",display:"flex",justifyContent:"center",boxShadow:"0 5px 15px rgba(0,0,0,0.2)"}}},Te=()=>{const t=a.choosenHabits?.length||0,r=Object.keys(a.trainingLog||{}).length,i=Object.keys(a.mentalLog||{}).length,l=Object.keys(a.sleepingLog||{}).length,o=Object.keys(a.meditationLog||{}).length+Object.keys(a.breathingLog||{}).length+Object.keys(a.hardeningLog||{}).length,h=r*50+i*30+l*20+o*20+t*10;let p=1,b=500,u=0;for(;h>=b;)u=b,p++,b+=p*500;return{counts:{habits:t,training:r,mental:i,sleep:l,recovery:o},level:{current:p,xp:h-u,needed:b-u,percent:Math.min(100,Math.max(0,(h-u)/(b-u)*100))}}};export{Te as calculateStats,We as default};
