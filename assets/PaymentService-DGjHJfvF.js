import{U as m}from"./index-BcuzrNjI.js";const a="https://ultymylife.ru",{WebApp:y}=window.Telegram;async function f(t,r){try{const e=await w(t,r);if(!e.success||!e.confirmation?.confirmation_url||!e.paymentId)throw new Error("Invalid payment response: missing paymentId or URL");localStorage.setItem("pendingPaymentId",e.paymentId),window.Telegram?.WebApp?.openLink?window.Telegram.WebApp.openLink(e.confirmation.confirmation_url):window.open(e.confirmation.confirmation_url,"_blank")}catch(e){throw console.error("Failed to start payment:",e),e}}async function w(t,r){try{const e=await fetch(`${a}/api/sbp-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,plan:r})});if(!e.ok)throw new Error(`HTTP ${e.status}`);return await e.json()}catch(e){throw console.error("Network error in createSbpInvoice:",e),new Error("Network error: could not reach payment server")}}async function T(t,r){if(!window.Telegram?.WebApp){alert("Telegram Stars payments are only available inside Telegram.");return}try{const e=await fetch(`${a}/api/tg-stars-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,plan:r})});if(!e.ok){const o=await e.text();throw console.error("Stars API Error Body:",o),new Error(`Server returned status: ${e.status}`)}const n=await e.json();if(!n.success)throw new Error(n.error||"Failed to create Stars invoice");window.Telegram.WebApp.openTelegramLink(n.invoice_link)}catch(e){throw console.error("Stars payment error:",e),alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—á—ë—Ç Telegram Stars. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."),e}}async function u(t,r){try{const e=await fetch(`${a}/api/ton-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,plan:r})});if(!e.ok)throw new Error(`HTTP ${e.status}`);const n=await e.json();if(!n.success)throw new Error(n.error||"Failed to create TON invoice");const{address:o,amount:s,comment:c}=n,p=Math.round(s*1e9),l=encodeURIComponent(c),i=`ton://transfer/${o}?amount=${p}&text=${l}`;window.Telegram?.WebApp?window.Telegram.WebApp.openTelegramLink(i):window.open(i,"_blank")}catch(e){throw console.error("TON payment error:",e),alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø–ª–∞—Ç–µ–∂ TON. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."),e}}async function h(){if(!window.Telegram?.WebApp){alert("Available only in Telegram");return}const t=m.id;if(!t){alert("User ID not found");return}const e=`https://t.me/UltyMyLife_bot?start=${t}`;window.Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(e)}&text=${encodeURIComponent("–ü—Ä–∏–≤–µ—Ç! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ UltyMyLife –∏ –ø–æ–ª—É—á–∏–º –æ–±–∞ –ø–æ –º–µ—Å—è—Ü—É Premium –±–µ—Å–ø–ª–∞—Ç–Ω–æ! üéÅ")}`)}export{T as a,u as b,f as i,h as s};
