import{A as i}from"./index-DyEQeQ_s.js";function m(n){return new Date(n).toISOString().split("T")[0]}function S(n,s){if(!n?.exercises)return s===0?"0 упр./ 0 подх.":"0 ex./ 0 sets";let o=0,e=0;for(const t of Object.values(n.exercises))t.completed&&(o++,Array.isArray(t.sets)&&(e+=t.sets.length));return s===0?` / ${o} упр. / ${e} подх.`:` / ${o} ex. / ${e} sets`}function L(n,s,o,e){if(!e||typeof n!="string"||typeof s!="number")return null;const t=o.getTime();let r=null,a=-1/0;for(const[p,f]of Object.entries(e)){const l=new Date(p).getTime();if(!(l>=t))for(const g of f){if(!g.completed)continue;const d=g.exercises?.[n];if(!d||!Array.isArray(d.sets))continue;const u=d.sets[s];!u||typeof u.reps!="number"||typeof u.weight!="number"||l>a&&(a=l,r={type:u.type,reps:u.reps,weight:u.weight,time:u.time})}}return r}function b(n,s,o){const e=i.programs.find(f=>f.id===s);if(!e||!e.schedule[o])return console.error("Invalid program or dayIndex"),!1;const t={},r=[];e.schedule[o].exercises.forEach(f=>{const c=i.exercises.find(l=>l.id===f.exId);if(!c){console.warn(`Exercise ${f.exId} not found in AppData.exercises`);return}t[f.exId]={mgId:c.mgId,sets:[],totalTonnage:0,completed:!1},r.push(f.exId)});const a=m(n),p={programId:s,dayIndex:o,completed:!1,startTime:Date.now(),endTime:null,duration:0,tonnage:0,exercises:t,exerciseOrder:r};return i.trainingLog[a]||(i.trainingLog[a]=[]),i.trainingLog[a].push(p),!0}function O(n,s,o,e,t){const r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=r.getTime()+e,p=r.getTime()+t,f=p-a,c={};i.programs.find(u=>u.id===s).schedule[o].exercises.forEach(u=>{const x=[],T=i.exercises.find(y=>y.id===u.exId);if(!T){console.warn(`Exercise ${u.exId} not found in AppData.exercises`);return}c[u.exId]={mgId:T.mgId,sets:[],totalTonnage:0,completed:!1},x.push(u.exId)});const g={programId:s,dayIndex:o,completed:!0,startTime:a,endTime:p,duration:f,tonnage:0,exercises:c,exerciseOrder},d=m(n);return i.trainingLog[d]||(i.trainingLog[d]=[]),i.trainingLog[d].push(g),!0}function K(n,s){const o=m(n),e=i.trainingLog[o];return!e||s<0||s>=e.length?!1:(e.splice(s,1),e.length===0&&delete i.trainingLog[o],!0)}function D(n,s){const o=m(n),e=i.trainingLog[o]?.[s];return!e||e.completed?!1:(e.endTime=Date.now(),e.duration=e.endTime-e.startTime,e.completed=!0,Object.values(e.exercises).map(t=>{t.completed=!0}),e.tonnage=Object.values(e.exercises).reduce((t,r)=>t+(r.totalTonnage||0),0),!0)}function A(n,s,o){const e=m(n),t=i.trainingLog[e]?.[s];return!t||t.exercises[o]?!1:(t.exercises[o]={mgId:i.exercises[o]?.mgId||0,sets:[],totalTonnage:0,completed:!1},t.exerciseOrder.push(o),!0)}function v(n,s,o){const e=m(n),t=i.trainingLog[e]?.[s];if(!t||!t.exercises[o])return!1;const r=t.exercises[o];return t.tonnage=Math.max(0,t.tonnage-(r.totalTonnage||0)),delete t.exercises[o],t.exerciseOrder&&(t.exerciseOrder=t.exerciseOrder.filter(a=>a!==o)),!0}function w(n,s,o,e,t,r,a){const p=m(n),f=i.trainingLog[p]?.[s],c=f?.exercises?.[o];if(!c)return!1;const g={type:a?0:1,reps:e,weight:t,time:r};c.sets.push(g);const d=e*t;return c.totalTonnage=(c.totalTonnage||0)+d,f.tonnage=(f.tonnage||0)+d,!0}function E(n,s,o,e,t,r,a,p){const f=m(n),c=i.trainingLog[f]?.[s],l=c?.exercises?.[o];if(!l||e<0||e>=l.sets.length)return!1;const g=l.sets[e],d=p?0:1;if(g.reps===t&&g.weight===r&&a===g.time&&g.type===d)return!0;const u=g.reps*g.weight;l.totalTonnage=Math.max(0,(l.totalTonnage||0)-u),c.tonnage=Math.max(0,(c.tonnage||0)-u),g.reps=t,g.weight=r,g.type=d;const x=t*r;return l.totalTonnage=(l.totalTonnage||0)+x,c.tonnage=(c.tonnage||0)+x,!0}function M(n,s,o){const e=m(n),r=i.trainingLog[e]?.[s]?.exercises?.[o];return r?(r.completed=!0,!0):!1}function j(n,s){const o=m(n);return i.trainingLog[o]?.[s]?.tonnage||0}function $(n,s){const o=m(n),e=i.trainingLog[o]?.[s];if(!e)return 0;let t=0;for(const r of Object.values(e.exercises))for(const a of r.sets)t+=a.reps;return t}function k(n,s){const o=m(n),e=i.trainingLog[o]?.[s];if(!e)return 0;let t=0;for(const r of Object.values(e.exercises))t+=r.sets.length;return t}function C(n,s){if(!n||!s||n<1||s<=0)return 0;if(n===1)return s;const o=s*(36/(37-n)),e=s*(1+.0333*n),t=s*Math.pow(n,.1),r=o+e+t;return Math.round(r/3)}export{b as a,O as b,C as c,K as d,k as e,L as f,S as g,M as h,w as i,j,$ as k,D as l,v as m,A as n,E as r};
