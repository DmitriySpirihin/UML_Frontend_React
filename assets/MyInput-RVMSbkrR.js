import{cM as k,cN as j,C as p,j as l,A as I,cO as R,cP as A}from"./index-B7oT8-lJ.js";import{r as i}from"./recharts-k8ghPecL.js";const M=({keyType:x=0,maxL:y=500,placeHolder:g,theme:c,h:d="auto",w:f="100%",value:n="",onChange:u=null,clear:m=!1})=>{const[r,s]=i.useState({myString:"",cursorPos:0}),[t,S]=i.useState(!1),[C,h]=i.useState(!0),b=i.useRef(null);i.useEffect(()=>{s({myString:n,cursorPos:n.length})},[n]),i.useEffect(()=>{const a=k.subscribe(o=>{t&&(o==="bs"?s(e=>{if(e.cursorPos===0)return e;const P=Array.from(e.myString);return{myString:[...P.slice(0,e.cursorPos-1),...P.slice(e.cursorPos)].join(""),cursorPos:e.cursorPos-1}}):o==="bsall"?s({myString:"",cursorPos:0}):o.length===1&&s(e=>({myString:e.myString.slice(0,e.cursorPos)+o+e.myString.slice(e.cursorPos),cursorPos:e.cursorPos+1})))});return()=>a.unsubscribe()},[t]),i.useEffect(()=>{if(!t){h(!1);return}h(!0);const a=setInterval(()=>{h(o=>!o)},500);return()=>clearInterval(a)},[t]),i.useEffect(()=>{const a=j.subscribe(o=>{o.value===!1&&(S(!1),m&&s({myString:"",cursorPos:0}))});return()=>a.unsubscribe()},[]),i.useEffect(()=>{u&&t&&u(r.myString)},[r]);const E=c!=="light"?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)",w=p.get("iconsHighlited",c),N=a=>{if(R(""),S(!0),A({type:x,value:!0}),b.current){const o=F(a,b.current,r.myString);s(e=>({...e,cursorPos:o}))}};return l.jsx("div",{style:{width:f,minHeight:d==="90%"?"50px":d,height:"auto",boxSizing:"border-box",backgroundColor:E,borderRadius:"16px",padding:"12px 16px",border:`2px solid ${t?w:"transparent"}`,transition:"all 0.2s ease-in-out",display:"flex",alignItems:"center",justifyContent:"flex-start",cursor:"text"},onClick:N,children:l.jsx("div",{ref:b,style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflow:"hidden",fontSize:I.prefs[4]===0?"14px":"16px",display:"block",textAlign:"left",lineHeight:"1.4",fontFamily:"Segoe UI, Roboto, Helvetica, sans-serif",color:r.myString.length===0?p.get("icons",c):p.get("mainText",c),width:"100%",opacity:r.myString.length===0?.6:1,pointerEvents:"none"},children:r.myString.length>0||t?l.jsxs(l.Fragment,{children:[l.jsx("span",{children:r.myString.slice(0,r.cursorPos)}),l.jsx("span",{style:{display:"inline-block",width:"2px",height:"1.2em",backgroundColor:C&&t?p.get("iconsHighlited",c):"transparent",borderRadius:"1px",verticalAlign:"text-bottom",marginBottom:"-2px",marginLeft:"0px",marginRight:"0px",transition:"background-color 0.1s"}}),l.jsx("span",{children:r.myString.slice(r.cursorPos)})]}):g})})},F=(x,y,g)=>{let c=x.clientX,d=x.clientY,f,n,u;if(document.caretRangeFromPoint)f=document.caretRangeFromPoint(c,d),n=f.startContainer,u=f.startOffset;else if(document.caretPositionFromPoint){const s=document.caretPositionFromPoint(c,d);n=s.offsetNode,u=s.offset}else return g.length;let m=0;if(n===y)return g.length;const r=y.childNodes;for(let s=0;s<r.length;s++){const t=r[s];if(t===n||t.contains(n))return m+u;(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE)&&(m+=t.textContent.length)}return g.length};export{M};
