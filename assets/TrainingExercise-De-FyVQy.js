import{A as y,t as xe,l as ue,a3 as ge,f as fe,j as e,C as o,M as Q,bb as L,m as c,a as R,a6 as Z,o as he,af as be,a2 as me,bc as ye,ab as je,bd as Ce,be as Se}from"./index-CZoPKF6T.js";import{r as l}from"./recharts-C3psbGwv.js";import{c as ve,b as _}from"./index-0LOIQqgI.js";import{T as we}from"./index-BHDyt1gH.js";const Be=({needToAdd:r,setEx:O})=>{const[t,I]=l.useState("dark"),[i,ee]=l.useState(y.prefs[0]),[C,te]=l.useState(y.prefs[1]),[E,M]=l.useState(""),[S,oe]=l.useState(-1),[j,D]=l.useState(-1),[U,V]=l.useState(""),[v,Y]=l.useState(""),[ne,P]=l.useState(!1),[X,ie]=l.useState(!1),[w,W]=l.useState(!1),[z,F]=l.useState(""),[k,G]=l.useState(""),[f,B]=l.useState(!0),[h,$]=l.useState(new Array(14).fill(!1)),[N,q]=l.useState(0);l.useEffect(()=>{const n=xe.subscribe(I),a=ue.subscribe(p=>{ee(p==="ru"?0:1)});return()=>{a.unsubscribe(),n.unsubscribe()}},[]),l.useEffect(()=>{const n=ge.subscribe(M),a=fe.subscribe(te);return()=>{n.unsubscribe(),a.unsubscribe()}},[]);function re(n){m(null),oe(S===n?-1:n),S===-1&&D(-1)}function se(n){m(null),D(j===n?-1:n)}function H(){m(null),M(""),$(new Array(14).fill(!1)),F(""),G(""),B(!0)}function ae(){if(z.length<3){je(i===0?"Введите название (мин. 3 символа)":"Enter name (min 3 chars)",2e3,!1);return}const n=N,a=[];for(let d=0;d<h.length;d++)h[d]&&a.push(d);m(null);const p=A(z),x=k.length>3?A(k):"";Ce(n,a,[i===0?p:"Custom exercise",i===1?p:"Своё упражнение"],[i===0?x||"Своё упражнение":"Custom exercise",i===1?x||"Custom exercise":"Своё упражнение"],f),H()}function le(){const n=y.exercises[j];if(n){F(n.name[i]);const a=new Array(14).fill(!1);n.addMgIds.length>0&&n.addMgIds.forEach(p=>{a[p]=!0}),$(a),G(n.description[i]),q(n.mgId),B(n.isBase),W(!0)}}function de(){m(null);const n=[];for(let d=0;d<h.length;d++)h[d]&&n.push(d);const a=y.exercises[j],p=[...a.name];p[i]=A(z);const x=[...a.description];k.length>3?x[i]=A(k):x[i]=i===0?"Своё упражнение":"Custom exercise",ye(j,N,n,p,x,f),W(!1)}function ce(){m(null),Se(j),D(-1),P(!1),H()}l.useEffect(()=>{E==="AddExercisePanel"&&q(S!==-1?S:0)},[E]);const pe={collapsed:{height:0,opacity:0,overflow:"hidden"},expanded:{height:"auto",opacity:1,transition:{duration:.3,ease:"easeInOut"}}},J={hidden:{opacity:0,y:100,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",damping:25,stiffness:300}},exit:{opacity:0,y:100,scale:.95}};return e.jsxs("div",{style:s(t).container,children:[e.jsxs("div",{style:s(t).searchContainer,children:[e.jsx(ve,{style:{color:o.get("subText",t),fontSize:"20px",marginLeft:"10px"}}),e.jsx("input",{type:"text",placeholder:i===0?"Поиск упражнения...":"Search exercise...",value:v,onChange:n=>Y(n.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:o.get("mainText",t),outline:"none",marginLeft:"10px"}}),v&&e.jsx(Q,{onClick:()=>Y(""),style:{color:o.get("subText",t),fontSize:"18px",marginRight:"10px",cursor:"pointer"}})]}),e.jsx("div",{style:{width:"100%",maxWidth:"600px",paddingBottom:"80px",flex:1,overflowY:"auto"},children:Object.keys(L.muscleIconsSrc[0]).map(n=>{const a=Number(n),p=Object.entries(y.exercises).filter(([d,u])=>{const b=u.mgId===a,T=u.name[i].toLowerCase().includes(v.toLowerCase());return b&&u.show&&T}).sort(([d],[u])=>Number(d)-Number(u));if(v&&p.length===0)return null;const x=S===a;return e.jsxs(c.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{...s(t).card,backgroundColor:x?o.get("trainingGroupSelected",t):o.get("background",t),border:`1px solid ${x?o.get("currentDateBorder",t):"transparent"}`},children:[e.jsxs(c.div,{onClick:()=>re(d=>d===a?-1:a),style:s(t).groupHeader,whileTap:{scale:.98},children:[e.jsx("div",{style:{flex:1},children:L.get(a,i,t,!0,"100%")}),e.jsx(c.div,{animate:{rotate:x?180:0},children:e.jsx(_,{style:s(t).icon})})]}),e.jsx(R,{children:x&&e.jsx(c.div,{variants:pe,initial:"collapsed",animate:"expanded",exit:"collapsed",style:{borderTop:`1px solid ${o.get("border",t)}`},children:e.jsxs("div",{style:{padding:"10px 0"},children:[p.map(([d,u])=>{const b=Number(d),T=j===b,K=u.isBase;return e.jsxs(c.div,{layout:!0,style:{marginBottom:"8px"},children:[e.jsxs(c.div,{onClick:()=>se(g=>g===b?-1:b),style:{...s(t).exerciseRow,backgroundColor:T?t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)":"transparent"},whileTap:{backgroundColor:o.get("trainingGroup",t)},children:[e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("p",{style:{...s(t,!1,!1,C).text,textAlign:"left"},children:u.name[i]}),e.jsx("div",{style:{fontSize:"9px",fontWeight:"bold",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase",letterSpacing:"0.5px",marginLeft:"auto",color:K?o.get("difficulty5",t):o.get("difficulty2",t),opacity:.8},children:K?i===0?"База":"Base":i===0?"Изол":"Iso"})]}),r&&e.jsx(c.div,{whileTap:{scale:.8},onClick:g=>{g.stopPropagation(),O(b)},style:{padding:"8px"},children:e.jsx(Z,{style:{color:o.get("currentDateBorder",t),fontSize:"18px"}})}),e.jsx(c.div,{animate:{rotate:T?180:0},children:e.jsx(_,{style:{...s(t).icon,fontSize:"14px"}})})]}),e.jsx(R,{children:T&&e.jsxs(c.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{padding:"0 20px 10px 20px"},children:[e.jsx("p",{style:s(t,!1,!1,C).subtext,children:u.description[i]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",gap:"15px"},children:[e.jsx(R,{children:X&&e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0},style:{display:"flex",gap:"15px"},children:[e.jsx(he,{onClick:g=>{g.stopPropagation(),V(u.name[i]),le()},style:{color:o.get("subText",t),fontSize:"16px"}}),e.jsx(be,{onClick:g=>{g.stopPropagation(),V(u.name[i]),P(!0)},style:{color:"#ff4d4d",fontSize:"16px"}})]})}),e.jsx(we,{onClick:g=>{g.stopPropagation(),ie(!X)},style:{color:o.get("icons",t),fontSize:"20px"}})]})]})})]},b)}),!v&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsxs(c.button,{whileTap:{scale:.95},onClick:()=>{m(null),M("AddExercisePanel")},style:s(t).fab,children:[e.jsx(Z,{style:{fontSize:"14px",color:"#fff"}}),e.jsx("span",{style:{fontSize:"13px",fontWeight:"600"},children:i===0?"Создать":"Create"})]})})]})})})]},a)})}),e.jsxs(R,{children:[(E==="AddExercisePanel"||w)&&e.jsx("div",{style:s(t).modalBackdrop,children:e.jsxs(c.div,{variants:J,initial:"hidden",animate:"visible",exit:"exit",style:s(t).modalContainer,children:[e.jsx("div",{style:s(t).modalHeader,children:e.jsx("h3",{style:s(t,!1,!1,C).headerText,children:i===0?w?"Редактор":"Конструктор":w?"Editor":"Constructor"})}),e.jsxs("div",{style:{width:"100%",padding:"0 20px",display:"flex",flexDirection:"column",gap:"15px",overflowY:"auto"},children:[e.jsx("input",{type:"text",placeholder:i===0?"Название":"Name",value:z,onChange:n=>F(n.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:o.get("mainText",t),outline:`solid 1px ${o.get("scrollFont",t)}`,borderRadius:"16px",padding:"12px"}}),e.jsx("input",{type:"text",placeholder:i===0?"Описание":"Description",value:k,onChange:n=>G(n.target.value),style:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:o.get("mainText",t),outline:`solid 1px ${o.get("scrollFont",t)}`,borderRadius:"16px",padding:"12px"}}),e.jsxs("div",{style:s(t).segmentedControl,children:[e.jsx("div",{onClick:()=>B(!0),style:{...s(t).segment,backgroundColor:f?o.get("difficulty5",t):"transparent",color:f?o.get("trainingBaseFont",t):o.get("subText",t),boxShadow:f?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:i===0?"База":"Base"}),e.jsx("div",{onClick:()=>B(!1),style:{...s(t).segment,backgroundColor:f?"transparent":o.get("difficulty2",t),color:f?o.get("subText",t):o.get("trainingIsolatedFont",t),boxShadow:f?"none":"0 2px 5px rgba(0,0,0,0.1)"},children:i===0?"Изол.":"Iso"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{...s(t,!1,!1,C).label,marginBottom:"8px"},children:i===0?"Доп. мышцы":"Secondary Muscles"}),e.jsx("div",{style:s(t).chipGrid,children:L.names[i].map((n,a)=>N===a?null:e.jsx(c.div,{whileTap:{scale:.95},onClick:()=>$(p=>p.map((x,d)=>d===a?!x:x)),style:{...s(t).chip,backgroundColor:h[a]?o.get("difficulty",t):"transparent",color:h[a]?"#fff":o.get("subText",t),borderColor:h[a]?"transparent":o.get("border",t)},children:n},a))})]})]}),e.jsxs("div",{style:s(t).modalActions,children:[e.jsx(c.div,{whileTap:{scale:.9},onClick:()=>w?W(!1):H(),style:s(t).circleBtn,children:e.jsx(Q,{style:{fontSize:"24px",color:o.get("subText",t)}})}),e.jsx(c.div,{whileTap:{scale:.9},onClick:()=>w?de():ae(),style:{...s(t).circleBtn,backgroundColor:o.get("done",t)},children:e.jsx(me,{style:{fontSize:"24px",color:"#fff"}})})]})]})}),ne&&e.jsx("div",{style:s(t).modalBackdrop,children:e.jsxs(c.div,{variants:J,initial:"hidden",animate:"visible",exit:"exit",style:{...s(t).modalContainer,height:"auto",padding:"25px",maxHeight:"300px"},children:[e.jsx("p",{style:{...s(t,!1,!1,C).text,textAlign:"center",marginBottom:"25px"},children:i===0?`Удалить ${U}?`:`Delete ${U}?`}),e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsx(c.button,{whileTap:{scale:.95},onClick:()=>P(!1),style:s(t).secondaryBtn,children:i===0?"Нет":"Cancel"}),e.jsx(c.button,{whileTap:{scale:.95},onClick:()=>ce(),style:s(t).dangerBtn,children:i===0?"Удалить":"Delete"})]})]})})]})]})},s=(r,O,t,I)=>({container:{backgroundColor:o.get("background",r),display:"flex",flexDirection:"column",overflow:"hidden",alignItems:"center",height:"100vh",paddingTop:"120px",width:"100vw",fontFamily:"Segoe UI, Roboto, sans-serif",boxSizing:"border-box"},searchContainer:{width:"94%",maxWidth:"600px",marginTop:"25px",backgroundColor:r==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",display:"flex",alignItems:"center",padding:"8px 0",marginBottom:"10px"},searchInput:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:o.get("mainText",r),marginLeft:"8px",outline:"none"},card:{width:"94%",margin:"0 auto 12px auto",borderRadius:"16px",overflow:"hidden",boxShadow:r==="light"?"0 2px 8px rgba(0,0,0,0.05)":"none"},groupHeader:{display:"flex",flexDirection:"row",padding:"12px 10px",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},exerciseRow:{display:"flex",flexDirection:"row",width:"92%",padding:"12px 20px",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderRadius:"12px",margin:"0 10px"},icon:{fontSize:"20px",color:o.get("icons",r),marginRight:"10px"},text:{fontSize:I===0?"15px":"17px",color:o.get("mainText",r),fontWeight:"500",margin:0},subtext:{fontSize:I===0?"13px":"15px",color:o.get("subText",r),lineHeight:"1.4",margin:0},label:{fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",color:o.get("subText",r),letterSpacing:"0.5px"},headerText:{fontSize:"18px",fontWeight:"bold",color:o.get("mainText",r),margin:0},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},modalContainer:{width:"90%",maxWidth:"400px",height:"80vh",maxHeight:"750px",backgroundColor:o.get("background",r),borderRadius:"24px",boxShadow:"0 20px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",alignItems:"center",border:`1px solid ${o.get("border",r)}`,overflow:"hidden"},modalHeader:{width:"100%",padding:"20px",borderBottom:`1px solid ${o.get("border",r)}`,textAlign:"center",marginBottom:"15px"},modalActions:{marginTop:"auto",padding:"15px 20px",width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",borderTop:`1px solid ${o.get("border",r)}`,backgroundColor:r==="light"?"rgba(0,0,0,0.02)":"rgba(255,255,255,0.02)"},segmentedControl:{display:"flex",width:"98%",backgroundColor:r==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"4px",margin:"10px 0"},segment:{flex:1,textAlign:"center",padding:"8px",borderRadius:"10px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},horizontalScroll:{display:"flex",overflowX:"auto",gap:"8px",padding:"5px 0 15px 0",scrollbarWidth:"none",width:"100%"},scrollItem:{minWidth:"60px",borderRadius:"12px",border:"1px solid",padding:"5px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},chipGrid:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"5px",paddingBottom:"20px"},chip:{padding:"6px 12px",borderRadius:"20px",border:"1px solid",fontSize:"12px",cursor:"pointer",fontWeight:"500"},circleBtn:{width:"50px",height:"50px",borderRadius:"25px",backgroundColor:o.get("skipped",r),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},fab:{backgroundColor:o.get("difficulty",r),border:"none",borderRadius:"20px",padding:"8px 20px",display:"flex",alignItems:"center",gap:"8px",color:"#fff",cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,0.2)"},secondaryBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:r==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:o.get("mainText",r),fontSize:"16px",cursor:"pointer"},dangerBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:"#ff4d4d",color:"#fff",fontSize:"16px",cursor:"pointer"}});function m(r){y.prefs[2]==0,y.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}const A=r=>r&&r.charAt(0).toUpperCase()+r.slice(1);export{Be as default};
