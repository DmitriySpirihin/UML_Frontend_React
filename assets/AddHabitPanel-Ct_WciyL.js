import{r as o,t as J,l as X,f as he,A as f,G as A,H as Be,I as Ne,j as t,C as i,J as Oe,K as be,L as q,O as me,P as Ve,Q as K,S as Ye,T as Ue,V as We,W as Q,X as Z,Y as Ge,i as Je,k as Xe,a as te,Z as O}from"./index-D63SmaT_.js";import{I as _,a as qe}from"./HabitsMain-xSc-gTyf.js";import{M as N}from"./MyInput-DTob-EVy.js";import{S as Ke}from"./Slider-Bx3uBoeA.js";import"./index-WsyyDFjw.js";const b=new Audio("Audio/Click.wav"),C=()=>te.concat((f.CustomHabits||[]).filter(e=>!te.some(c=>c.id===e.id))),w=new Date,lt=()=>{const[e,c]=o.useState(J.value),[d,u]=o.useState(X.value),[l,j]=o.useState(he.value),[S,H]=o.useState(!1),[x,se]=o.useState(f.prefs[0]),[y,L]=o.useState(!1),[ne,we]=o.useState(""),[je,z]=o.useState(!1),[v,ie]=o.useState(""),[F,V]=o.useState(x===0?"Здоровье":"Health"),[oe,ae]=o.useState(""),[le,Ce]=o.useState("default"),[re,Se]=o.useState(-1),[I,R]=o.useState(w.getFullYear()),[D,$]=o.useState(w.getMonth()+1),[P,k]=o.useState(w.getDate()),[Y,ce]=o.useState([]),[de,U]=o.useState(""),[W,ve]=o.useState(!1),[E,Ie]=o.useState(66),[xe,ue]=o.useState(C()),[De,pe]=o.useState(null),[M,fe]=o.useState(!1),[Pe,ge]=o.useState(0),[ke,Te]=o.useState("default"),[B,T]=o.useState(!1),g=(n,r)=>{r===2?k(a=>{const p=new Date(I,D,0).getDate();let h=a;return n?a<p&&new Date(I,D-1,a+1).getTime()<=w.getTime()&&(h=a+1):a>1&&(h=a-1),h}):r===1?$(a=>{let p=a;n?a<12&&new Date(I,a,P).getTime()<=w.getTime()&&(p=a+1):a>1&&(p=a-1);const h=new Date(I,p,0).getDate();return P>h&&k(h),p}):r===0&&R(a=>{let p=a;n?a<w.getFullYear()&&new Date(a+1,D-1,P).getTime()<=w.getTime()&&(p=a+1):a>w.getFullYear()-1&&(p=a-1);const h=new Date(p,D,0).getDate();return P>h&&k(h),p})},Ae=A(()=>g(!1,0)),He=A(()=>g(!0,0)),ze=A(()=>g(!1,1)),Le=A(()=>g(!0,1)),Fe=A(()=>g(!1,2)),Re=A(()=>g(!0,2)),$e=()=>{de.length>0?(ce(n=>[...n,de]),U("")):O(x===0?"Введите цель":"Enter goal",2e3,!1)},Ee=n=>{ce(r=>r.filter((a,p)=>p!==n))},Me=[["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],["January","February","March","April","May","June","July","August","September","October","November","December"]];o.useEffect(()=>{const n=J.subscribe(c),r=X.subscribe(u),a=Be.subscribe(H),p=he.subscribe(j);return()=>{n.unsubscribe(),r.unsubscribe(),a.unsubscribe(),p.unsubscribe()}},[]),o.useEffect(()=>{const n=J.subscribe(c),r=X.subscribe(a=>{se(a==="ru"?0:1)});return()=>{n.unsubscribe(),r.unsubscribe()}},[]),o.useEffect(()=>{ue(C())},[]),o.useEffect(()=>{const n=Ne.subscribe(we);return ne==="AddHabitPanel"?setTimeout(()=>ge(1),400):ge(0),()=>{n.unsubscribe()}},[]);const G=(n,r)=>{n.length>0?r===0?ie(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===1?V(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===2?ae(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===3&&U(n[0].toUpperCase()+n.toLowerCase().slice(1)):r===0?ie(""):r===1?V(""):r===2?ae(""):r===3&&U("")};return o.useEffect(()=>{v.length>3&&F.length>3?T(!0):T(!1)},[v,F,oe,le,x]),t.jsxs("div",{style:{...s(e).container,transform:ne==="AddHabitPanel"?"translateX(0)":"translateX(-100%)",backgroundColor:Pe===1?"rgba(0, 0, 0, 0.5)":"transparent",transition:"transform 0.3s ease-in-out, background-color 0.1s ease-in-out"},children:[!y&&t.jsxs("div",{style:s(e,S).panel,children:[t.jsx("div",{style:s(e,!1,l).headerText,children:x===0?"добавь привычку":"add habit"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"90%"},children:[t.jsx(Oe,{style:{color:i.get("icons",e),fontSize:"16px",marginTop:"10px",marginLeft:"10px"}}),t.jsx(N,{maxL:10,w:"70%",placeHolder:x===0?"поиск":"search",theme:e,onChange:n=>_e(n,xe,ue)})]}),t.jsx("div",{style:s(e).scrollView,children:xe.map(n=>!f.choosenHabits.includes(n.id)&&t.jsx("li",{style:{...s(e).text,borderRadius:"24px",backgroundColor:n.id===De?i.get("highlitedPanel",e):"transparent"},onClick:()=>{pe(n.id),ve(C()[n.id].category[0]==="Отказ от вредного"),Se(n.id),T(!0),m(b)},children:t.jsx("p",{style:s(e,!1,l).text,children:n.name[x]})},n.id))})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{q(""),me(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{L(!0),T(!1)},children:t.jsx(Ve,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B&&(z(!0),m(b))},children:t.jsx(K,{style:{...s(e).miniIcon,color:B?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),y&&t.jsxs("div",{style:s(e,S).panel,children:[t.jsx("div",{style:s(e).headerText,children:x===0?"или создай свою":"or create your own"}),t.jsxs("div",{style:{...s(e).simplePanel,height:"52vh",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(N,{maxL:25,h:"15%",w:"90%",placeHolder:x===0?"имя":"name",theme:e,onChange:n=>G(n,0)}),t.jsx("select",{style:{...s(e,!1,l).input,width:"48%"},onChange:n=>V(n.target.value),children:Qe(e,x,l)}),t.jsx(N,{maxL:100,h:"20%",w:"90%",placeHolder:x===0?"описание(опционально)":"description(optional)",theme:e,onChange:n=>G(n,2)}),t.jsx("div",{style:s(e,!1,l).headerText,children:x===0?"выбери иконку(опционально)":"choose icon(optional)"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{width:"80%",marginLeft:"30px",padding:"5px"},children:t.jsxs("div",{style:s(e).button,onClick:()=>fe(!M),children:[!M&&t.jsx(Ye,{style:s(e).miniIcon}),M&&t.jsx(Ue,{style:s(e).miniIcon})]})}),t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"20%",height:"100%",padding:"8px"},children:_.getIcon(ke,{size:48,style:{marginRight:"70px",color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignContent:"center"},children:[t.jsx("div",{style:{...s(e).button},onClick:()=>{q(""),me(0),m(b)},children:t.jsx(be,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{L(!1),T(!1),pe(null)},children:t.jsx(We,{style:s(e).miniIcon})}),t.jsx("div",{style:{...s(e).button},onClick:()=>{B&&(z(!0),m(b))},children:t.jsx(K,{style:{...s(e).miniIcon,color:B?i.get("icons",e):i.get("iconsDisabled",e)}})})]})]}),M&&t.jsx("div",{style:s(e).selectPanel,children:Object.entries(_.ic).map(([n])=>t.jsx("div",{style:{width:"15%",padding:"12px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"8px",transition:"background-color 0.2s",":hover":{backgroundColor:i.get("highlitedPanel",e)}},onClick:()=>{Te(n),Ce(n),m(b),fe(!1),v.length>3&&F.length>3&&T(!0)},children:_.getIcon(n,{size:32,style:{color:i.get("habitIcon",e),filter:"drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5))"}})},n))}),je&&t.jsx("div",{style:s(e).container,children:t.jsxs("div",{style:s(e).confirmationPanel,children:[t.jsx("p",{style:s(e,!1,l).text,children:et(x,y,re,v)}),t.jsxs("div",{style:{...s(e).simplePanelRow,flexDirection:"column",justifyContent:"space-between",alignItems:"center",backgroundColor:i.get("background",e),width:"90%",height:"80%",borderRadius:"24px"},children:[t.jsx("p",{style:s(e,!1,l).subtext,children:x===0?"установите дату":"set date"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Ae,onClick:()=>{g(!1,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",I," "]}),t.jsx("div",{...He,onClick:()=>{g(!0,0)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...ze,onClick:()=>{g(!1,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",Me[x][D-1]," "]}),t.jsx("div",{...Le,onClick:()=>{g(!0,1)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%"},children:[t.jsx("div",{...Fe,onClick:()=>{g(!1,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Q,{style:{userSelect:"none",touchAction:"none"}})}),t.jsxs("p",{style:s(e).textDate,children:[" ",P," "]}),t.jsx("div",{...Re,onClick:()=>{g(!0,2)},style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},children:t.jsx(Z,{style:{userSelect:"none",touchAction:"none"}})})]}),t.jsx("p",{style:s(e,!1,l).subtext,children:x===0?"(опционально) дополнительные цели":"(optional) additional goals"}),t.jsxs("div",{style:{...s(e).simplePanelRow,width:"70%",flexDirection:"row",justifyContent:"space-around",alignItems:"center"},children:[t.jsx(N,{w:"80%",h:"70%",maxL:50,placeHolder:x===0?"новая цель":"new goal",onChange:n=>G(n,3),clear:!0}),t.jsx(K,{style:{...s(e).miniIcon,fontSize:"20px",marginTop:"15px"},onClick:$e})]}),t.jsx("div",{style:{marginTop:"10px",width:"60%",display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",overflowY:"auto",height:"90%"},children:Y.map((n,r)=>t.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%",height:"20%"},children:[t.jsx("div",{style:s(e,!1,l).text,children:r+1+": "+n}),t.jsx(Ge,{style:{...s(e).miniIcon,fontSize:"14px",marginBottom:"20px",marginLeft:"auto"},onClick:()=>Ee(r)})]},r))}),t.jsx(Ke,{style:s(e).slider,min:21,max:180,value:E,valueLabelDisplay:"auto",onChange:n=>Ie(n.target.value)}),t.jsx("div",{style:{...s(e,!1,l).subtext,marginTop:"5px",width:"90%"},children:tt(x,E,W)})]}),t.jsxs("div",{style:s(e).simplePanelRow,children:[t.jsx("div",{style:s(e).button,onClick:()=>{z(!1),ee(k,$,R),m(b)},children:t.jsx(Je,{style:s(e).miniIcon})}),t.jsx("div",{style:s(e).button,onClick:()=>{const n=`${I}-${D.toString().padStart(2,"0")}-${P.toString().padStart(2,"0")}`,r=Y.length>0?Y.map(a=>({text:a,isDone:!1})):[];y?Ze(v,F,oe,le,n,r,W,E):ye(re,v,!1,n,r,W,E),m(b),z(!1),q(""),ee(k,$,R),m(b),z(!1),ee(k,$,R)},children:t.jsx(Xe,{style:s(e).miniIcon})})]})]})})]})},Qe=(e,c,d)=>Array.from(new Set(te.map(l=>l.category[c]))).map(l=>t.jsx("option",{value:l,style:{...s(e,!1,d).text},children:l},l)),ye=(e,c,d,u,l,j,S)=>{if(f.IsHabitInChoosenList(e)){O(f.prefs[0]===0?"привычка уже в списке":"habit already in list",2500,!1);return}qe(e,u,l,j,S);const H=d?f.prefs[0]===0?`привычка: ${c} создана и добавлена`:`habit: ${c} was created and added`:f.prefs[0]===0?"привычка добавлена":"habit added";O(H,2500,!0)},Ze=(e,c,d,u,l,j,S,H)=>{const x=C(),y=(x.length>0?Math.max(...x.map(L=>L.id)):0)+1;f.IsCustomHabitExists(y)?O(f.prefs[0]===0?"привычка с таким названием уже существует":"habit with this name already exists",2500,!1):(f.AddCustomHabit(e,c,d,u,y),setTimeout(()=>{ye(y,e,!0,l,j,S,H)},100))},_e=(e,c,d)=>{if(e.length>0){const u=C().filter(l=>l.name[f.prefs[0]].toLowerCase().startsWith(e.toLowerCase()));d(u)}else{const u=C();c.length!=u.length&&d(u)}},s=(e,c,d)=>({container:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2900,padding:"20px"},panel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",overflow:"hidden",boxSizing:"border-box",overflowY:"scroll",border:`1px solid ${i.get("border",e)}`,margin:"5px",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:c?"85vh":"65vh"},confirmationPanel:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,margin:"5px",marginBottom:"15vw",backgroundColor:i.get("simplePanel",e),boxShadow:`4px 4px 6px ${i.get("shadow",e)}`,width:"85vw",height:"170vw"},text:{textAlign:"center",fontSize:d?"13px":"15px",color:i.get("mainText",e),marginBottom:"12px"},subtext:{textAlign:"center",fontSize:d?"11px":"13px",color:i.get("subText",e),marginBottom:"12px"},textDate:{textAlign:"center",fontSize:"18px",color:i.get("mainText",e),marginBottom:"4px"},headerText:{textAlign:"center",margin:"5px",padding:"5px",fontSize:d?"13px":"15px",color:i.get("subText",e)},scrollView:{overflowY:"auto",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"},simplePanel:{marginLeft:"7.5vw",width:"70vw",height:"30vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch",background:"rgba(0, 0, 0, 0.1)",borderRadius:"24px"},input:{backgroundColor:i.get("simplePanel",e),width:"65vw",height:"3vh",borderBottom:`1px solid ${i.get("border",e)}`,borderRadius:"12px",margin:"12px",fontSize:d?"13px":"15px",fontFamily:"Segoe UI",color:i.get("subText",e)},simplePanelRow:{width:"75vw",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-around",userSelect:"none",touchAction:"none"},select:{width:"20vw",height:"6vw",borderRadius:"12px",border:`1px solid ${i.get("border",e)}`,marginTop:"12px",fontSize:d?"13px":"15px",color:i.get("subText",e),backgroundColor:i.get("habitCard",e)},selectOption:{color:i.get("subText",e),backgroundColor:i.get("habitCard",e),fontSize:d?"11px":"13px"},selectPanel:{backgroundColor:i.get("habitCard",e),borderRadius:"24px",border:`1px solid ${i.get("border",e)}`,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexWrap:"wrap",width:"77vw",maxHeight:"42vh",overflowY:"auto",padding:"16px",gap:"8px",justifyContent:"center",zIndex:1e3},selectIcon:{flex:"{0,0,33.33%}",width:"20vw",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignContent:"center",justifyContent:"center",width:"15vw",marginTop:"12px",fontSize:"12px"},miniIcon:{fontSize:"28px",padding:"5px",marginTop:"10px",color:i.get("icons",e),userSelect:"none",touchAction:"none",filter:`drop-shadow(0 0px 1px ${i.get("iconsShadow",e)})`},slider:{width:"70%",userSelect:"none",touchAction:"none",color:i.get("icons",e)}});function m(e){f.prefs[2]==0&&e!==null&&(e.paused||(e.pause(),e.currentTime=0),e.volume=.5,e.play()),f.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}function et(e,c,d,u){if(c)return e===0?"добавить привычку "+u+"?":"add habit "+u+"?";{const l=C().find(j=>j.id===d).name[e];return e===0?"добавить привычку "+l+"?":"add habit "+l+"?"}}function tt(e,c,d){return d?e===0?"мне нужно "+c+" дней чтобы бросить привычку":"i need "+c+" days to quit":e===0?"мне нужно "+c+" дней для формирования привычки":"it takes "+c+" days to form a habit"}function ee(e,c,d){const u=new Date;e(u.getDate()),c(u.getMonth()+1),d(u.getFullYear())}export{lt as default};
