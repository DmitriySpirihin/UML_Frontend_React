import{A as u,t as te,l as ne,f as re,j as t,C as d,m as w,ae as P,d as O}from"./index-CpVNdywG.js";import{r as c}from"./recharts-k8ghPecL.js";import{b as ie}from"./index-BXgnci7f.js";const se=(e,o)=>{const n=new Date(e),b={weekday:"long"},g=o===0?"ru-RU":"en-US";return n.toLocaleDateString(g,b)},A=e=>{const o=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3);return`${o}:${n.toString().padStart(2,"0")}`},ae=(e,o)=>{const n=e.duration/1e3,b=e.distance||0;let g="",N="";if(e.type==="RUNNING"||e.type==="SWIMMING"){if(b>0&&n>0){if(e.type==="RUNNING"){const m=n/b,T=Math.floor(m/60),p=Math.floor(m%60);g=o===0?`${T}:${p.toString().padStart(2,"0")} /ÐºÐ¼`:`${T}:${p.toString().padStart(2,"0")} min/km`}else if(e.type==="SWIMMING"){const m=n/b*100,T=Math.floor(m/60),p=Math.floor(m%60);g=o===0?`${T}:${p.toString().padStart(2,"0")} /100Ð¼`:`${T}:${p.toString().padStart(2,"0")} min/100m`}}}else if(e.type==="CYCLING"&&b>0&&n>0){const m=b*3600/n;N=o===0?`${m.toFixed(1)} ÐºÐ¼/Ñ‡`:`${m.toFixed(1)} km/h`}return{paceDisplay:g,speedDisplay:N}},H=(e,o,n)=>o?e==="SWIMMING"?n===0?`${Math.round(o)} Ð¼`:`${Math.round(o)} m`:n===0?`${o.toFixed(1)} ÐºÐ¼`:`${o.toFixed(1)} km`:"",oe=(e,o)=>{const n={GYM:o===0?"Ð¡Ð¸Ð»Ð¾Ð²Ð°Ñ":"Gym",RUNNING:o===0?"Ð‘ÐµÐ³":"Running",CYCLING:o===0?"Ð’ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´":"Cycling",SWIMMING:o===0?"ÐŸÐ»Ð°Ð²Ð°Ð½Ð¸Ðµ":"Swimming",OTHER:o===0?"Ð¢Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ°":"Training"};return n[e]||n.OTHER},U={RUNNING:"#ff416c",CYCLING:"#38ef7d",SWIMMING:"#00c6ff",OTHER:"#a8a8a8"},k=["#00c6ff","#0072ff","#ff416c","#ff4b2b","#38ef7d","#11998e","#f09819","#edde5d","#834d9b","#d04ed6","#1d976c","#93f9b9","#5d29c3","#a968f2","#ff7e5f","#feb47b","#2af598","#009efd","#ff6b6b","#ffa500","#114357","#f29492","#43e97b","#38f9d7","#92fe9d","#00c9ff","#2c3e50","#3498db","#c33764","#1d2671","#ff9a9e","#fecfef","#a8ff78","#78ffd6","#b993d6","#8ca6db","#ff758c","#ff7eb3","#4facfe","#00f2fe"],xe=()=>{const[e,o]=c.useState("dark"),[n,b]=c.useState(u.prefs[0]==="ru"?0:1),[g,N]=c.useState(u.prefs[1]),[m,T]=c.useState(null),[p,L]=c.useState(0),[j,D]=c.useState(0),[W,B]=c.useState(0),[v,K]=c.useState("all");c.useEffect(()=>{const s=te.subscribe(o),l=ne.subscribe(a=>b(a==="ru"?0:1));return()=>{l.unsubscribe(),s.unsubscribe()}},[]),c.useEffect(()=>{const s=re.subscribe(N);return()=>s.unsubscribe()},[]),c.useEffect(()=>{v!=="all"&&v!=="GYM"&&L(0)},[v]);const{allTrainings:Y,sessionColorMap:V}=c.useMemo(()=>{const s=[],l=new Map;let a=0;for(const[r,x]of Object.entries(u.trainingLog||{}))x.forEach((S,M)=>{const R=S.type||(S.programId!==void 0||S.exercises?"GYM":"OTHER");s.push({date:r,idx:M,session:{...S,type:R}})});return s.sort((r,x)=>(x.session.startTime||0)-(r.session.startTime||0)),s.forEach(({session:r})=>{if(r.type==="GYM"){const x=`${r.programId||0}-${r.dayIndex||0}`;l.has(x)||(l.set(x,k[a%k.length]),a++)}}),{allTrainings:s.filter(r=>{const x=r.session;if(v!=="all"&&x.type!==v)return!1;if(x.type==="GYM"){if(p===1)return x.programId===j;if(p===2)return x.programId===j&&x.dayIndex===W}return!0}),sessionColorMap:l}},[u.trainingLog,p,j,W,v]),G=c.useMemo(()=>{const s=new Set;return Object.values(u.trainingLog||{}).forEach(l=>l.forEach(a=>{(a.type||"GYM")==="GYM"&&a.programId!==void 0&&s.add(a.programId)})),Array.from(s).map(l=>{const a=u.programs[l];return{id:l,name:a?.name?.[n]||`Program ${l}`}}).sort((l,a)=>l.name.localeCompare(a.name))},[n]),I=c.useMemo(()=>{if(p!==2||j==null)return[];const l=u.programs[j]?.schedule||[];return l.map((a,y)=>({index:y,name:l[y]?.name?.[n]||`Day ${y+1}`}))},[p,j,n]);c.useEffect(()=>{(p===1||p===2)&&G.length>0&&j===0&&D(G[0].id),p===2&&I.length>0&&B(I[0].index)},[p,G,I,j]);const _=n===0?"Ð’ÑÐµ":"All",q=n===0?"ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°":"Program",J=n===0?"Ð”ÐµÐ½ÑŒ":"Day";c.useMemo(()=>({all:n===0?"Ð’ÑÐµ Ñ‚Ð¸Ð¿Ñ‹":"All Types",GYM:n===0?"Ð¡Ð¸Ð»Ð¾Ð²Ñ‹Ðµ":"Gym",RUNNING:n===0?"Ð‘ÐµÐ³":"Running",CYCLING:n===0?"Ð’ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´":"Cycling",SWIMMING:n===0?"ÐŸÐ»Ð°Ð²Ð°Ð½Ð¸Ðµ":"Swimming",OTHER:n===0?"Ð”Ñ€ÑƒÐ³Ð¾Ðµ":"Other"}),[n]);const Q=c.useMemo(()=>{const s=new Set(["all"]),l={GYM:n===0?"Ð¡Ð¸Ð»Ð¾Ð²Ñ‹Ðµ":"Gym",RUNNING:n===0?"Ð‘ÐµÐ³":"Running",CYCLING:n===0?"Ð’ÐµÐ»Ð¾":"Cycling",SWIMMING:n===0?"ÐŸÐ»Ð°Ð²Ð°Ð½Ð¸Ðµ":"Swimming",OTHER:n===0?"Ð”Ñ€ÑƒÐ³Ð¾Ðµ":"Other"};return Object.values(u.trainingLog||{}).forEach(a=>{a.forEach(y=>{const r=y.type||(y.programId!==void 0?"GYM":"OTHER");s.add(r)})}),Array.from(s).map(a=>({value:a,label:l[a]||a})).sort((a,y)=>a.value==="all"?-1:y.value==="all"?1:a.label.localeCompare(y.label))},[u.trainingLog,n]);return t.jsxs("div",{style:i(e).container,children:[t.jsx("div",{style:{...i(e).typeFilterContainer,marginTop:"25px"},children:t.jsx("div",{style:i(e).typeToggleWrapper,children:Q.map(({value:s,label:l})=>{const a=v===s;return t.jsx(w.div,{onClick:()=>K(s),whileTap:{scale:.95},style:{...i(e).typeTogglePill,backgroundColor:a?d.get("currentDateBorder",e):"transparent",color:a?"#fff":d.get("subText",e),fontSize:g===0?"13px":"14px"},children:l},s)})})}),(v==="all"||v==="GYM")&&t.jsxs("div",{style:i(e).filterContainer,children:[t.jsx("div",{style:i(e).toggleWrapper,children:[{key:0,label:_},{key:1,label:q},{key:2,label:J}].map(({key:s,label:l})=>{const a=p===s;return t.jsx(w.div,{onClick:()=>L(s),whileTap:{scale:.95},style:{...i(e).togglePill,backgroundColor:a?d.get("currentDateBorder",e):"transparent",color:a?"#fff":d.get("subText",e),fontSize:g===0?"13px":"14px"},children:l},s)})}),t.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},children:[(p===1||p===2)&&t.jsxs("div",{style:i(e).selectWrapper,children:[t.jsx("select",{value:j,onChange:s=>{const l=Number(s.target.value);D(l),p===2&&I.length>0&&B(I[0]?.index||0)},style:i(e).select,children:G.map(s=>t.jsx("option",{value:s.id,children:s.name},s.id))}),t.jsx(P,{style:i(e).selectIcon})]}),p===2&&t.jsxs("div",{style:i(e).selectWrapper,children:[t.jsx("select",{value:W,onChange:s=>B(Number(s.target.value)),style:i(e).select,children:I.map(s=>t.jsx("option",{value:s.index,children:s.name},s.index))}),t.jsx(P,{style:i(e).selectIcon})]})]})]}),t.jsx("div",{style:{width:"100%",maxWidth:"800px",paddingBottom:"50px"},children:Y.length>0?t.jsx(O,{children:Y.map((s,l)=>{const{date:a,idx:y,session:r}=s,x=`${a}-${y}`,S=m===x;let M;if(r.type==="GYM"){const f=`${r.programId||0}-${r.dayIndex||0}`;M=V.get(f)||k[0]}else M=U[r.type]||U.OTHER;let R="",$="";if(r.type==="GYM"){const f=u.programs[r.programId||0],h=f?.name?.[n]||`Program ${r.programId||0}`,E=f?.schedule?.[r.dayIndex||0]?.name?.[n]||`Day ${r.dayIndex+1}`;R=h,$=E}else R=oe(r.type,n),$=H(r.type,r.distance,n);return t.jsxs(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05,duration:.3},style:{...i(e).card,borderLeft:`5px solid ${M}`},children:[t.jsxs("div",{onClick:()=>T(S?null:x),style:{...i(e).cardHeader,cursor:"pointer"},children:[t.jsxs("div",{style:{flex:1,padding:"12px 0 12px 16px"},children:[t.jsxs("div",{style:{...i(e,g).dateText},children:[a," â€¢ ",t.jsx("span",{style:{opacity:.8},children:se(a,n)})]}),t.jsxs("div",{style:i(e,g).programText,children:[R," ",$&&t.jsxs("span",{children:["â€¢ ",$]})]})]}),t.jsx("div",{style:{padding:"0 16px",display:"flex",alignItems:"center"},children:t.jsx(w.div,{animate:{rotate:S?180:0},children:t.jsx(ie,{size:18,color:d.get("subText",e)})})})]}),t.jsx(O,{children:S&&t.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:t.jsx("div",{style:i(e).expandedContent,children:r.type==="GYM"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:i(e).statsRow,children:[t.jsxs("div",{style:i(e).statBadge,children:["â± ",A(r.duration||0)]}),t.jsxs("div",{style:i(e).statBadge,children:["ðŸ‹ï¸ ",(r.tonnage/1e3).toFixed(2)," ",n===0?"Ñ‚":"t"]}),r.RPE&&t.jsxs("div",{style:i(e).statBadge,children:["RPE ",r.RPE]})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Object.entries(r.exercises||{}).filter(([f,h])=>h?.sets?.length>0).map(([f,h])=>{const E=parseInt(f,10),X=u.exercises[E]?.name?.[n]||`Exercise ${f}`;return t.jsxs("div",{style:i(e).exerciseBlock,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"6px"},children:[t.jsx("span",{style:i(e,g).exerciseTitle,children:X}),t.jsxs("span",{style:i(e).tonnageSub,children:[(h.totalTonnage/1e3).toFixed(2)," ",n===0?"Ñ‚":"t"]})]}),t.jsx("div",{style:i(e).setsGrid,children:h.sets.map((C,z)=>{const F=C.type===0,Z=F?d.get("trainingIsolatedFont",e):d.get("trainingBaseFont",e),ee=F?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.0)";return t.jsxs("div",{style:{...i(e).setRow,backgroundColor:ee,color:Z,fontSize:g===0?"13px":"15px"},children:[t.jsx("span",{style:{opacity:.6,fontSize:"11px",marginRight:"6px"},children:z+1}),t.jsx("span",{style:{fontWeight:"600"},children:C.weight}),t.jsx("span",{style:{fontSize:"11px",margin:"0 2px"},children:n===0?"ÐºÐ³":"kg"}),t.jsx("span",{style:{margin:"0 4px",opacity:.5},children:"Ã—"}),t.jsx("span",{style:{fontWeight:"600"},children:C.reps}),C.time!=null&&C.time>0&&t.jsxs("span",{style:{marginLeft:"6px",fontSize:"11px",opacity:.8},children:["(",Math.round(C.time/1e3),"s)"]})]},z)})})]},f)})}),r.note&&t.jsxs("div",{style:i(e).noteBlock,children:[t.jsx("div",{style:i(e).noteLabel,children:n===0?"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°:":"Note:"}),t.jsx("div",{style:i(e).noteText,children:r.note})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:i(e).statsRow,children:[t.jsxs("div",{style:i(e).statBadge,children:["â± ",A(r.duration||0)]}),r.distance&&t.jsxs("div",{style:i(e).statBadge,children:["ðŸ“ ",H(r.type,r.distance,n)]}),r.elevationGain>0&&t.jsxs("div",{style:i(e).statBadge,children:["â›°ï¸ ",r.elevationGain," ",n===0?"Ð¼":"m"]}),r.avgHeartRate>0&&t.jsxs("div",{style:i(e).statBadge,children:["â¤ï¸ ",r.avgHeartRate," bpm"]})]}),(()=>{const{paceDisplay:f,speedDisplay:h}=ae(r,n);return f||h?t.jsxs("div",{style:i(e).statRow,children:[f&&t.jsxs("div",{children:[t.jsx("div",{style:i(e).statLabel,children:n===0?"Ð¢ÐµÐ¼Ð¿:":"Pace:"}),t.jsx("div",{style:i(e).statValue,children:f})]}),h&&t.jsxs("div",{children:[t.jsx("div",{style:i(e).statLabel,children:n===0?"Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ:":"Speed:"}),t.jsx("div",{style:i(e).statValue,children:h})]})]}):null})(),(r.avgCadence>0||r.RPE)&&t.jsxs("div",{style:i(e).statsRow,children:[r.avgCadence>0&&t.jsxs("div",{style:i(e).statBadge,children:["ðŸš´ ",r.avgCadence," ",n===0?"Ð¾Ð±/Ð¼Ð¸Ð½":"rpm"]}),r.RPE&&t.jsxs("div",{style:i(e).statBadge,children:["RPE ",r.RPE]})]}),r.note&&t.jsxs("div",{style:i(e).noteBlock,children:[t.jsx("div",{style:i(e).noteLabel,children:n===0?"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°:":"Note:"}),t.jsx("div",{style:i(e).noteText,children:r.note})]})]})})})})]},x)})}):t.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},style:{padding:"40px 20px",color:d.get("subText",e),fontSize:g===0?"14px":"16px",textAlign:"center",fontStyle:"italic"},children:n===0?"Ð¢Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹":"No trainings found"})}),t.jsx("div",{style:{marginBottom:"150px"}})]})},i=(e,o)=>({container:{backgroundColor:d.get("background",e),display:"flex",flexDirection:"column",alignItems:"center",height:"89vh",marginTop:"120px",width:"100vw",fontFamily:"Segoe UI, Roboto, sans-serif",overflowY:"auto",boxSizing:"border-box",padding:"0 10px"},typeFilterContainer:{width:"100%",maxWidth:"600px",display:"flex",justifyContent:"center",marginBottom:"15px",padding:"0 10px"},typeToggleWrapper:{display:"flex",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",padding:"4px",borderRadius:"25px",width:"100%",maxWidth:"500px",justifyContent:"space-between",flexWrap:"wrap",gap:"4px"},typeTogglePill:{flex:"1 1 auto",textAlign:"center",padding:"5px 4px",borderRadius:"20px",cursor:"pointer",fontWeight:"500",minWidth:"80px",transition:"all 0.2s ease",whiteSpace:"nowrap"},filterContainer:{width:"100%",maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",marginBottom:"20px",padding:"0 10px"},toggleWrapper:{display:"flex",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",padding:"4px",borderRadius:"25px",width:"100%",justifyContent:"space-between"},togglePill:{flex:1,textAlign:"center",padding:"5px 0",borderRadius:"20px",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},selectWrapper:{position:"relative",width:"100%"},select:{width:"100%",padding:"12px 16px",borderRadius:"12px",border:"none",backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",color:d.get("mainText",e),fontSize:o===0?"14px":"16px",appearance:"none",outline:"none",cursor:"pointer"},selectIcon:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",color:d.get("subText",e),fontSize:"12px",pointerEvents:"none"},card:{width:"100%",backgroundColor:e==="light"?"#fff":"rgba(255,255,255,0.03)",borderRadius:"16px",marginBottom:"12px",boxShadow:e==="light"?"0 2px 10px rgba(0,0,0,0.05)":"none",border:`1px solid ${e==="light"?"rgba(192, 192, 192, 0.05)":"rgba(255,255,255,0.05)"}`,overflow:"hidden"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"center"},dateText:{fontSize:o===0?"16px":"18px",fontWeight:"bold",color:d.get("mainText",e),marginBottom:"4px"},programText:{fontSize:o===0?"13px":"14px",color:d.get("subText",e),fontWeight:"500"},expandedContent:{padding:"0 16px 16px 16px",borderTop:`1px solid ${d.get("border",e)}`,marginTop:"0px",paddingTop:"12px",backgroundColor:e==="light"?"rgba(0,0,0,0.01)":"rgba(0,0,0,0.1)"},statsRow:{display:"flex",flexWrap:"wrap",gap:"8px 12px",marginBottom:"16px"},statRow:{display:"flex",gap:"20px",marginBottom:"12px",padding:"8px 0"},statLabel:{fontSize:"12px",color:d.get("subText",e),marginBottom:"4px"},statValue:{fontSize:o===0?"16px":"18px",fontWeight:"bold",color:d.get("mainText",e)},statBadge:{backgroundColor:e==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",padding:"4px 10px",borderRadius:"8px",fontSize:"12px",color:d.get("mainText",e),fontWeight:"600",whiteSpace:"nowrap"},exerciseBlock:{marginBottom:"8px",paddingBottom:"8px",borderBottom:`1px dashed ${d.get("border",e)}`},exerciseTitle:{color:d.get("mainText",e),fontWeight:"600",fontSize:o===0?"14px":"16px"},tonnageSub:{fontSize:"11px",color:d.get("subText",e),fontWeight:"bold"},setsGrid:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},setRow:{display:"flex",alignItems:"center",padding:"4px 8px",borderRadius:"6px",backgroundColor:e==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.03)"},noteBlock:{marginTop:"12px",padding:"12px",backgroundColor:e==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"10px",borderLeft:`3px solid ${d.get("subText",e)}`},noteLabel:{fontSize:"12px",color:d.get("subText",e),marginBottom:"4px",fontWeight:"500"},noteText:{fontSize:o===0?"13px":"14px",color:d.get("mainText",e),lineHeight:1.4}});export{xe as default};
