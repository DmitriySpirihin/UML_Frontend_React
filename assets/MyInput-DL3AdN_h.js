import{cM as I,cN as j,C as p,j as d,A,cO as H,cP as L}from"./index-BfNwpdtF.js";import{r as c}from"./recharts-k8ghPecL.js";const v=({keyType:m=0,maxL:P=500,placeHolder:C,theme:a,h:y="auto",w:b="100%",value:u="",onChange:S=null,clear:x=!1})=>{const[t,o]=c.useState({myString:"",cursorPos:0}),[e,h]=c.useState(!1),[f,l]=c.useState(!0);c.useEffect(()=>{o({myString:u,cursorPos:u.length})},[u]),c.useEffect(()=>{const i=I.subscribe(s=>{e&&(s==="bs"?o(r=>{const k=Array.from(r.myString);return r.cursorPos===0?r:{myString:[...k.slice(0,r.cursorPos-1),...k.slice(r.cursorPos)].join(""),cursorPos:r.cursorPos-1}}):s==="bsall"?o({myString:"",cursorPos:0}):s.length===1&&o(r=>({myString:r.myString.slice(0,r.cursorPos)+s+r.myString.slice(r.cursorPos),cursorPos:r.cursorPos+1})))});return()=>i.unsubscribe()},[e]),c.useEffect(()=>{if(!e){l(!1);return}l(!0);const i=setInterval(()=>{l(s=>!s)},500);return()=>clearInterval(i)},[e]),c.useEffect(()=>{const i=j.subscribe(s=>{s.value===!1&&(h(!1),x&&o({myString:"",cursorPos:0}))});return()=>i.unsubscribe()},[]),c.useEffect(()=>{S&&e&&S(t.myString)},[t]);const n=a!=="light"?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)",g=p.get("iconsHighlited",a);return d.jsx("div",{style:{width:b,minHeight:y==="90%"?"50px":y,height:"auto",boxSizing:"border-box",backgroundColor:n,borderRadius:"16px",padding:"12px 16px",border:`2px solid ${e?g:"transparent"}`,transition:"all 0.2s ease-in-out",display:"flex",alignItems:"center",justifyContent:"flex-start",cursor:"text"},onClick:i=>{H(""),h(!0),L({type:m,value:!0}),typeof w=="function"&&o(s=>({myString:s.myString,cursorPos:w(i,s.myString)}))},children:d.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflow:"hidden",fontSize:A.prefs[4]===0?"14px":"16px",display:"block",textAlign:"left",lineHeight:"1.4",fontFamily:"Segoe UI, Roboto, Helvetica, sans-serif",color:t.myString.length===0?p.get("icons",a):p.get("mainText",a),width:"100%",opacity:t.myString.length===0?.6:1},children:t.myString.length>0||e?d.jsxs(d.Fragment,{children:[t.myString.slice(0,t.cursorPos),d.jsx("span",{style:{display:"inline-block",width:"2px",height:"1.2em",backgroundColor:f&&e?p.get("iconsHighlited",a):"transparent",borderRadius:"1px",verticalAlign:"text-bottom",marginBottom:"-2px",marginLeft:"1px",marginRight:"1px",transition:"background-color 0.1s"}}),t.myString.slice(t.cursorPos)]}):C})})},w=(m,P)=>{const a=A.prefs[4]===0?13:15,y=18,b=m.nativeEvent.offsetX-8,u=m.nativeEvent.offsetY,x=document.createElement("canvas").getContext("2d");x.font=`${a}px 'Segoe UI', 'Apple Color Emoji', 'Noto Color Emoji', 'Arial'`;const t=P.split(`
`),o=Math.floor(u/y),e=Math.min(o,t.length-1),h=t[e],f=Array.from(h);let l=0;for(let n=0;n<f.length;n++){const g=x.measureText(f[n]).width;if(l+=g,b<l)return t.slice(0,e).reduce((s,r)=>s+Array.from(r).length+1,0)+n}return t.slice(0,e).reduce((n,g)=>n+Array.from(g).length+1,0)+f.length};export{v as M};
