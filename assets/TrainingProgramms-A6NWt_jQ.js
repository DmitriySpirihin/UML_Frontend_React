import{af as Ie,ag as De,aH as ne,j as e,A as D,t as Re,l as ze,X as Ae,f as Be,C as r,m as p,aI as Pe,a as V,aJ as Ee,o as Fe,a7 as q,aK as Me,_ as ae,M as le,aL as $e,aM as We,aN as Le,W as Ne,aO as Ge,aP as He,aQ as Oe,aR as Ue,aS as Xe,aT as Ve}from"./index-25B83RUT.js";import{r as i}from"./recharts-Bg6K2Pzo.js";import{b as J,c as de}from"./index-zpHLv1r3.js";import{M as H}from"./MyInput-BWgoWLxb.js";import qe from"./TrainingExercise-DZN141cY.js";import"./index-KFy_fDoX.js";const Je=i.createContext(null);function Ke(){const s=i.useRef(!1);return Ie(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function Qe(){const s=Ke(),[c,n]=i.useState(0),t=i.useCallback(()=>{s.current&&n(c+1)},[c]);return[i.useCallback(()=>De.postRender(t),[t]),c]}const Ye=s=>!s.isLayoutDirty&&s.willUpdate(!1);function ie(){const s=new Set,c=new WeakMap,n=()=>s.forEach(Ye);return{add:t=>{s.add(t),c.set(t,t.addEventListener("willUpdate",n))},remove:t=>{s.delete(t);const l=c.get(t);l&&(l(),c.delete(t)),n()},dirty:n}}const ce=s=>s===!0,_e=s=>ce(s===!0)||s==="id",Ze=({children:s,id:c,inherit:n=!0})=>{const t=i.useContext(ne),l=i.useContext(Je),[a,j]=Qe(),y=i.useRef(null),C=t.id||l;y.current===null&&(_e(n)&&C&&(c=c?C+"-"+c:C),y.current={id:c,group:ce(n)&&t.group||ie()});const w=i.useMemo(()=>({...y.current,forceRender:a}),[j]);return e.jsx(ne.Provider,{value:w,children:s})},lt=()=>{const[s,c]=i.useState(D.programs),n=()=>{c({...D.programs})},[t,l]=i.useState("dark"),[a,j]=i.useState(D.prefs[0]),[y,C]=i.useState(D.prefs[1]),[w,f]=i.useState(!1),[v,S]=i.useState(!1),[u,K]=i.useState(-1),[b,R]=i.useState(-1),[W,z]=i.useState(""),[L,A]=i.useState(""),[Q,xe]=i.useState(3),[k,pe]=i.useState(4),[B,Y]=i.useState(6),[h,_]=i.useState(0),[Z,ee]=i.useState(0),[tt,te]=i.useState(1),[se,re]=i.useState(a===0?"День 1":"Day 1"),[ue,P]=i.useState(!1),[ge,N]=i.useState(!1),[fe,E]=i.useState(!1),[ye,F]=i.useState(!1),[be,he]=i.useState(""),[me,oe]=i.useState(0);i.useEffect(()=>{k>B-2&&Y(k+2)},[k,B]),i.useEffect(()=>{const o=Re.subscribe(l),x=ze.subscribe(T=>j(T==="ru"?0:1)),g=Ae.subscribe(T=>f(T==="AddProgrammPanel")),m=Be.subscribe(C);return()=>{o.unsubscribe(),x.unsubscribe(),g.unsubscribe(),m.unsubscribe()}},[]),i.useEffect(()=>{if(u===-1)return;const o=s[u];if(!o)return;const x=o.schedule.length;te(x),re(a===0?`День ${x+1}`:`Day ${x+1}`)},[u,a,s]);const M=()=>{n(),S(!1),P(!1),E(!1)},je=()=>{He(I(W),I(L)),z(""),A(""),M(),f(!1)},Ce=()=>{Ge(u,I(W),I(L)),z(""),A(""),M(),f(!1)},ve=()=>{Oe(u,I(se)),te(o=>o+1),M()},Se=()=>{let o=a===0?"время":"time";h===0&&(o=Q+"x"+k+"-"+B),Ve(u,b,Z,o),F(!1),n()},G=o=>{oe(o);let x="";if(o===0){const g=s[u].name;x=a===0?`Удалить программу "${Array.isArray(g)?g[a]:g}"?`:`Delete program "${Array.isArray(g)?g[a]:g}"?`}else if(o===1){const g=s[u]?.schedule[b]?.name;x=a===0?`Удалить день "${g[a]}"?`:`Delete day "${g[a]}"?`}else{const g=s[u].schedule[b]?.exercises[Z]?.exId;$e(u,b,g),n();return}he(x),E(!0)},we=()=>{me===0?(Ue(u),K(-1)):(Xe(u,b),R(-1)),M()},ke=o=>{S(!0),oe(o);{const x=s[u];z(Array.isArray(x.name)?x.name[a]:x.name),A(Array.isArray(x.description)?x.description[a]:x.description),f(!0)}},Te={collapsed:{height:0,opacity:0,overflow:"hidden"},expanded:{height:"auto",opacity:1,transition:{duration:.3,ease:"easeInOut"}}};return e.jsxs("div",{style:d(t).container,children:[e.jsx(Ze,{children:e.jsx("div",{style:{width:"100%",maxWidth:"600px",paddingBottom:"80px"},children:Object.entries(s).map(([o,x])=>({id:Number(o),...x})).filter(o=>o.show).sort((o,x)=>o.id-x.id).map(o=>{const x=u===o.id;return e.jsxs(p.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{...d(t).card,backgroundColor:x?r.get("trainingGroupSelected",t):r.get("background",t),border:`1px solid ${x?r.get("currentDateBorder",t):"transparent"}`},children:[e.jsxs(p.div,{onClick:()=>{K(x?-1:o.id),R(-1)},style:d(t).groupHeader,whileTap:{scale:.98},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flex:1,gap:"15px"},children:[e.jsx("div",{style:d(t).iconBox,children:e.jsx(Pe,{size:20,color:x?"#fff":r.get("icons",t)})}),e.jsxs("div",{children:[e.jsx("p",{style:d(t,!1,!1,y).text,children:Array.isArray(o.name)?o.name[a]:o.name}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"4px"},children:[e.jsxs("span",{style:d(t).badge,children:[o.schedule.length," ",a===0?"дней":"days"]}),!x&&e.jsx("span",{style:{...d(t).badge,opacity:.6},children:o.creationDate})]})]})]}),e.jsx(p.div,{animate:{rotate:x?180:0},children:e.jsx(J,{style:d(t).icon})})]}),e.jsx(V,{children:x&&e.jsx(p.div,{variants:Te,initial:"collapsed",animate:"expanded",exit:"collapsed",style:{borderTop:`1px solid ${r.get("border",t)}`},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{style:{...d(t,!1,!1,y).subtext,marginBottom:"20px"},children:Array.isArray(o.description)?o.description[a]:o.description}),b===-1&&e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",overflowX:"auto",paddingBottom:"5px"},children:[e.jsx(O,{icon:e.jsx(Ee,{}),label:a===0?"День":"Day",onClick:()=>P(!0),theme:t}),e.jsx(O,{icon:e.jsx(Fe,{}),label:a===0?"Правка":"Edit",onClick:()=>ke(0),theme:t}),e.jsx(O,{icon:e.jsx(q,{}),label:a===0?"Удалить":"Del",onClick:()=>G(0),theme:t,isDanger:!0})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:o.schedule.map((g,m)=>e.jsx(et,{index:m,day:g,active:b===m,onClick:()=>R(b===m?-1:m),theme:t,fSize:y,langIndex:a,onAddEx:()=>N(!0),onRemove:()=>{R(m),G(1)},onRemoveEx:T=>{ee(T),G(2)}},m))}),e.jsx("div",{style:{marginTop:"25px",justifyItems:"center",padding:"15px",backgroundColor:t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"16px"},children:e.jsx(Me,{programmId:o.id,theme:t,langIndex:a,programs:s})})]})})})]},o.id)})})}),u===-1&&e.jsx(p.button,{whileTap:{scale:.9},onClick:()=>{S(!1),f(!0)},style:d(t).bigFab,children:e.jsx(ae,{size:24,color:"#FFF"})}),e.jsxs(V,{children:[w&&e.jsxs($,{onClose:()=>f(!1),theme:t,title:a===0?v?"Редактировать":"Новая программа":v?"Edit Program":"New Program",children:[e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx(H,{maxL:40,w:"100%",h:"auto",value:W,theme:t,onChange:z,placeHolder:a===0?"Название":"Name"}),e.jsx(H,{maxL:200,w:"100%",h:"auto",value:L,theme:t,onChange:A,placeHolder:a===0?"Описание":"Description"})]}),e.jsx(X,{onClose:()=>f(!1),onConfirm:()=>v?Ce():je(),theme:t})]}),ue&&e.jsxs($,{onClose:()=>P(!1),theme:t,title:a===0?"Тренировочный день":"Training Day",children:[e.jsx(H,{maxL:40,w:"100%",h:"auto",value:se,theme:t,onChange:re,placeHolder:a===0?"Название дня":"Day Name"}),e.jsx(X,{onClose:()=>P(!1),onConfirm:ve,theme:t})]}),fe&&e.jsxs($,{onClose:()=>E(!1),theme:t,title:"⚠️",children:[e.jsx("p",{style:{...d(t,!1,!1,y).text,textAlign:"center",marginBottom:"25px"},children:be}),e.jsxs("div",{style:{display:"flex",gap:"20px",width:"100%",justifyContent:"center"},children:[e.jsx(p.button,{whileTap:{scale:.95},onClick:()=>E(!1),style:d(t).secondaryBtn,children:a===0?"Нет":"Cancel"}),e.jsx(p.button,{whileTap:{scale:.95},onClick:we,style:d(t).dangerBtn,children:a===0?"Удалить":"Delete"})]})]}),ye&&e.jsxs($,{onClose:()=>F(!1),theme:t,title:a===0?"Стратегия":"Strategy",children:[e.jsxs("div",{style:d(t).segmentedControl,children:[e.jsx("div",{onClick:()=>_(0),style:{...d(t).segment,backgroundColor:h===0?r.get("background",t):"transparent",color:h===0?r.get("mainText",t):r.get("subText",t),boxShadow:h===0?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Повторы":"Reps"}),e.jsx("div",{onClick:()=>_(1),style:{...d(t).segment,backgroundColor:h===1?r.get("background",t):"transparent",color:h===1?r.get("mainText",t):r.get("subText",t),boxShadow:h===1?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Время":"Time"})]}),h===0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",justifyContent:"center",margin:"20px 0"},children:[e.jsx(U,{val:Q,set:xe,label:"SETS",theme:t}),e.jsx("span",{style:{fontSize:"20px",color:r.get("subText",t)},children:"×"}),e.jsx(U,{val:k,set:pe,label:"MIN",theme:t}),e.jsx("span",{style:{fontSize:"20px",color:r.get("subText",t)},children:"-"}),e.jsx(U,{val:B,set:Y,label:"MAX",theme:t})]}),e.jsx(X,{onClose:()=>F(!1),onConfirm:Se,theme:t})]})]}),ge&&e.jsxs("div",{style:d(t).fullOverlay,children:[e.jsx(qe,{needToAdd:!0,setEx:o=>{ee(o),N(!1),F(!0)}}),e.jsx(p.div,{whileTap:{scale:.9},onClick:()=>N(!1),style:d(t).closeOverlayBtn,children:e.jsx(le,{size:24,color:"#FFF"})})]})]})},et=({index:s,day:c,active:n,onClick:t,theme:l,fSize:a,langIndex:j,onAddEx:y,onRemove:C,onRemoveEx:w})=>e.jsxs(p.div,{layout:!0,onClick:t,style:{...d(l).card,backgroundColor:n?l==="light"?"#fff":"rgba(255,255,255,0.05)":"transparent",border:n?`1px solid ${r.get("border",l)}`:"1px solid transparent",marginBottom:"0",boxShadow:n&&l==="light"?"0 4px 12px rgba(0,0,0,0.05)":"none"},children:[e.jsxs("div",{style:{padding:"12px 15px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"12px",color:r.get("subText",l)},children:n?e.jsx(de,{}):e.jsx(J,{})}),e.jsx(We,{style:{color:r.get("currentDateBorder",l)},size:16}),e.jsx("span",{style:{fontWeight:"600",color:r.get("mainText",l),flex:1,fontSize:"15px"},children:j===0?`${c.name[0]}`:`${c.name[1]}`}),n&&e.jsxs("div",{style:{display:"flex",gap:"10px"},onClick:f=>f.stopPropagation(),children:[e.jsx(p.div,{whileTap:{scale:.9},onClick:y,style:d(l).miniBtn,children:e.jsx(ae,{size:12,color:"#fff"})}),e.jsx(p.div,{whileTap:{scale:.9},onClick:C,style:{...d(l).miniBtn,backgroundColor:"rgba(255, 77, 77, 0.2)"},children:e.jsx(q,{size:12,color:"#ff4d4d"})})]})]}),e.jsx(V,{children:n&&e.jsx(p.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsxs("div",{style:{padding:"0 15px 15px",display:"flex",flexDirection:"column",gap:"8px"},children:[c.exercises.map((f,v)=>{const S=D.exercises[f.exId];return S?e.jsxs("div",{style:d(l).exerciseRow,children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:r.get("mainText",l)},children:S.name[j]}),e.jsxs("div",{style:{fontSize:"12px",color:r.get("subText",l),display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Le,{size:10})," ",f.sets]})]})}),e.jsx(p.div,{whileTap:{scale:.9},onClick:u=>{u.stopPropagation(),w(v)},style:{padding:"8px",opacity:.6},children:e.jsx(q,{color:"#ff4d4d",size:14})})]},v):null}),c.exercises.length===0&&e.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:r.get("subText",l),padding:"10px"},children:j===0?"Нет упражнений":"No exercises"})]})})})]}),O=({icon:s,onClick:c,theme:n,label:t,isDanger:l})=>e.jsxs(p.div,{whileTap:{scale:.95},onClick:c,style:{flex:1,padding:"8px 12px",borderRadius:"12px",minWidth:"80px",backgroundColor:l?"rgba(255, 77, 77, 0.1)":n==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",color:l?"#ff4d4d":r.get("subText",n),display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",cursor:"pointer"},children:[s,e.jsx("span",{style:{fontSize:"10px",fontWeight:"700",opacity:.8,textTransform:"uppercase"},children:t})]}),U=({val:s,set:c,label:n,theme:t})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"8px"},children:[e.jsx("div",{style:{fontSize:"9px",fontWeight:"800",color:r.get("subText",t),marginBottom:"4px"},children:n}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(p.div,{whileTap:{scale:.8},onClick:()=>c(l=>l>1?l-1:1),style:d(t).miniBtn,children:e.jsx(J,{size:14,color:"#fff"})}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:r.get("mainText",t),minWidth:"24px",textAlign:"center"},children:s}),e.jsx(p.div,{whileTap:{scale:.8},onClick:()=>c(l=>l+1),style:d(t).miniBtn,children:e.jsx(de,{size:14,color:"#fff"})})]})]}),$=({children:s,title:c,theme:n,onClose:t})=>e.jsx("div",{style:d(n).modalBackdrop,onClick:t,children:e.jsxs(p.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95},style:d(n).modalContainer,onClick:l=>l.stopPropagation(),children:[e.jsx("div",{style:d(n).modalHeader,children:e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",color:r.get("mainText",n),margin:0},children:c})}),e.jsx("div",{style:{width:"100%",padding:"0 20px",display:"flex",flexDirection:"column",alignItems:"center"},children:s})]})}),X=({onClose:s,onConfirm:c,theme:n})=>e.jsxs("div",{style:d(n).modalActions,children:[e.jsx(p.div,{whileTap:{scale:.9},onClick:s,style:d(n).circleBtn,children:e.jsx(le,{style:{fontSize:"24px",color:r.get("subText",n)}})}),e.jsx(p.div,{whileTap:{scale:.9},onClick:c,style:{...d(n).circleBtn,backgroundColor:r.get("currentDateBorder",n)},children:e.jsx(Ne,{style:{fontSize:"24px",color:"#fff"}})})]}),I=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"",d=(s,c,n,t)=>({container:{backgroundColor:r.get("background",s),display:"flex",flexDirection:"column",overflowY:"auto",alignItems:"center",height:"90vh",paddingTop:"20px",width:"100vw",marginTop:"110px",fontFamily:"Segoe UI, Roboto, sans-serif",boxSizing:"border-box"},card:{width:"94%",margin:"0 auto 12px auto",borderRadius:"16px",overflow:"hidden",boxShadow:s==="light"?"0 2px 8px rgba(0,0,0,0.05)":"none"},groupHeader:{display:"flex",flexDirection:"row",padding:"15px",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},iconBox:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:r.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center"},badge:{fontSize:"10px",fontWeight:"700",padding:"2px 8px",borderRadius:"6px",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:r.get("subText",s),textTransform:"uppercase"},text:{fontSize:t===0?"16px":"18px",color:r.get("mainText",s),fontWeight:"600",margin:0},subtext:{fontSize:t===0?"13px":"15px",color:r.get("subText",s),lineHeight:"1.4",margin:0},icon:{fontSize:"20px",color:r.get("icons",s)},exerciseRow:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",borderRadius:"12px",backgroundColor:s==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",border:`1px solid ${r.get("border",s)}`},exerciseIcon:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},bigFab:{position:"fixed",bottom:"110px",right:"30px",width:"56px",height:"56px",borderRadius:"28px",backgroundColor:r.get("currentDateBorder",s),border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 20px rgba(0,0,0,0.3)",cursor:"pointer",zIndex:100},miniBtn:{width:"24px",height:"24px",borderRadius:"8px",backgroundColor:r.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},circleBtn:{width:"50px",height:"50px",borderRadius:"25px",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},secondaryBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:r.get("mainText",s),fontSize:"16px",cursor:"pointer"},dangerBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:"#ff4d4d",color:"#fff",fontSize:"16px",cursor:"pointer"},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},modalContainer:{width:"99%",maxWidth:"400px",backgroundColor:r.get("background",s),borderRadius:"24px",boxShadow:"0 20px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",alignItems:"center",border:`1px solid ${r.get("border",s)}`,overflow:"hidden"},modalHeader:{width:"100%",padding:"20px",borderBottom:`1px solid ${r.get("border",s)}`,textAlign:"center",marginBottom:"15px"},modalActions:{marginTop:"20px",padding:"15px 20px",width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",borderTop:`1px solid ${r.get("border",s)}`,backgroundColor:s==="light"?"rgba(0,0,0,0.02)":"rgba(255,255,255,0.02)"},segmentedControl:{display:"flex",width:"100%",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"4px",margin:"10px 0"},segment:{flex:1,textAlign:"center",padding:"8px",borderRadius:"10px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},fullOverlay:{position:"fixed",inset:0,backgroundColor:r.get("background",s),zIndex:6e3},closeOverlayBtn:{position:"fixed",top:"20px",right:"20px",zIndex:6001,width:"40px",height:"40px",borderRadius:"20px",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}});export{lt as default};
