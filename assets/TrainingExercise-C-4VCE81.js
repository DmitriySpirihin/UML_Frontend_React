import{A as y,t as ue,l as ge,X as fe,f as he,j as e,C as r,M as K,b6 as I,m as c,a as E,_ as Q,o as be,a7 as me,W as ye,b7 as je,a3 as Ce,b8 as Se,b9 as ve}from"./index-DVUQEQ9_.js";import{r as l}from"./recharts-Bg6K2Pzo.js";import{d as we,b as Z}from"./index-DHKYZ1NB.js";import{T as ke}from"./index-Cg_6Gqjc.js";import{M as ee}from"./MyInput-bzWbhPwF.js";const Re=({needToAdd:a,setEx:U})=>{const[t,B]=l.useState("dark"),[s,te]=l.useState(y.prefs[0]),[j,re]=l.useState(y.prefs[1]),[D,P]=l.useState(""),[S,oe]=l.useState(-1),[C,W]=l.useState(-1),[V,X]=l.useState(""),[v,Y]=l.useState(""),[se,G]=l.useState(!1),[_,ne]=l.useState(!1),[w,F]=l.useState(!1),[z,N]=l.useState(""),[k,H]=l.useState(""),[f,A]=l.useState(!0),[h,$]=l.useState(new Array(14).fill(!1)),[R,L]=l.useState(0);l.useEffect(()=>{const o=ue.subscribe(B),i=ge.subscribe(p=>{te(p==="ru"?0:1)});return()=>{i.unsubscribe(),o.unsubscribe()}},[]),l.useEffect(()=>{const o=fe.subscribe(P),i=he.subscribe(re);return()=>{o.unsubscribe(),i.unsubscribe()}},[]);function ie(o){m(null),oe(S===o?-1:o),S===-1&&W(-1)}function ae(o){m(null),W(C===o?-1:o)}function O(){m(null),P(""),$(new Array(14).fill(!1)),N(""),H(""),A(!0)}function le(){if(z.length<3){Ce(s===0?"Введите название (мин. 3 символа)":"Enter name (min 3 chars)",2e3,!1);return}const o=R,i=[];for(let d=0;d<h.length;d++)h[d]&&i.push(d);m(null);const p=M(z),x=k.length>3?M(k):"";Se(o,i,[s===0?p:"Custom exercise",s===1?p:"Своё упражнение"],[s===0?x||"Своё упражнение":"Custom exercise",s===1?x||"Custom exercise":"Своё упражнение"],f),O()}function de(){const o=y.exercises[C];if(o){N(o.name[s]);const i=new Array(14).fill(!1);o.addMgIds.length>0&&o.addMgIds.forEach(p=>{i[p]=!0}),$(i),H(o.description[s]),L(o.mgId),A(o.isBase),F(!0)}}function ce(){m(null);const o=[];for(let d=0;d<h.length;d++)h[d]&&o.push(d);const i=y.exercises[C],p=[...i.name];p[s]=M(z);const x=[...i.description];k.length>3?x[s]=M(k):x[s]=s===0?"Своё упражнение":"Custom exercise",je(C,R,o,p,x,f),F(!1)}function pe(){m(null),ve(C),W(-1),G(!1),O()}l.useEffect(()=>{D==="AddExercisePanel"&&L(S!==-1?S:0)},[D]);const xe={collapsed:{height:0,opacity:0,overflow:"hidden"},expanded:{height:"auto",opacity:1,transition:{duration:.3,ease:"easeInOut"}}},q={hidden:{opacity:0,y:100,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",damping:25,stiffness:300}},exit:{opacity:0,y:100,scale:.95}};return e.jsxs("div",{style:n(t).container,children:[e.jsxs("div",{style:n(t).searchContainer,children:[e.jsx(we,{style:{color:r.get("subText",t),fontSize:"20px",marginLeft:"10px"}}),e.jsx("input",{type:"text",placeholder:s===0?"Поиск упражнения...":"Search exercise...",value:v,onChange:o=>Y(o.target.value),style:n(t).searchInput}),v&&e.jsx(K,{onClick:()=>Y(""),style:{color:r.get("subText",t),fontSize:"18px",marginRight:"10px",cursor:"pointer"}})]}),e.jsx("div",{style:{width:"100%",maxWidth:"600px",paddingBottom:"80px",flex:1,overflowY:"auto"},children:Object.keys(I.muscleIconsSrc[0]).map(o=>{const i=Number(o),p=Object.entries(y.exercises).filter(([d,u])=>{const b=u.mgId===i,T=u.name[s].toLowerCase().includes(v.toLowerCase());return b&&u.show&&T}).sort(([d],[u])=>Number(d)-Number(u));if(v&&p.length===0)return null;const x=S===i;return e.jsxs(c.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{...n(t).card,backgroundColor:x?r.get("trainingGroupSelected",t):r.get("background",t),border:`1px solid ${x?r.get("currentDateBorder",t):"transparent"}`},children:[e.jsxs(c.div,{onClick:()=>ie(d=>d===i?-1:i),style:n(t).groupHeader,whileTap:{scale:.98},children:[e.jsx("div",{style:{flex:1},children:I.get(i,s,t,!0,"100%")}),e.jsx(c.div,{animate:{rotate:x?180:0},children:e.jsx(Z,{style:n(t).icon})})]}),e.jsx(E,{children:x&&e.jsx(c.div,{variants:xe,initial:"collapsed",animate:"expanded",exit:"collapsed",style:{borderTop:`1px solid ${r.get("border",t)}`},children:e.jsxs("div",{style:{padding:"10px 0"},children:[p.map(([d,u])=>{const b=Number(d),T=C===b,J=u.isBase;return e.jsxs(c.div,{layout:!0,style:{marginBottom:"8px"},children:[e.jsxs(c.div,{onClick:()=>ae(g=>g===b?-1:b),style:{...n(t).exerciseRow,backgroundColor:T?t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)":"transparent"},whileTap:{backgroundColor:r.get("trainingGroup",t)},children:[e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("p",{style:{...n(t,!1,!1,j).text,textAlign:"left"},children:u.name[s]}),e.jsx("div",{style:{fontSize:"9px",fontWeight:"bold",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase",letterSpacing:"0.5px",marginLeft:"auto",color:J?r.get("difficulty5",t):r.get("difficulty2",t),opacity:.8},children:J?s===0?"База":"Base":s===0?"Изол":"Iso"})]}),a&&e.jsx(c.div,{whileTap:{scale:.8},onClick:g=>{g.stopPropagation(),U(b)},style:{padding:"8px"},children:e.jsx(Q,{style:{color:r.get("currentDateBorder",t),fontSize:"18px"}})}),e.jsx(c.div,{animate:{rotate:T?180:0},children:e.jsx(Z,{style:{...n(t).icon,fontSize:"14px"}})})]}),e.jsx(E,{children:T&&e.jsxs(c.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{padding:"0 20px 10px 20px"},children:[e.jsx("p",{style:n(t,!1,!1,j).subtext,children:u.description[s]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",gap:"15px"},children:[e.jsx(E,{children:_&&e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0},style:{display:"flex",gap:"15px"},children:[e.jsx(be,{onClick:g=>{g.stopPropagation(),X(u.name[s]),de()},style:{color:r.get("subText",t),fontSize:"16px"}}),e.jsx(me,{onClick:g=>{g.stopPropagation(),X(u.name[s]),G(!0)},style:{color:"#ff4d4d",fontSize:"16px"}})]})}),e.jsx(ke,{onClick:g=>{g.stopPropagation(),ne(!_)},style:{color:r.get("icons",t),fontSize:"20px"}})]})]})})]},b)}),!v&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsxs(c.button,{whileTap:{scale:.95},onClick:()=>{m(null),P("AddExercisePanel")},style:n(t).fab,children:[e.jsx(Q,{style:{fontSize:"14px",color:"#fff"}}),e.jsx("span",{style:{fontSize:"13px",fontWeight:"600"},children:s===0?"Создать":"Create"})]})})]})})})]},i)})}),e.jsxs(E,{children:[(D==="AddExercisePanel"||w)&&e.jsx("div",{style:n(t).modalBackdrop,children:e.jsxs(c.div,{variants:q,initial:"hidden",animate:"visible",exit:"exit",style:n(t).modalContainer,children:[e.jsx("div",{style:n(t).modalHeader,children:e.jsx("h3",{style:n(t,!1,!1,j).headerText,children:s===0?w?"Редактор":"Конструктор":w?"Editor":"Constructor"})}),e.jsxs("div",{style:{width:"100%",padding:"0 20px",display:"flex",flexDirection:"column",gap:"15px",overflowY:"auto"},children:[e.jsx(ee,{maxL:40,w:"100%",h:"auto",value:z,theme:t,onChange:o=>N(o),placeHolder:s===0?"Название":"Name"}),e.jsx(ee,{maxL:300,w:"100%",h:"auto",value:k,theme:t,onChange:o=>H(o),placeHolder:s===0?"Описание":"Description"}),e.jsxs("div",{style:n(t).segmentedControl,children:[e.jsx("div",{onClick:()=>A(!0),style:{...n(t).segment,backgroundColor:f?r.get("background",t):"transparent",color:f?r.get("trainingBaseFont",t):r.get("subText",t),boxShadow:f?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:s===0?"База":"Base"}),e.jsx("div",{onClick:()=>A(!1),style:{...n(t).segment,backgroundColor:f?"transparent":r.get("background",t),color:f?r.get("subText",t):r.get("trainingIsolatedFont",t),boxShadow:f?"none":"0 2px 5px rgba(0,0,0,0.1)"},children:s===0?"Изол.":"Iso"})]}),e.jsxs("div",{style:{marginTop:"5px"},children:[e.jsx("p",{style:{...n(t,!1,!1,j).label,marginBottom:"8px"},children:s===0?"Основная мышца":"Main Muscle"}),e.jsx("div",{style:n(t).horizontalScroll,children:Object.keys(I.muscleIconsSrc[0]).map(o=>{const i=Number(o),p=R===i;return e.jsx("div",{onClick:()=>L(i),style:{...n(t).scrollItem,borderColor:p?r.get("currentDateBorder",t):"transparent",backgroundColor:p?t==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)":"transparent"},children:I.getForList(i,s,t)},i)})})]}),e.jsxs("div",{children:[e.jsx("p",{style:{...n(t,!1,!1,j).label,marginBottom:"8px"},children:s===0?"Доп. мышцы":"Secondary Muscles"}),e.jsx("div",{style:n(t).chipGrid,children:I.names[s].map((o,i)=>R===i?null:e.jsx(c.div,{whileTap:{scale:.95},onClick:()=>$(p=>p.map((x,d)=>d===i?!x:x)),style:{...n(t).chip,backgroundColor:h[i]?r.get("currentDateBorder",t):"transparent",color:h[i]?"#fff":r.get("subText",t),borderColor:h[i]?"transparent":r.get("border",t)},children:o},i))})]})]}),e.jsxs("div",{style:n(t).modalActions,children:[e.jsx(c.div,{whileTap:{scale:.9},onClick:()=>w?F(!1):O(),style:n(t).circleBtn,children:e.jsx(K,{style:{fontSize:"24px",color:r.get("subText",t)}})}),e.jsx(c.div,{whileTap:{scale:.9},onClick:()=>w?ce():le(),style:{...n(t).circleBtn,backgroundColor:r.get("currentDateBorder",t)},children:e.jsx(ye,{style:{fontSize:"24px",color:"#fff"}})})]})]})}),se&&e.jsx("div",{style:n(t).modalBackdrop,children:e.jsxs(c.div,{variants:q,initial:"hidden",animate:"visible",exit:"exit",style:{...n(t).modalContainer,height:"auto",padding:"25px",maxHeight:"300px"},children:[e.jsx("p",{style:{...n(t,!1,!1,j).text,textAlign:"center",marginBottom:"25px"},children:s===0?`Удалить ${V}?`:`Delete ${V}?`}),e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsx(c.button,{whileTap:{scale:.95},onClick:()=>G(!1),style:n(t).secondaryBtn,children:s===0?"Нет":"Cancel"}),e.jsx(c.button,{whileTap:{scale:.95},onClick:()=>pe(),style:n(t).dangerBtn,children:s===0?"Удалить":"Delete"})]})]})})]})]})},n=(a,U,t,B)=>({container:{backgroundColor:r.get("background",a),display:"flex",flexDirection:"column",overflow:"hidden",alignItems:"center",height:"100vh",paddingTop:"120px",width:"100vw",fontFamily:"Segoe UI, Roboto, sans-serif",boxSizing:"border-box"},searchContainer:{width:"94%",maxWidth:"600px",backgroundColor:a==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",display:"flex",alignItems:"center",padding:"8px 0",marginBottom:"10px"},searchInput:{flex:1,border:"none",background:"transparent",fontSize:"15px",color:r.get("mainText",a),marginLeft:"8px",outline:"none"},card:{width:"94%",margin:"0 auto 12px auto",borderRadius:"16px",overflow:"hidden",boxShadow:a==="light"?"0 2px 8px rgba(0,0,0,0.05)":"none"},groupHeader:{display:"flex",flexDirection:"row",padding:"12px 10px",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},exerciseRow:{display:"flex",flexDirection:"row",width:"92%",padding:"12px 20px",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderRadius:"12px",margin:"0 10px"},icon:{fontSize:"20px",color:r.get("icons",a),marginRight:"10px"},text:{fontSize:B===0?"15px":"17px",color:r.get("mainText",a),fontWeight:"500",margin:0},subtext:{fontSize:B===0?"13px":"15px",color:r.get("subText",a),lineHeight:"1.4",margin:0},label:{fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",color:r.get("subText",a),letterSpacing:"0.5px"},headerText:{fontSize:"18px",fontWeight:"bold",color:r.get("mainText",a),margin:0},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},modalContainer:{width:"90%",maxWidth:"400px",height:"80vh",maxHeight:"750px",backgroundColor:r.get("background",a),borderRadius:"24px",boxShadow:"0 20px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",alignItems:"center",border:`1px solid ${r.get("border",a)}`,overflow:"hidden"},modalHeader:{width:"100%",padding:"20px",borderBottom:`1px solid ${r.get("border",a)}`,textAlign:"center",marginBottom:"15px"},modalActions:{marginTop:"auto",padding:"15px 20px",width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",borderTop:`1px solid ${r.get("border",a)}`,backgroundColor:a==="light"?"rgba(0,0,0,0.02)":"rgba(255,255,255,0.02)"},segmentedControl:{display:"flex",width:"100%",backgroundColor:a==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"4px",margin:"10px 0"},segment:{flex:1,textAlign:"center",padding:"8px",borderRadius:"10px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},horizontalScroll:{display:"flex",overflowX:"auto",gap:"8px",padding:"5px 0 15px 0",scrollbarWidth:"none",width:"100%"},scrollItem:{minWidth:"60px",borderRadius:"12px",border:"1px solid",padding:"5px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},chipGrid:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"5px",paddingBottom:"20px"},chip:{padding:"6px 12px",borderRadius:"20px",border:"1px solid",fontSize:"12px",cursor:"pointer",fontWeight:"500"},circleBtn:{width:"50px",height:"50px",borderRadius:"25px",backgroundColor:a==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},fab:{backgroundColor:r.get("currentDateBorder",a),border:"none",borderRadius:"20px",padding:"8px 20px",display:"flex",alignItems:"center",gap:"8px",color:"#fff",cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,0.2)"},secondaryBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:a==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:r.get("mainText",a),fontSize:"16px",cursor:"pointer"},dangerBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:"#ff4d4d",color:"#fff",fontSize:"16px",cursor:"pointer"}});function m(a){y.prefs[2]==0,y.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred("light")}const M=a=>a&&a.charAt(0).toUpperCase()+a.slice(1);export{Re as default};
