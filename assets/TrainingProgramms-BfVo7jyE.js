import{am as Re,an as ze,aO as ie,j as e,A as R,t as Ae,l as Be,a2 as Pe,f as Ee,C as o,m as u,aP as Me,a as X,aQ as Fe,o as $e,ae as Y,aR as Le,a5 as de,M as ce,aS as We,aT as Ne,aU as Ge,a1 as He,aV as Oe,aW as Ue,aX as Ve,aY as Xe,aZ as Ye,a_ as qe}from"./index-KwpXYLad.js";import{r as n}from"./recharts-k8ghPecL.js";import{b as xe,c as Qe}from"./index-CSYXo5XC.js";import{M as H}from"./MyInput-CYAIRFyP.js";import Ze from"./TrainingExercise-DKaCo_Wf.js";import{S as O}from"./ScrollPicker-9W7hIaGM.js";import"./index-CWqBIGDM.js";const _e=n.createContext(null);function Je(){const s=n.useRef(!1);return Re(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function Ke(){const s=Je(),[l,r]=n.useState(0),t=n.useCallback(()=>{s.current&&r(l+1)},[l]);return[n.useCallback(()=>ze.postRender(t),[t]),l]}const et=s=>!s.isLayoutDirty&&s.willUpdate(!1);function ae(){const s=new Set,l=new WeakMap,r=()=>s.forEach(et);return{add:t=>{s.add(t),l.set(t,t.addEventListener("willUpdate",r))},remove:t=>{s.delete(t);const x=l.get(t);x&&(x(),l.delete(t)),r()},dirty:r}}const pe=s=>s===!0,tt=s=>pe(s===!0)||s==="id",st=({children:s,id:l,inherit:r=!0})=>{const t=n.useContext(ie),x=n.useContext(_e),[a,j]=Ke(),y=n.useRef(null),C=t.id||x;y.current===null&&(tt(r)&&C&&(l=l?C+"-"+l:C),y.current={id:l,group:pe(r)&&t.group||ae()});const T=n.useMemo(()=>({...y.current,forceRender:a}),[j]);return e.jsx(ie.Provider,{value:T,children:s})},le=(s,l)=>{const r=[];for(let t=s;t<=l;t++)r.push(t);return r},pt=()=>{const[s,l]=n.useState(R.programs),r=()=>{l({...R.programs})},[t,x]=n.useState("dark"),[a,j]=n.useState(R.prefs[0]),[y,C]=n.useState(R.prefs[1]),[T,f]=n.useState(!1),[S,v]=n.useState(!1),[p,q]=n.useState(-1),[h,z]=n.useState(-1),[L,A]=n.useState(""),[W,B]=n.useState(""),[Q,ue]=n.useState(3),[w,Z]=n.useState(8),[k,_]=n.useState(12),[b,J]=n.useState(0),[K,ee]=n.useState(0),ge=n.useMemo(()=>le(1,20),[]),te=n.useMemo(()=>le(1,100),[]),[nt,se]=n.useState(1),[oe,ne]=n.useState(a===0?"День 1":"Day 1"),[fe,P]=n.useState(!1),[ye,N]=n.useState(!1),[he,E]=n.useState(!1),[be,M]=n.useState(!1),[me,je]=n.useState(""),[Ce,re]=n.useState(0);n.useEffect(()=>{w>k&&_(w)},[w]),n.useEffect(()=>{k<w&&Z(k)},[k]),n.useEffect(()=>{const i=Ae.subscribe(x),d=Be.subscribe(I=>j(I==="ru"?0:1)),g=Pe.subscribe(I=>f(I==="AddProgrammPanel")),m=Ee.subscribe(C);return()=>{i.unsubscribe(),d.unsubscribe(),g.unsubscribe(),m.unsubscribe()}},[]),n.useEffect(()=>{if(p===-1)return;const i=s[p];if(!i)return;const d=i.schedule.length;se(d),ne(a===0?`День ${d+1}`:`Day ${d+1}`)},[p,a,s]);const F=()=>{r(),v(!1),P(!1),E(!1)},Se=()=>{Ue(D(L),D(W)),A(""),B(""),F(),f(!1)},ve=()=>{Oe(p,D(L),D(W)),A(""),B(""),F(),f(!1)},we=()=>{Ve(p,D(oe)),se(i=>i+1),F()},ke=()=>{let i=a===0?"время":"time";b===0&&(i=Q+"x"+w+"-"+k),qe(p,h,K,i),M(!1),r()},G=i=>{re(i);let d="";if(i===0){const g=s[p].name;d=a===0?`Удалить программу "${Array.isArray(g)?g[a]:g}"?`:`Delete program "${Array.isArray(g)?g[a]:g}"?`}else if(i===1){const g=s[p]?.schedule[h]?.name;d=a===0?`Удалить день "${g[a]}"?`:`Delete day "${g[a]}"?`}else{const g=s[p].schedule[h]?.exercises[K]?.exId;We(p,h,g),r();return}je(d),E(!0)},Te=()=>{Ce===0?(Xe(p),q(-1)):(Ye(p,h),z(-1)),F()},Ie=i=>{v(!0),re(i);{const d=s[p];A(Array.isArray(d.name)?d.name[a]:d.name),B(Array.isArray(d.description)?d.description[a]:d.description),f(!0)}},De={collapsed:{height:0,opacity:0,overflow:"hidden"},expanded:{height:"auto",opacity:1,transition:{duration:.3,ease:"easeInOut"}}};return e.jsxs("div",{style:c(t).container,children:[e.jsx(st,{children:e.jsx("div",{style:{width:"100%",maxWidth:"600px",paddingBottom:"80px"},children:Object.entries(s).map(([i,d])=>({id:Number(i),...d})).filter(i=>i.show).sort((i,d)=>i.id-d.id).map(i=>{const d=p===i.id;return e.jsxs(u.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{...c(t).card,backgroundColor:d?o.get("trainingGroupSelected",t):o.get("background",t),border:`1px solid ${d?o.get("currentDateBorder",t):"transparent"}`},children:[e.jsxs(u.div,{onClick:()=>{q(d?-1:i.id),z(-1)},style:c(t).groupHeader,whileTap:{scale:.98},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flex:1,gap:"15px"},children:[e.jsx("div",{style:c(t).iconBox,children:e.jsx(Me,{size:20,color:d?"#fff":o.get("icons",t)})}),e.jsxs("div",{children:[e.jsx("p",{style:c(t,!1,!1,y).text,children:Array.isArray(i.name)?i.name[a]:i.name}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"4px"},children:[e.jsxs("span",{style:c(t).badge,children:[i.schedule.length," ",a===0?"дней":"days"]}),!d&&e.jsx("span",{style:{...c(t).badge,opacity:.6},children:i.creationDate})]})]})]}),e.jsx(u.div,{animate:{rotate:d?180:0},children:e.jsx(xe,{style:c(t).icon})})]}),e.jsx(X,{children:d&&e.jsx(u.div,{variants:De,initial:"collapsed",animate:"expanded",exit:"collapsed",style:{borderTop:`1px solid ${o.get("border",t)}`},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{style:{...c(t,!1,!1,y).subtext,marginBottom:"20px"},children:Array.isArray(i.description)?i.description[a]:i.description}),h===-1&&e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",overflowX:"auto",paddingBottom:"5px"},children:[e.jsx(U,{icon:e.jsx(Fe,{}),label:a===0?"День":"Day",onClick:()=>P(!0),theme:t}),e.jsx(U,{icon:e.jsx($e,{}),label:a===0?"Правка":"Edit",onClick:()=>Ie(0),theme:t}),e.jsx(U,{icon:e.jsx(Y,{}),label:a===0?"Удалить":"Del",onClick:()=>G(0),theme:t,isDanger:!0})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:i.schedule.map((g,m)=>e.jsx(ot,{index:m,day:g,active:h===m,onClick:()=>z(h===m?-1:m),theme:t,fSize:y,langIndex:a,onAddEx:()=>N(!0),onRemove:()=>{z(m),G(1)},onRemoveEx:I=>{ee(I),G(2)}},m))}),e.jsx("div",{style:{marginTop:"25px",justifyItems:"center",padding:"15px",backgroundColor:t==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",borderRadius:"16px"},children:e.jsx(Le,{programmId:i.id,theme:t,langIndex:a,programs:s})})]})})})]},i.id)})})}),p===-1&&e.jsx(u.button,{whileTap:{scale:.9},onClick:()=>{v(!1),f(!0)},style:c(t).bigFab,children:e.jsx(de,{size:24,color:"#FFF"})}),e.jsxs(X,{children:[T&&e.jsxs($,{onClose:()=>f(!1),theme:t,title:a===0?S?"Редактировать":"Новая программа":S?"Edit Program":"New Program",children:[e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx(H,{maxL:40,w:"100%",h:"auto",value:L,theme:t,onChange:A,placeHolder:a===0?"Название":"Name"}),e.jsx(H,{maxL:200,w:"100%",h:"auto",value:W,theme:t,onChange:B,placeHolder:a===0?"Описание":"Description"})]}),e.jsx(V,{onClose:()=>f(!1),onConfirm:()=>S?ve():Se(),theme:t})]}),fe&&e.jsxs($,{onClose:()=>P(!1),theme:t,title:a===0?"Тренировочный день":"Training Day",children:[e.jsx(H,{maxL:40,w:"100%",h:"auto",value:oe,theme:t,onChange:ne,placeHolder:a===0?"Название дня":"Day Name"}),e.jsx(V,{onClose:()=>P(!1),onConfirm:we,theme:t})]}),he&&e.jsxs($,{onClose:()=>E(!1),theme:t,title:"⚠️",children:[e.jsx("p",{style:{...c(t,!1,!1,y).text,textAlign:"center",marginBottom:"25px"},children:me}),e.jsxs("div",{style:{display:"flex",gap:"20px",width:"100%",justifyContent:"center"},children:[e.jsx(u.button,{whileTap:{scale:.95},onClick:()=>E(!1),style:c(t).secondaryBtn,children:a===0?"Нет":"Cancel"}),e.jsx(u.button,{whileTap:{scale:.95},onClick:Te,style:c(t).dangerBtn,children:a===0?"Удалить":"Delete"})]})]}),be&&e.jsxs($,{onClose:()=>M(!1),theme:t,title:a===0?"Стратегия":"Strategy",children:[e.jsxs("div",{style:c(t).segmentedControl,children:[e.jsx("div",{onClick:()=>J(0),style:{...c(t).segment,backgroundColor:b===0?o.get("difficulty",t):"transparent",color:b===0?o.get("mainText",t):o.get("subText",t),boxShadow:b===0?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Повторы":"Reps"}),e.jsx("div",{onClick:()=>J(1),style:{...c(t).segment,backgroundColor:b===1?o.get("difficulty",t):"transparent",color:b===1?o.get("mainText",t):o.get("subText",t),boxShadow:b===1?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:a===0?"Время":"Time"})]}),b===0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",margin:"20px 0"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:o.get("subText",t),marginBottom:"5px"},children:"SETS"}),e.jsx(O,{items:ge,value:Q,onChange:ue,theme:t,width:"60px"})]}),e.jsx("span",{style:{fontSize:"20px",color:o.get("subText",t),marginTop:"15px"},children:"×"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:o.get("subText",t),marginBottom:"5px"},children:"MIN"}),e.jsx(O,{items:te,value:w,onChange:Z,theme:t,width:"60px"})]}),e.jsx("span",{style:{fontSize:"20px",color:o.get("subText",t),marginTop:"15px"},children:"-"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",color:o.get("subText",t),marginBottom:"5px"},children:"MAX"}),e.jsx(O,{items:te,value:k,onChange:_,theme:t,width:"60px"})]})]}),e.jsx(V,{onClose:()=>M(!1),onConfirm:ke,theme:t})]})]}),ye&&e.jsxs("div",{style:c(t).fullOverlay,children:[e.jsx(Ze,{needToAdd:!0,setEx:i=>{ee(i),N(!1),M(!0)}}),e.jsx(u.div,{whileTap:{scale:.9},onClick:()=>N(!1),style:c(t).closeOverlayBtn,children:e.jsx(ce,{size:24,color:"#FFF"})})]})]})},ot=({index:s,day:l,active:r,onClick:t,theme:x,fSize:a,langIndex:j,onAddEx:y,onRemove:C,onRemoveEx:T})=>e.jsxs(u.div,{layout:!0,onClick:t,style:{...c(x).card,backgroundColor:r?x==="light"?"#fff":"rgba(255,255,255,0.05)":"transparent",border:r?`1px solid ${o.get("border",x)}`:"1px solid transparent",marginBottom:"0",boxShadow:r&&x==="light"?"0 4px 12px rgba(0,0,0,0.05)":"none"},children:[e.jsxs("div",{style:{padding:"12px 15px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"12px",color:o.get("subText",x)},children:r?e.jsx(Qe,{}):e.jsx(xe,{})}),e.jsx(Ne,{style:{color:o.get("currentDateBorder",x)},size:16}),e.jsx("span",{style:{fontWeight:"600",color:o.get("mainText",x),flex:1,fontSize:"15px"},children:j===0?`${l.name[0]}`:`${l.name[1]}`}),r&&e.jsxs("div",{style:{display:"flex",gap:"10px"},onClick:f=>f.stopPropagation(),children:[e.jsx(u.div,{whileTap:{scale:.9},onClick:y,style:c(x).miniBtn,children:e.jsx(de,{size:12,color:"#fff"})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:C,style:{...c(x).miniBtn,backgroundColor:"rgba(255, 77, 77, 0.2)"},children:e.jsx(Y,{size:12,color:"#ff4d4d"})})]})]}),e.jsx(X,{children:r&&e.jsx(u.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsxs("div",{style:{padding:"0 15px 15px",display:"flex",flexDirection:"column",gap:"8px"},children:[l.exercises.map((f,S)=>{const v=R.exercises[f.exId];return v?e.jsxs("div",{style:c(x).exerciseRow,children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:o.get("mainText",x)},children:v.name[j]}),e.jsxs("div",{style:{fontSize:"12px",color:o.get("subText",x),display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Ge,{size:10})," ",f.sets]})]})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:p=>{p.stopPropagation(),T(S)},style:{padding:"8px",opacity:.6},children:e.jsx(Y,{color:"#ff4d4d",size:14})})]},S):null}),l.exercises.length===0&&e.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:o.get("subText",x),padding:"10px"},children:j===0?"Нет упражнений":"No exercises"})]})})})]}),U=({icon:s,onClick:l,theme:r,label:t,isDanger:x})=>e.jsxs(u.div,{whileTap:{scale:.95},onClick:l,style:{flex:1,padding:"8px 12px",borderRadius:"12px",minWidth:"80px",backgroundColor:x?"rgba(255, 77, 77, 0.1)":r==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.08)",color:x?"#ff4d4d":o.get("subText",r),display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",cursor:"pointer"},children:[s,e.jsx("span",{style:{fontSize:"10px",fontWeight:"700",opacity:.8,textTransform:"uppercase"},children:t})]}),$=({children:s,title:l,theme:r,onClose:t})=>e.jsx("div",{style:c(r).modalBackdrop,onClick:t,children:e.jsxs(u.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95},style:c(r).modalContainer,onClick:x=>x.stopPropagation(),children:[e.jsx("div",{style:c(r).modalHeader,children:e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",color:o.get("mainText",r),margin:0},children:l})}),e.jsx("div",{style:{width:"100%",padding:"0 20px",display:"flex",flexDirection:"column",alignItems:"center"},children:s})]})}),V=({onClose:s,onConfirm:l,theme:r})=>e.jsxs("div",{style:c(r).modalActions,children:[e.jsx(u.div,{whileTap:{scale:.9},onClick:s,style:c(r).circleBtn,children:e.jsx(ce,{style:{fontSize:"24px",color:o.get("subText",r)}})}),e.jsx(u.div,{whileTap:{scale:.9},onClick:l,style:{...c(r).circleBtn,backgroundColor:o.get("done",r)},children:e.jsx(He,{style:{fontSize:"24px",color:"#fff"}})})]}),D=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"",c=(s,l,r,t)=>({container:{backgroundColor:o.get("background",s),display:"flex",flexDirection:"column",overflowY:"auto",alignItems:"center",height:"90vh",paddingTop:"20px",width:"100vw",marginTop:"110px",fontFamily:"Segoe UI, Roboto, sans-serif",boxSizing:"border-box"},card:{width:"94%",margin:"0 auto 12px auto",borderRadius:"16px",overflow:"hidden",boxShadow:s==="light"?"0 2px 8px rgba(0,0,0,0.05)":"none"},groupHeader:{display:"flex",flexDirection:"row",padding:"15px",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},iconBox:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:o.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center"},badge:{fontSize:"10px",fontWeight:"700",padding:"2px 8px",borderRadius:"6px",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:o.get("subText",s),textTransform:"uppercase"},text:{fontSize:t===0?"16px":"18px",color:o.get("mainText",s),fontWeight:"600",margin:0},subtext:{fontSize:t===0?"13px":"15px",color:o.get("subText",s),lineHeight:"1.4",margin:0},icon:{fontSize:"20px",color:o.get("icons",s)},exerciseRow:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",borderRadius:"12px",backgroundColor:s==="light"?"rgba(0,0,0,0.03)":"rgba(255,255,255,0.05)",border:`1px solid ${o.get("border",s)}`},exerciseIcon:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},bigFab:{position:"fixed",bottom:"110px",right:"30px",width:"56px",height:"56px",borderRadius:"28px",backgroundColor:o.get("difficulty",s),border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 20px rgba(0,0,0,0.3)",cursor:"pointer",zIndex:100},miniBtn:{width:"24px",height:"24px",borderRadius:"8px",backgroundColor:o.get("currentDateBorder",s),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},circleBtn:{width:"50px",height:"50px",borderRadius:"25px",backgroundColor:o.get("skipped",s),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},secondaryBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.1)",color:o.get("mainText",s),fontSize:"16px",cursor:"pointer"},dangerBtn:{padding:"10px 20px",borderRadius:"12px",border:"none",backgroundColor:"#ff4d4d",color:"#fff",fontSize:"16px",cursor:"pointer"},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},modalContainer:{width:"99%",maxWidth:"400px",backgroundColor:o.get("background",s),borderRadius:"24px",boxShadow:"0 20px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",alignItems:"center",border:`1px solid ${o.get("border",s)}`,overflow:"hidden"},modalHeader:{width:"100%",padding:"20px",borderBottom:`1px solid ${o.get("border",s)}`,textAlign:"center",marginBottom:"15px"},modalActions:{marginTop:"20px",padding:"15px 20px",width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",borderTop:`1px solid ${o.get("border",s)}`,backgroundColor:s==="light"?"rgba(0,0,0,0.02)":"rgba(255,255,255,0.02)"},segmentedControl:{display:"flex",width:"100%",backgroundColor:s==="light"?"rgba(0,0,0,0.05)":"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"4px",margin:"10px 0"},segment:{flex:1,textAlign:"center",padding:"8px",borderRadius:"10px",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},fullOverlay:{position:"fixed",inset:0,backgroundColor:o.get("background",s),zIndex:6e3},closeOverlayBtn:{position:"fixed",top:"20px",right:"20px",zIndex:6001,width:"40px",height:"40px",borderRadius:"20px",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}});export{pt as default};
