import{A as o,d as q,t as E,f as P,l as L,j as s,O as V,ca as J,C as D,U as K,p as X}from"./index-CFlD75uN.js";import{r as c}from"./recharts-k8ghPecL.js";const Q="https://ultymylife.ru/api/insight",B=["Ð¢Ñ‹ â€” ÑÐ»Ð¸Ñ‚Ð½Ñ‹Ð¹ ÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ñ„Ð¸Ð·Ð¸Ð¾Ð»Ð¾Ð³ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ðº Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð¢Ð²Ð¾Ñ Ñ†ÐµÐ»ÑŒ â€” Ð½Ð°Ð¹Ñ‚Ð¸ ÑÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð²Ð·Ð°Ð¸Ð¼Ð¾ÑÐ²ÑÐ·Ð¸ Ð¼ÐµÐ¶Ð´Ñƒ ÑÐ½Ð¾Ð¼, Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼ Ð¸ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÐµÐ»ÑÐ¼Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ.","You are an elite sports physiologist and data scientist. Your goal is to find hidden correlations between sleep, mental state, and physical performance to optimize the user's productivity."],N=[`Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ Ðº Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ñƒ (ÑÑ‚Ñ€Ð¾Ð³Ð¾ ÑÐ»ÐµÐ´ÑƒÐ¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñƒ):

1) ðŸ“Š **Ð¡Ð¸Ð½Ñ‚ÐµÐ· Ð´Ð°Ð½Ð½Ñ‹Ñ…:** ÐÐµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»Ð¸ Ñ„Ð°ÐºÑ‚Ñ‹, Ð° ÑÐ²ÑÐ¶Ð¸ Ð¸Ñ…. ÐšÐ°Ðº ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ½Ð° (Ð¸Ð»Ð¸ ÐµÐ³Ð¾ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ) Ð¿Ð¾Ð²Ð»Ð¸ÑÐ»Ð¾ Ð½Ð° ÑÐ¸Ð»Ð¾Ð²Ñ‹Ðµ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÐµÐ»Ð¸ Ð¸Ð»Ð¸ Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹? Ð•ÑÑ‚ÑŒ Ð»Ð¸ "Ð¿Ñ€Ð¾Ð²Ð°Ð»ÑŒÐ½Ñ‹Ðµ" Ð´Ð½Ð¸ Ð½ÐµÐ´ÐµÐ»Ð¸?
2) ðŸ’ª **ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¿Ð¾Ð±ÐµÐ´Ñ‹:** ÐÐ°Ð·Ð¾Ð²Ð¸ ÐšÐžÐÐšÐ Ð•Ð¢ÐÐ«Ð• ÑƒÐ¿Ñ€Ð°Ð¶Ð½ÐµÐ½Ð¸Ñ Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¾Ð¼ (Ñ‚Ð¾Ð½Ð½Ð°Ð¶/Ð²ÐµÑ) Ð¸Ð»Ð¸ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸ Ñ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð¸ÑÑ†Ð¸Ð¿Ð»Ð¸Ð½Ð¾Ð¹. Ð’Ñ‹Ð´ÐµÐ»Ð¸ Ð»ÑƒÑ‡ÑˆÐµÐµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð½ÐµÐ´ÐµÐ»Ð¸.
3) âš ï¸ **Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼:** ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð±Ñ‹Ð»Ð¸ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¸? (Ð£ÑÑ‚Ð°Ð»Ð¾ÑÑ‚ÑŒ? Ð›ÐµÐ½ÑŒ? ÐÐµÑ…Ð²Ð°Ñ‚ÐºÐ° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸?). ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ ÑÑ€Ñ‹Ð²Ð¾Ð² (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, "Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¸ Ð²ÑÐµÐ³Ð´Ð° Ð² Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ").
4) ðŸŽ¯ **ÐŸÐ»Ð°Ð½ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ (3 Ð¿ÑƒÐ½ÐºÑ‚Ð°):** Ð”Ð°Ð¹ Ð¼Ð¸ÐºÑ€Ð¾-Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ.
   - ÐÐµ Ð¿Ð¸ÑˆÐ¸ "ÑƒÐ»ÑƒÑ‡ÑˆÐ¸ ÑÐ¾Ð½", Ð¿Ð¸ÑˆÐ¸ "ÑÐ´Ð²Ð¸Ð½ÑŒ Ð¾Ñ‚Ð±Ð¾Ð¹ Ð½Ð° 20 Ð¼Ð¸Ð½ÑƒÑ‚ Ñ€Ð°Ð½ÑŒÑˆÐµ".
   - ÐÐµ Ð¿Ð¸ÑˆÐ¸ "Ñ‚Ñ€ÐµÐ½Ð¸Ñ€ÑƒÐ¹ÑÑ Ð¶ÐµÑÑ‚Ñ‡Ðµ", Ð¿Ð¸ÑˆÐ¸ "Ð´Ð¾Ð±Ð°Ð²ÑŒ 1 Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ð² Ð¾Ñ‚ÑÑ‚Ð°ÑŽÑ‰ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð¶Ð½ÐµÐ½Ð¸Ð¸".
5) Ð¡Ñ‚Ð¸Ð»ÑŒ: Ð¢Ñ€ÐµÐ½ÐµÑ€ÑÐºÐ¸Ð¹, Ð¶ÐµÑÑ‚ÐºÐ¸Ð¹, Ð½Ð¾ Ð¼Ð¾Ñ‚Ð¸Ð²Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹. Ð‘ÐµÐ· Ð²Ð¾Ð´Ñ‹.

Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ:
- ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð¿ÑƒÐ½ÐºÑ‚ Ñ Ð½Ð¾Ð²Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸.
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÐ¼Ð¾Ð´Ð·Ð¸ Ð´Ð»Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹.
- ÐÐ• Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Markdown (Ð¶Ð¸Ñ€Ð½Ñ‹Ð¹ ÑˆÑ€Ð¸Ñ„Ñ‚, ÑÐ¿Ð¸ÑÐºÐ¸), Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ñ‚ÐµÐºÑÑ‚.

Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:`,`Report Requirements (Follow strictly):

1) ðŸ“Š **Data Synthesis:** Don't just list facts; connect them. How did sleep quality impact gym performance or mental focus scores? Are there specific "failure days" in the week?
2) ðŸ’ª **Key Wins:** Mention SPECIFIC exercises with progress (tonnage/weight) or habits with perfect streaks. Highlight the #1 achievement of the week.
3) âš ï¸ **Problem Diagnosis:** Why did skips happen? (Fatigue? Poor scheduling?). Identify the failure pattern (e.g., "always skipping habits on weekends").
4) ðŸŽ¯ **Action Plan (3 items):** Give micro-tasks for next week.
   - Don't say "sleep better", say "shift bedtime 20 mins earlier".
   - Don't say "train harder", say "add 1 set to your weakest lift".
5) Tone: Coach-like, direct, motivating. No fluff.

Formatting:
- Each point on a new line.
- Use emojis for structure.
- DO NOT use Markdown (bold, lists), use plain text only.

Data to analyze:`];function Z(t){const r=n=>{const e=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-e).toISOString().split("T")[0]},l=new Date,a=[];for(let n=6;n>=0;n--){const e=new Date(l);e.setDate(e.getDate()-n),a.push(r(e))}const i=o.pData||{},$=o.habitsByDate||{},w=o.trainingLog||{};o.breathingLog,o.meditationLog,o.hardeningLog;const m=o.sleepingLog||{},x=o.mentalLog||{};o.mentalRecords;const b=o.programs||{},h=o.exercises||{},d=q||{},y=(n,e)=>e.length===0?`${n} (last 7 days):
  No data (User was inactive here)
`:`${n} (last 7 days):
${e.join(`
`)}
`,j=`
USER CONTEXT:
- Profile: ${i.age||"?"} y.o, ${i.gender===0?"Male":"Female"}, Goal: ${i.goal!==void 0?["Mass","Strength","Cut","Health"][i.goal]:"General"}
`.trim(),A=[];a.forEach(n=>{const e=$[n];if(!e)return;const I=(Array.isArray(e)?e:Object.entries(e).map(([u,S])=>({habitId:Number(u),status:S}))).map(u=>{const S=d[u.habitId],k=S?.name?S.name[1]||S.name[0]:`Habit #${u.habitId}`;let f="Skipped";return u.status===-2&&(f="Done"),u.status===1&&(f="Abstained (Success)"),u.status===0&&(f="Failed/Skipped"),`${k}: ${f}`});I.length>0&&A.push(`  ${n}: ${I.join(", ")}`)});const O=y("HABITS",A),v=[];a.forEach(n=>{const e=w[n];!e||!e.length||e.forEach(g=>{const I=b[g.programId],u=I?.name?I.name[1]||`Prog #${g.programId}`:`Prog #${g.programId}`;v.push(`  DATE: ${n} | Program: ${u} | Duration: ${Math.round((g.duration||0)/6e4)} min`),(g.exerciseOrder||[]).forEach(k=>{const f=g.exercises?.[k];if(!f)return;const M=h[k],Y=M?.name?M.name[1]||`Ex #${k}`:`Ex #${k}`;let C=0,R=0;(f.sets||[]).forEach(T=>{T.weight>C&&(C=T.weight),R+=T.reps||0}),v.push(`    - ${Y}: MaxWeight=${C}kg, TotalReps=${R}, Vol=${f.totalTonnage}`)})})});const H=y("GYM_PERFORMANCE",v),z=[];a.forEach(n=>{const e=m[n];if(!e)return;const g=Math.round((e.duration||0)/36e4)/10;z.push(`  ${n}: Sleep=${g}h, Mood=${e.mood}/5, Note="${e.note||""}"`)});const G=y("SLEEP_AND_RECOVERY",z),F=[];a.forEach(n=>{const e=x[n];e&&F.push(`  ${n}: MentalTraining=${Math.round(e/60)} min`)});const W=y("BRAIN_TRAINING",F),U=(B[t]||B[0]).trim(),_=`
${(N[t]||N[0]).trim()}

${j}

${G}
${O}
${H}
${W}

(Analyze the data above looking for patterns between Sleep -> Gym or Habits -> Mood)
`.trim();return{systemPrompt:U,userPrompt:_}}async function tt(t){try{const{systemPrompt:r,userPrompt:l}=Z(t),a=await fetch(Q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:r},{role:"user",content:l}]})});if(!a.ok)throw new Error(`Insight API error: ${a.status}`);return(await a.json()).insight}catch(r){throw console.error("Failed to get insight:",r),r}}const et=()=>{const[t,r]=c.useState(E.value),[l,a]=c.useState(P.value),[i,$]=c.useState(o.prefs[0]),[w,m]=c.useState(""),[x,b]=c.useState(!0);return c.useEffect(()=>{(async()=>{if(o.insightData&&typeof o.insightData=="string"&&o.insightData.length>0){m(o.insightData),b(!1);return}b(!0);try{const d=await tt(i);o.insightData=d,m(d)}catch{m(i===0?"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð½ÑÐ°Ð¹Ñ‚. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.":"Failed to load insight. Please try again.")}finally{b(!1)}})()},[i]),c.useEffect(()=>{const h=E.subscribe(r),d=P.subscribe(a),y=L.subscribe(j=>$(j==="ru"?0:1));return()=>{h.unsubscribe(),d.unsubscribe(),y.unsubscribe()}},[]),s.jsxs("div",{style:p(t).panel,children:[s.jsxs("div",{style:p(t).header,children:[s.jsxs("div",{style:p(t).iconGlowContainer,children:[s.jsx(V,{size:28,color:"#fff",style:{zIndex:2}}),s.jsx(J,{size:14,color:"#00E5FF",style:{position:"absolute",top:"10px",right:"10px",zIndex:2}}),s.jsx("div",{style:p(t).iconGlow})]}),s.jsxs("div",{style:p(t).titleContainer,children:[s.jsx("span",{style:p(t).gradientTitle,children:i===0?"AI ÐÐ½Ð°Ð»Ð¸Ð·":"AI Analysis"}),s.jsx("span",{style:p(t).subtitle,children:i===0?"ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½ÑÐ°Ð¹Ñ‚":"Personal Insight"})]}),s.jsx("img",{src:"images/Mascot_Sits.png",style:{position:"absolute",top:"225px",left:"20px",width:"100px",zIndex:10,filter:"drop-shadow(0 5px 5px rgba(0,0,0,0.3))"},alt:"Mascot"})]}),s.jsx("div",{style:p(t,l).contentBody,children:x?s.jsxs("div",{style:p(t).loadingContainer,children:[s.jsx("div",{className:"spinner",style:p(t).pulseCircle}),s.jsx("span",{style:{opacity:.7,fontSize:"14px"},children:i===0?"ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ð´Ð°Ð½Ð½Ñ‹Ðµ...":"Analyzing data..."})]}):s.jsx("div",{style:p(t).textWrapper,children:w.split(`
`).map((h,d)=>s.jsx("p",{style:{margin:"0 0 12px 0",lineHeight:"1.6"},children:h},d))})}),s.jsx("style",{children:`
                @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
            `})]})},p=(t,r)=>{const l=t==="dark",a="#00E5FF",i="#BF5AF2";return{panel:{display:"flex",flexDirection:"column",width:"95vw",maxWidth:"400px",height:"76vh",marginTop:"20px",borderRadius:"32px",backgroundColor:l?"rgba(30, 30, 35, 0.95)":"rgba(255, 255, 255, 0.95)",border:`1px solid ${l?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}`,boxShadow:`0 20px 50px ${l?"rgba(0,0,0,0.6)":"rgba(0,0,0,0.2)"}, 0 0 30px rgba(0, 229, 255, 0.1)`,overflowY:"hidden"},header:{padding:"30px 24px 20px 24px",display:"flex",flexDirection:"column",alignItems:"center",borderBottom:`1px solid ${D.get("border",t)}50`,background:l?"linear-gradient(180deg, rgba(0, 229, 255, 0.05) 0%, rgba(0,0,0,0) 100%)":"linear-gradient(180deg, rgba(0, 229, 255, 0.05) 0%, rgba(255,255,255,0) 100%)",flexShrink:0},iconGlowContainer:{width:"64px",height:"64px",borderRadius:"20px",backgroundColor:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",marginBottom:"16px",boxShadow:"0 8px 20px rgba(0,0,0,0.2)"},iconGlow:{position:"absolute",inset:0,borderRadius:"20px",background:`linear-gradient(135deg, ${a}, ${i})`,opacity:.8,filter:"blur(15px)",zIndex:0},titleContainer:{textAlign:"center"},gradientTitle:{fontSize:"22px",fontWeight:"800",fontFamily:"Segoe UI, sans-serif",background:`linear-gradient(90deg, ${a} 0%, ${i} 100%)`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",display:"block",marginBottom:"4px"},subtitle:{fontSize:"13px",color:D.get("subText",t),fontWeight:"500",letterSpacing:"0.5px"},contentBody:{flex:1,overflowY:"auto",padding:"24px",fontSize:r===0?"15px":"17px",color:D.get("mainText",t),textAlign:"left",position:"relative"},textWrapper:{animation:"fadeIn 0.5s ease-out"},loadingContainer:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",color:D.get("subText",t)},pulseCircle:{width:"40px",height:"40px",borderRadius:"50%",border:`3px solid ${a}`,borderTopColor:"transparent",animation:"spin 1s linear infinite"}}},it=()=>{const[t,r]=c.useState("dark"),[l,a]=c.useState(o.prefs[0]),[i,$]=c.useState(o.prefs[4]),[w,m]=c.useState(K.hasPremium);return c.useEffect(()=>{const x=E.subscribe(r),b=L.subscribe(a),h=P.subscribe($),d=X.subscribe(m);return()=>{x.unsubscribe(),b.unsubscribe(),h.unsubscribe(),d.unsubscribe()}},[]),s.jsxs("div",{style:st(t).container,children:[s.jsx(et,{}),!w&&s.jsx("div",{style:{width:"100vw",height:"80vh",position:"fixed",zIndex:2555,pointerEvents:"none"},children:s.jsx("div",{onClick:x=>x.stopPropagation(),style:{position:"absolute",inset:0,zIndex:2555,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:E.value==="dark"?"rgba(10, 10, 10, 0.85)":"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(22px)",textAlign:"center"},children:s.jsx("div",{style:{color:E.value==="dark"?"#FFD700":"#D97706",fontSize:"11px",fontWeight:"bold",fontFamily:"Segoe UI"},children:l===0?"Ð¢ÐžÐ›Ð¬ÐšÐž Ð”Ð›Ð¯ ÐŸÐ Ð•ÐœÐ˜Ð£Ðœ":"PREMIUM USERS ONLY"})})})]})},st=(t,r)=>({container:{backgroundColor:D.get("background",t),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"89vh",marginTop:"120px",width:"100vw",fontFamily:"Segoe UI"}});export{it as default};
