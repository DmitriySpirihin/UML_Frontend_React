import{A as D,t as Ne,l as Pe,f as ze,C as f,j as a,bi as ie,bj as Ce,bt as Ie,bk as Je,bu as Qe,bv as Xe,bp as H,bw as Ze,U as et,p as tt,s as nt,bo as st,bx as ot,w as it}from"./index-86lo2Bm1.js";import{r as v,R as rt}from"./recharts-Bg6K2Pzo.js";import{G as at,a as lt}from"./index-Ce0lMzsK.js";import{q as E}from"./MentalHelper-DFV9VSwg.js";import{B as ct}from"./BreathAudio-BrJNN4AB.js";import{M as ut}from"./MentalInput-CBWERfbe.js";function mt(o,e,s){switch(o){case 0:switch(e){case 0:return ae(s);case 1:return le(s);case 2:return ue(s);case 3:return ft(s);case 4:return xt(s);case 5:return gt(s)}break}return[problem,answer.toString()]}const A=(o,e)=>(o=Math.ceil(o),e=Math.floor(e),Math.floor(Math.random()*(e-o+1))+o),ae=o=>{let e;o>=16?e=3:o>=11?e=2:o>=6?e=1:e=0;const r=[{minA:3,maxA:10,minB:2,maxB:8,minC:2,maxC:6,maxResult:20,avoidTrivial:!0,threeNums:!1},{minA:8,maxA:18,minB:5,maxB:14,minC:4,maxC:10,maxResult:35,avoidTrivial:!0,threeNums:!1},{minA:14,maxA:30,minB:8,maxB:22,minC:6,maxC:15,maxResult:55,avoidTrivial:!1,threeNums:!1},{minA:18,maxA:40,minB:10,maxB:30,minC:8,maxC:25,maxResult:100,avoidTrivial:!1,threeNums:!0}][e],m=i=>i==="+"?"+":"‚Äì";if(r.threeNums){let i,h,c,d,w,M,y,$=0;do if($++,i=A(r.minA,r.maxA),h=A(r.minB,r.maxB),c=A(r.minC,r.maxC),d=Math.random()<.6?"+":"-",w=Math.random()<.6?"+":"-",M=d==="+"?i+h:i-h,!(M<0)&&(y=w==="+"?M+c:M-c,!(y<0||y>r.maxResult)&&!(e>=2&&(h<=3||c<=3))))break;while($<50);return[`${i} ${m(d)} ${h} ${m(w)} ${c}`,y.toString()]}let t,u,n,l,p=0;do if(p++,t=A(r.minA,r.maxA),u=A(r.minB,r.maxB),n=Math.random()<.55?"+":"-",!(n==="-"&&(t<u&&([t,u]=[u,t]),t===u))&&(l=n==="+"?t+u:t-u,!(l<0||l>r.maxResult)&&!(r.avoidTrivial&&(t<=4||u<=4||l<=4)&&p<25)))break;while(p<40);return[`${t} ${m(n)} ${u}`,l.toString()]},le=o=>{const e=Math.min(4,Math.floor(o/5)),s=[{minA:2,maxA:15,minB:2,maxB:12,minRes:5,maxRes:100,allowSimpleAddSub:!0},{minA:6,maxA:30,minB:3,maxB:20,minRes:10,maxRes:300,allowSimpleAddSub:!0},{minA:25,maxA:80,minB:6,maxB:40,minRes:25,maxRes:1e3,allowSimpleAddSub:!1},{minA:40,maxA:130,minB:8,maxB:60,minRes:40,maxRes:2500,allowSimpleAddSub:!1},{minA:60,maxA:200,minB:10,maxB:90,minRes:60,maxRes:6e3,allowSimpleAddSub:!1}][e],{minA:r,maxA:m,minB:t,maxB:u,minRes:n,maxRes:l,allowSimpleAddSub:p}=s,i=(y,$)=>Math.floor(Math.random()*($-y+1))+y,h=(y,$,j)=>{const S=[];for(let x=$;x<=j&&x<=y;x++)y%x===0&&S.push(x);return S};let c,d;const w=100;if(e>=3?Math.random()<.85:e>=2?Math.random()<.6:e>=1?Math.random()<.2:!1){let y=0;for(;y++<w;){const $=["+","-","√ó","√∑"],j=$[i(0,3)],S=$[i(0,3)];let x,b,g,T=0,R=!1;for(;!R&&T++<30;)if(x=i(e>=2?30:r,e>=4?250:Math.min(180,m*2)),b=i(e>=2?8:t,e>=3?80:Math.min(70,u*2)),!(x<10||b<10)){if(j==="√∑"){if(b===0)continue;const P=i(e>=2?5:2,Math.min(40,Math.floor(l/b)));x=b*P,g=x/b}else if(j==="√ó")g=x*b;else if(j==="+")g=x+b;else if(j==="-"){if(x<=b)continue;g=x-b}Number.isInteger(g)&&g>=15&&g<=l*.8&&(R=!0)}if(!R)continue;let I,z,V=!1;if(S==="√∑"){const P=h(g,e>=2?6:2,e>=3?90:u);if(P.length===0)continue;I=P[i(0,P.length-1)],z=g/I,V=!0}else if(S==="√ó")I=i(e>=2?6:t,e>=3?80:Math.min(60,u*2)),z=g*I,V=!0;else if(S==="+")I=i(e>=2?25:t,e>=3?120:Math.min(100,u*2)),z=g+I,V=!0;else if(S==="-"){if(g<=n)continue;const P=Math.min(u*2,g-n);if(P<(e>=2?20:t))continue;I=i(e>=2?20:t,P),z=g-I,V=!0}if(V&&z>=n&&z<=l&&Number.isInteger(z)){c=`(${x} ${j==="√ó"?"√ó":j==="√∑"?"√∑":j} ${b}) ${S==="√ó"?"√ó":S==="√∑"?"√∑":S} ${I}`,d=z.toString();break}}}if(!c){let y=0;for(;y++<w;){let $;e===0?$=["add2","sub2","mul","div"][i(0,3)]:e===1?$=["add2","sub2","mul","div","mul"][i(0,4)]:$=["mul","div","add3","sub3","mul","div"][i(0,5)];let j,S;if($==="div"){const x=i(e>=2?6:2,e>=3?80:u),b=i(e>=2?6:2,Math.min(50,Math.floor(l/x))),g=x*b;if(g>l*2)continue;j=`${g} √∑ ${x}`,S=b}else if($==="mul"){const x=i(e>=2?20:r,e>=4?220:Math.min(180,m*2)),b=i(e>=2?6:t,e>=3?85:Math.min(70,u*2)),g=x*b;if(g>l)continue;j=`${x} √ó ${b}`,S=g}else if($==="add2"&&p){const x=i(r,m),b=i(t,u),g=x+b;if(g>l)continue;j=`${x} + ${b}`,S=g}else if($==="sub2"&&p){const x=i(Math.max(r,20),m),b=i(t,Math.min(u,x-Math.max(5,n/2)));if(x<=b)continue;const g=x-b;if(g<n)continue;j=`${x} - ${b}`,S=g}else if($==="add3"||$==="sub3"){const x=i(e>=2?60:30,e>=4?250:180),b=i(e>=2?30:20,e>=3?120:100),g=i(e>=2?20:15,e>=3?100:80);let T,R;if($==="add3")if(Math.random()<.7)T=`${x} + ${b} + ${g}`,R=x+b+g;else if(x+b>g&&x+b-g>=n)T=`${x} + ${b} - ${g}`,R=x+b-g;else continue;else{if(x<=b)continue;const I=x-b;if(Math.random()<.6)T=`${x} - ${b} + ${g}`,R=I+g;else if(I>g&&I-g>=n)T=`${x} - ${b} - ${g}`,R=I-g;else continue}if(R>=n&&R<=l)j=T,S=R;else continue}else continue;if(S>=n&&S<=l&&Number.isInteger(S)){c=j,d=S.toString();break}}}if(!c||!d){const y=[["12 + 15","27"],["84 √∑ 7","12"],["120 + 45 - 28","137"],["(180 √∑ 6) + 75","105"],["250 - 90 + 36","196"]];return y[e]||y[2]}return[c,d]},dt={0:"‚Å∞",1:"¬π",2:"¬≤",3:"¬≥",4:"‚Å¥",5:"‚Åµ",6:"‚Å∂",7:"‚Å∑",8:"‚Å∏",9:"‚Åπ"},ce=o=>String(o).split("").map(e=>dt[e]).join(""),ue=o=>{const e=Math.min(Math.floor(o/5),3),r=[{minNum:6,maxNum:25,maxRoot:12,allowPower:!0,forceCombo:!0},{minNum:8,maxNum:35,maxRoot:15,allowPower:!0,forceCombo:!0},{minNum:10,maxNum:50,maxRoot:18,allowPower:!0,forceCombo:!0},{minNum:12,maxNum:70,maxRoot:20,allowPower:!0,forceCombo:!0}][e],m=()=>{const n=A(1,r.allowPower?3:2);if(n===1){let l=A(r.minNum,r.maxNum);return{expr:l.toString(),value:l}}else if(n===2){const l=A(5,r.maxRoot);return{expr:`‚àö${l*l}`,value:l}}else if(n===3){const l=A(3,Math.min(12,r.maxNum)),p=Math.random()<.75?2:3,i=Math.pow(l,p);return i>800||i<9?m():{expr:`${l}${ce(p)}`,value:i}}},t=(n,l)=>{const p=["+","‚àí","√ó"];if(l.value!==0&&n.value%l.value===0){const d=n.value/l.value;Number.isInteger(d)&&d>=2&&d<=50&&p.push("√∑")}const i=p[A(0,p.length-1)];let h,c;switch(i){case"+":h=n.value+l.value;break;case"‚àí":h=n.value-l.value;break;case"√ó":h=n.value*l.value;break;case"√∑":h=n.value/l.value;break}return!Number.isInteger(h)||h<=0||h>=1e4?null:(`${n.expr}${i}${l.expr}`,`${n.expr}${i}${l.expr}`,`${n.expr}${i}${l.expr}`,i==="√ó"||i==="√∑"?c=`${n.expr} ${i} ${l.expr}`:c=`${n.expr} ${i} ${l.expr}`,{expr:c,value:h})},u=()=>{let n=0;for(;n<15;){const i=m(),h=m(),c=t(i,h);if(c)return c;n++}const l=A(12,30),p=A(3,8);return{expr:`${l} √ó ${p} + ‚àö100`,value:l*p+10}};for(let n=0;n<25;n++){const{expr:l,value:p}=u();if(p<=0||p>=1e4||!Number.isInteger(p))continue;const i=l.includes("‚àö")||l.includes("¬≤")||l.includes("¬≥"),h=(l.includes("√ó")||l.includes("√∑"))&&l.match(/\d+/g)?.some(c=>parseInt(c)>20);if(i||h||l.includes("("))return[l,p.toString()];if(!i){const c=l.match(/\d+/g)?.map(Number)||[];if(/^[0-9]+ [+\‚àí] [0-9]+$/.test(l)&&c.every(w=>w<=25))continue;return[l,p.toString()]}}return["8¬≤ + ‚àö196","78"]},Te="‚àí",Re={2:[[4,2],[8,3],[16,4],[32,5],[64,6],[128,7],[256,8],[512,9],[1024,10],[2048,11],[4096,12]],3:[[9,2],[27,3],[81,4],[243,5],[729,6],[2187,7],[6561,8]],5:[[25,2],[125,3],[625,4],[3125,5]],10:[[100,2],[1e3,3],[1e4,4]]},ft=o=>{const e=Math.min(Math.floor(o/5),5),s={minVal:[8,12,18,25,35,50][e],maxVal:[40,70,120,200,300,500][e],maxPower:[3,4,5,5,6,6][e],maxRoot:[15,25,35,50,70,100][e],allowLog:e>=2,allowDeepNest:e>=3},r=(m=0)=>{const t=A(1,s.allowLog?4:3);let u,n;if(t===1)n=A(s.minVal,s.maxVal),m>0&&Math.random()<.2&&(n*=-1),u=n.toString();else if(t===2){const M=A(2,Math.min(15,s.maxVal)),y=A(2,s.maxPower);if(n=Math.pow(M,y),n>=1e4||!Number.isInteger(n))return r(m);u=`${M}${ce(y)}`}else if(t===3){const M=A(5,s.maxRoot);n=M,u=`‚àö${M*M}`}else if(t===4&&s.allowLog){const M=Object.keys(Re).map(Number),y=M[A(0,M.length-1)],$=Re[y].filter(([x])=>x<1e4);if($.length===0)return r(m);const[j,S]=$[A(0,$.length-1)];n=S,u=y===10?`log‚ÇÅ‚ÇÄ(${j})`:`log‚ÇÇ(${j})`.replace("2",y.toString()),y!==10&&y!==2&&(u=`log${y}(${j})`)}if(m>=(s.allowDeepNest?2:1)||Math.random()<.4)return{expr:u,value:n};const l=r(m+1),p=n,i=l.value,h=["+",Te,"√ó"];if(i!==0&&p%i===0){const M=p/i;Number.isInteger(M)&&Math.abs(M)<1e4&&h.push("√∑")}if(h.length===0)return{expr:u,value:n};const c=h[A(0,h.length-1)];let d,w;switch(c){case"+":d=p+i;break;case Te:d=p-i;break;case"√ó":d=p*i;break;case"√∑":d=p/i;break}return!Number.isInteger(d)||Math.abs(d)>=1e4?{expr:u,value:n}:(w=`(${u} ${c} ${l.expr})`,{expr:w,value:d})};for(let m=0;m<50;m++){const{expr:t,value:u}=r(0);if(Number.isInteger(u)&&u>0&&u<1e4&&(t.includes("√ó")||t.includes("√∑")||t.includes("‚àö")||t.includes("log")||t.includes("¬≤")||t.includes("¬≥"))){let n=t;if(n.startsWith("(")&&n.endsWith(")")){let i=0,h=!0;for(let c=0;c<n.length-1;c++)if(n[c]==="("?i++:n[c]===")"&&i--,i===0){h=!1;break}h&&(n=n.slice(1,-1))}const l=(n.match(/‚àö/g)||[]).length+(n.match(/log/g)||[]).length+(n.match(/[¬≤¬≥‚Å¥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ]/g)||[]).length,p=n.includes("(")||n.includes("√ó")||n.includes("√∑");if(l>=2||l===1&&p)return[n,u.toString()]}}return["(‚àö4096 + 6¬≥) √∑ log‚ÇÇ(64)","10"]},xt=o=>{const e=Math.floor(o/10),s=Math.min(e,5);if(s===0){const r=Math.min(o,15);return ae(r)}else if(s===1){const r=5+(o-10);return le(r)}else if(s===2){const r=10+(o-20);return ue(r)}else return pt(s)},pt=(o,e)=>{const s=(i,h)=>Math.floor(Math.random()*(h-i+1))+i,r=20+o*15,m=100+o*50,t=5e3+o*2e3;let u,n;const l=0,p=80;for(;l<p;){const i=Math.random()<.4,h=Math.random()<.7;let c,d,w,M,y,$;if(i){const S=Math.random()<.5?(()=>{const T=s(4,Math.min(15,m/10)),R=Math.random()<.8?2:3,I=Math.pow(T,R);return{expr:`${T}${ce(R)}`,value:I}})():(()=>{const T=s(6,Math.min(25,Math.sqrt(m*3)));return{expr:`‚àö${T*T}`,value:T}})(),x=s(r,m),b=["+","‚àí","√ó"][s(0,2)];let g;if(b==="+"?g=S.value+x:b==="‚àí"?g=S.value-x:g=S.value*x,g<=0||g>t)continue;if(Math.random()<.5){const T=s(10,m/2),R=["+","‚àí"][s(0,1)];if(R==="+")y=g+T;else{if(g<=T)continue;y=g-T}if(y<=0||y>t)continue;$=`${S.expr} ${b} ${x} ${R} ${T}`}else y=g,$=`${S.expr} ${b} ${x}`;if(Number.isInteger(y)){u=$,n=y.toString();break}}else if(h){c=s(r,m),d=s(10,Math.min(80,c)),w=s(10,Math.min(100,m));const j=["+","‚àí","√ó"][s(0,2)];if(j==="‚àí"&&c<=d||(M=j==="+"?c+d:j==="‚àí"?c-d:c*d,M<=0||M>t*.9))continue;const S=["+","‚àí","√ó"][s(0,2)];if(S==="‚àí"&&M<=w||S==="√ó"&&M*w>t||(y=S==="+"?M+w:S==="‚àí"?M-w:M*w,y<=0||y>t))continue;$=`(${c} ${j==="√ó"?"√ó":j} ${d}) ${S==="√ó"?"√ó":S} ${w}`,u=$,n=y.toString();break}else{c=s(r,m),d=s(20,m/2),w=s(15,m/3);const j=[[c+d+w,`${c} + ${d} + ${w}`],[c+d-w,`${c} + ${d} - ${w}`],[c-d+w,`${c} - ${d} + ${w}`],[c*d+w,`${c} √ó ${d} + ${w}`],[c*d-w,`${c} √ó ${d} - ${w}`]].filter(([b])=>b>0&&b<=t&&Number.isInteger(b));if(j.length===0)continue;const[S,x]=j[s(0,j.length-1)];u=x,n=S.toString();break}}if(!u||!n){const i=[["15¬≤ ‚àí ‚àö225","210"],["(200 √∑ 8) √ó 12","300"],["180 + 7¬≤ ‚àí 45","184"],["(‚àö400 + 30) √ó 4","200"]];return i[Math.min(o-3,i.length-1)]||i[0]}return[u,n]},gt=o=>{const e=Math.min(Math.floor(o/15),4),s=[{type:"easy",stageMap:Math.min(o,8)},{type:"easy",stageMap:9+Math.min(o-15,6)},{type:"medium",stageMap:5+Math.min(o-30,9)},{type:"medium",stageMap:15+Math.min(o-45,10)},{type:"hard-relaxed",stageMap:12+Math.min(o-60,12)}][e];if(s.type==="easy")return ae(s.stageMap);if(s.type==="medium")return le(s.stageMap);{let r=0;for(;r<20;){const[t,u]=ue(s.stageMap),n=(t.match(/\d+/g)||[]).length,l=t.includes("‚àö")||t.includes("¬≤")||t.includes("¬≥");if(n<=3&&!t.includes("((")&&(l||t.split(/[+\‚àí√ó√∑]/).length<=3))return[t,u];r++}const m=[["12¬≤","144"],["‚àö225 + 18","33"],["(40 + 25) ‚àí 10","55"],["16 √ó 6 + 4","100"],["9¬≤ ‚àí ‚àö81","72"]];return m[Math.min(e-3,m.length-1)]||m[0]}};function ht(o,e,s,r,m,t,u){const l=[100,200,300,400,50,5][e]||100;let p=0;if(o===0){const M=Number(t),y=Number(m);p=Math.abs(y-M)/y}const i=p===0?1:p<.15?.5:0,h=Math.min(1+s*.02,1.3),c=Math.min(r/1e4,2),d=i===1?Math.max(1.3-(c-1)*.3,1):1,w=u>=5&&i===1?Math.min(1+.1*Math.min(u/10,4),1.5):1;return Math.round(l*i*h*d*w)}function bt(o,e,s){if(o===0){const r=Number(s),m=Number(e);if(r===m)return!0}return!1}function yt(o,e,s){if(o===0){const r=Number(s),m=Number(e);return Math.abs(m-r)/m}return 0}const ke=3e3,St=({show:o,type:e,difficulty:s,maxTimer:r,setShow:m})=>{const[t,u]=v.useState("dark"),[n,l]=v.useState(D.prefs[0]),[p,i]=v.useState(D.prefs[4]),[h,c]=v.useState(""),[d,w]=v.useState(""),[M,y]=v.useState(!1),[$,j]=v.useState(!1),[S,x]=v.useState(!1),[b,g]=v.useState(0),[T,R]=v.useState(0),[I,z]=v.useState(!1),[V,P]=v.useState(!1),[De,me]=v.useState(0),{initAudio:Ee,playRight:We,playWrong:Le}=ct(D.prefs[2]===0),[de,F]=v.useState(!1),[fe,Q]=v.useState(0),[U,X]=v.useState(0),[Ve,xe]=v.useState(0),[K,pe]=v.useState(!1),[W,Z]=v.useState(0),[O,ee]=v.useState(1),[ge,he]=v.useState(0),[Fe,Oe]=v.useState(""),[q,Ge]=v.useState(""),[be,te]=v.useState(""),[Ye,qe]=v.useState(""),[G,ye]=v.useState(0),[ne,se]=v.useState(0),[_,_e]=v.useState(D.mentalRecords[e][s]),[Se,ve]=v.useState(0);v.useEffect(()=>{h.length===1?w(C=>C.length<6?C+h:C):h.length===2?w(C=>C.length>0?C.slice(0,C.length-1):""):h.length===3&&we(),c("")},[h]),v.useEffect(()=>{let C=null;return M&&(C=setInterval(()=>{ve(k=>k+100)},100)),()=>{C&&clearInterval(C)}},[M]),v.useEffect(()=>{if(!de||!$||s===5){Q(0),X(0);return}const C=Date.now()-U,k=setInterval(()=>{const N=Date.now()-C,B=Math.min(N,r);X(B),Q(B/(r-b)*100),B>=r-b-500&&(F(!1),we())},50);return()=>clearInterval(k)},[de,$,r,U]),v.useEffect(()=>{const C=Ne.subscribe(u),k=Pe.subscribe(B=>{l(B==="ru"?0:1)}),N=ze.subscribe(B=>{i(B)});return()=>{C.unsubscribe(),k.unsubscribe(),N.unsubscribe()}},[]),v.useEffect(()=>{if(!S){R(0);return}const C=Math.ceil(ke/1e3);R(C);const k=setInterval(()=>{R(N=>N<=1?(clearInterval(k),He(),x(!1),0):N-1)},1e3);return()=>{clearInterval(k)}},[S,ke]),v.useEffect(()=>{if(!K)return;const C=setInterval(()=>{xe(k=>k>=900?(clearInterval(C),pe(!1),Z(N=>N+G/2),ye(0),F(!0),xe(0),0):k+100)},100);return()=>{clearInterval(C)}},[K,Ve]);const He=()=>{Ee(),oe(),j(!0),F(!0),y(!0),P(!1),ve(0),me(Date.now())};function oe(){const C=mt(e,s,O);Oe(C[0]),Ge(C[1])}const we=()=>{F(!1);const C=ht(e,s,O,U,q,d,ge),k=yt(e,q,d);$t(k===0?"light":"medium");let N="";k===0?(N=jt(n),se(L=>L+1)):k<.15?N=Ct(n):N=n===0?"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: "+q:"Correct answer: "+q;const B=k===0?f.get("maxValColor",t):k<.15?f.get("difficulty2",t):f.get("minValColor",t);qe(B),te(N),ye(C),oe(),w(""),he(L=>bt(e,q,d)?L+1:0),ee(L=>L+1<20?L+1:20),k===0?We():Le(),O===20&&Me(),s===4&&O%5===0&&g(L=>L+2e3),s===4&&k>.15&&Me(),pe(!0)},Ue=()=>{y(!1),P(!0)},Ke=()=>{y(!0),P(!1)},$e=()=>{F(!1),X(0),Q(0),Z(0),ee(1),se(0),he(0),w(""),te(""),g(0),oe(),me(Date.now()),F(!0)},Me=()=>{const C=Date.now(),k=Math.round((C-De)/1e3);saveSessionDuration(k);const N=wt(s===4,s===5,n,W+G,ne,20,!1);y(!1),te(N),z(!0),j(!1),F(!1)},je=()=>{W>_&&(_e(W),D.mentalRecords[e][s]=W),Z(0),g(0),ee(1),se(0),z(!1),m(!1)};return a.jsxs("div",{style:J(t,o).container,children:[!$&&!S&&!I&&a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",width:"100%",height:"80%"},children:[a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:f.get("mainText",t)},children:E[s].level[n]}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"15px",color:f.get("subText",t)},children:E[s].description[n]}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"15px",color:f.get("mainText",t)},children:(n===0?"–°–ª–æ–∂–Ω–æ—Å—Ç—å: ":"Difficulty: ")+E[s].difficulty[n]}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"15px",color:f.get("subText",t)},children:(n===0?"–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏: ":"Time limit: ")+E[s].timeLimitSec}),a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:"20px",fontSize:"15px",color:f.get("subText",t)},children:(n===0?"–û–ø–µ—Ä–∞—Ü–∏–∏: ":"Operations: ")+E[s].operations}),a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:"50px",fontSize:"12px",color:f.get("subText",t)},children:vt(n)})]}),!$&&!S&&!I&&a.jsxs("div",{style:J(t,o).controls,children:[a.jsx(ie,{onClick:()=>je(),style:{fontSize:"60px",color:f.get("close",t)}}),a.jsx(Ce,{onClick:()=>x(!0),style:{fontSize:"60px",color:f.get("play",t)}}),a.jsx(Ie,{onClick:$e,style:{fontSize:"60px",color:f.get("reload",t)}})]}),!I&&S&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around",width:"90%",height:"80%"},children:[a.jsx("div",{style:{fontSize:"10rem",marginTop:"180px",color:f.get("icons",t),fontWeight:"bold",lineHeight:1},children:T}),a.jsx("div",{style:{fontSize:"2rem",marginBottom:"80px",textAlign:"center"},children:a.jsx("div",{style:{color:f.get("icons",t),marginBottom:"80px"},children:n===0?"–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å!":"Get ready!"})})]}),!I&&$&&a.jsxs("div",{style:J(t).playContainer,children:[a.jsxs("div",{style:{display:"flex",flexDirection:"row",width:"86%",borderBottom:`1px solid ${f.get("border",t)}`},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"row",marginTop:"6px",width:"60%",gap:"20px",marginRight:"auto"},children:[a.jsx(ie,{onClick:()=>j(!1),style:{fontSize:"25px",color:f.get("close",t)}}),V?a.jsx(Ce,{onClick:Ke,style:{fontSize:"25px",color:f.get("play",t)}}):a.jsx(Je,{onClick:Ue,style:{fontSize:"25px",color:f.get("pause",t)}}),a.jsx(Ie,{onClick:$e,style:{fontSize:"25px",color:f.get("reload",t)}})]}),a.jsxs("div",{style:{display:"flex",marginLeft:"auto",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",color:f.get("subText",t)},children:[a.jsx(Qe,{}),Be(Se)]})]}),a.jsxs("div",{style:{display:"flex",width:"86%",flexDirection:"row",marginTop:"20px",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",color:f.get("minValColor",t)},children:[a.jsx(Xe,{}),ge]}),a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",color:f.get("difficulty",t)},children:s>3?O:O+"/ 20"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",color:f.get("maxValColor",t)},children:[a.jsx(H,{}),W]})]}),a.jsxs("div",{style:{width:"86%",height:"18px",position:"relative",marginTop:"66px"},children:[a.jsxs("svg",{width:"100%",height:"18",viewBox:"0 0 100 18",preserveAspectRatio:"none",style:{display:"block"},children:[a.jsx("rect",{x:"0",y:"0",width:"100",height:"18",fill:f.get("bottomPanel",t)}),a.jsx("rect",{x:"0",y:"0",width:fe,height:"18",fill:Mt(f.get("done",t),f.get("skipped",t),fe/100)})]}),a.jsx("div",{style:{position:"relative",top:"-20px",color:f.get("subText",t),marginBottom:"80px"},children:Math.floor((r-b-U)/1e3)})]}),a.jsxs("div",{children:[!K&&a.jsx("div",{style:Ae(t,!1),children:Fe}),K&&a.jsxs("div",{style:Ae(t,!0,Ye),children:[a.jsxs("p",{style:{fontSize:"22px",fontWeight:"bold",color:G>0?f.get("maxValColor",t):f.get("minValColor",t)},children:[G>0&&a.jsx(H,{}),G>0?G:n===0?"–Ω–µ –≤–µ—Ä–Ω–æ":"wrong answer"]}),a.jsx("p",{style:{fontSize:"16px",fontWeight:"bold",color:f.get("mainText",t)},children:be})]})]}),a.jsx("div",{style:{fontSize:"34px",fontWeight:"bold",color:f.get("subText",t),marginTop:"auto"},children:d})]}),!I&&$&&a.jsx(ut,{setInput:c,type:e}),I&&a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",width:"100%",height:"80%"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"28px",fontWeight:"bold",color:f.get("maxValColor",t)},children:[a.jsx(H,{}),W]}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:f.get("medium",t)},children:It(n,Se)}),W>_&&a.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"28px",fontWeight:"bold",color:f.get("medium",t)},children:[a.jsx(Ze,{}),n===0?"–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!":"New record!"]}),W<=_&&a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"28px",fontWeight:"bold",color:f.get("subText",t)},children:n===0?"—Ä–µ–∫–æ—Ä–¥: "+_:"record: "+_}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"22px",fontWeight:"bold",color:f.get("mainText",t)},children:s<4?ne+" / 20":ne}),a.jsx("div",{style:{display:"flex",alignItems:"center",marginTop:"20px",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:f.get("mainText",t)},children:be})]}),I&&a.jsx("div",{style:J(t,o).controls,children:a.jsx(ie,{onClick:()=>{je()},style:{fontSize:"60px",color:f.get("close",t)}})})]})},Ae=(o,e,s)=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"95vw",height:"16vh",marginTop:"20px",backgroundColor:f.get("bottomPanel",o),boxShadow:e?"0px 0px 9px 9px"+s:"2px 2px"+f.get("shadow",o),borderRadius:"24px",fontSize:"39px",fontWeight:"bold",color:f.get("mainText",o),alignContent:"center"}),J=(o,e)=>({container:{backgroundColor:f.get("background",o),display:"flex",position:"fixed",flexDirection:"column",alignItems:"center",height:"86vh",transform:e?"translateY(0)":"translateY(100%)",bottom:"0",transition:"transform 0.2s ease-in-out",width:"100vw",fontFamily:"Segoe UI",borderTop:`2px solid ${f.get("border",o)}`,borderTopLeftRadius:"12px",borderTopRightRadius:"12px",zIndex:2e3},controls:{display:"flex",marginTop:"30px",gap:"50px"},playContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",height:"50vh",bottom:"0",width:"100vw"}}),vt=o=>o===0?"–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –æ—á–∫–æ–≤, –æ—Ç–≤–µ—á–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ. –ö–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª—å. –ó–∞ –∫–∞–∂–¥—ã–µ 5 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–¥—Ä—è–¥ –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ–≤—ã—à–∞–µ—Ç—Å—è, –¥–æ—Å—Ç–∏–≥–∞—è –º–∞–∫—Å–∏–º—É–º–∞ √ó1.5.":"To earn more points, answer correctly and as quickly as possible. Every mistake resets your multiplier. For every 5 correct answers in a row, your multiplier increases‚Äîup to a maximum of √ó1.5.",wt=(o,e,s,r,m,t,u=!1)=>{const n=m>0?Math.round(r/m*100):0,l={ru:{record:[`üèÜüî• –ù–û–í–´–ô –†–ï–ö–û–†–î! ${s} –æ—á–∫–æ–≤ ‚Äî –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!`,`üéâ‚ú® –¢—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª(–∞) –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥: ${r}/${m} (${n}%)!`,"üåüüí• –î–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–æ —Ç—Ä—É–¥–Ω–æ ‚Äî —Ç—ã –ø–æ–±–∏–ª(–∞) —Ä–µ–∫–æ—Ä–¥! –ú–æ–ª–æ–¥–µ—Ü!"],endless_record:[`üèÜüî• –ù–û–í–´–ô –†–ï–ö–û–†–î –í –†–ï–ñ–ò–ú–ï –í–´–ñ–ò–í–ê–ù–ò–Ø: ${r} —Ä–∞—É–Ω–¥–æ–≤!`,`üéâ‚ú® –¢—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª(–∞) –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥: ${r} –±–µ–∑ –µ–¥–∏–Ω–æ–π –æ—à–∏–±–∫–∏!`,"üåüüí• –í Endless-—Ä–µ–∂–∏–º–µ ‚Äî –∞ —Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–±–∏–ª(–∞) —Ä–µ–∫–æ—Ä–¥! –ú–æ–ª–æ–¥–µ—Ü!",`üõ°Ô∏èüëë –ù–æ–≤—ã–π –º–∞–∫—Å–∏–º—É–º: ${s} –æ—á–∫–æ–≤ –≤ —Ä–µ–∂–∏–º–µ "–æ–¥–Ω–∞ –æ—à–∏–±–∫–∞ ‚Äî –∫–æ–Ω–µ—Ü"!`],relax_record:["üåü –ù–æ–≤—ã–π –ª–∏—á–Ω—ã–π –º–∞–∫—Å–∏–º—É–º ‚Äî –¥–∞–∂–µ –≤ —Å–ø–æ–∫–æ–π–Ω–æ–º —Ä–µ–∂–∏–º–µ!",`üßò‚Äç‚ôÇÔ∏èüèÜ –¢—ã –Ω–∞–±—Ä–∞–ª(–∞) ${s} –æ—á–∫–æ–≤ –≤ Relax-—Ä–µ–∂–∏–º–µ ‚Äî –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!`,"üí´ –î–∞–∂–µ –±–µ–∑ —Ç–∞–π–º–µ—Ä–∞ ‚Äî —Ç—ã —É–ª—É—á—à–∏–ª(–∞) —Å–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –†–µ—Å–ø–µ–∫—Ç!"]},en:{record:[`üèÜüî• NEW RECORD! ${s} points ‚Äî congratulations!`,`üéâ‚ú® You set a personal best: ${r}/${m} (${n}%)!`,"üåüüí• Even on a tough day ‚Äî you broke your record! Amazing!"],endless_record:[`üèÜüî• NEW ENDLESS MODE RECORD: ${r} rounds!`,`üéâ‚ú® Personal best: ${r} flawless answers in a row!`,"üåüüí• You broke your record ‚Äî in Endless Mode! Amazing!",`üõ°Ô∏èüëë New high: ${s} points in "one mistake = game over" mode!`],relax_record:["üåü New personal best ‚Äî even in Relax Mode!",`üßò‚Äç‚ôÇÔ∏èüèÜ You scored ${s} points in Relax Mode ‚Äî congrats!`,"üí´ No timer, no stress ‚Äî and still a new record! Amazing!"]}},p=e===0?l.ru:l.en;let i=[];if(u?i=[...p.relax_record]:o?i=[...p.endless_record]:i=[...p.record],i.length===0)return e===0?"–•–æ—Ä–æ—à–æ! üòä":"Good job! üòä";const h=Math.floor(Math.random()*i.length);return i[h]};function $t(o){D.prefs[3]==0&&Telegram.WebApp.HapticFeedback&&Telegram.WebApp.HapticFeedback.impactOccurred(o)}function Mt(o,e,s){if(!o||!e)return o||e||"#000000";s=Math.max(0,Math.min(1,s)),o=o.replace("#",""),e=e.replace("#","");const r=parseInt(o.slice(0,2),16),m=parseInt(o.slice(2,4),16),t=parseInt(o.slice(4,6),16),u=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16),p=Math.round(r+(u-r)*s),i=Math.round(m+(n-m)*s),h=Math.round(t+(l-t)*s);return`rgb(${p}, ${i}, ${h})`}function jt(o){const r=o===0?["–û—Ç–ª–∏—á–Ω–æ!","–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ!","–í–µ—Ä–Ω–æ!","–¢–æ—á–Ω–æ!","–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ!","–ò–¥–µ–∞–ª—å–Ω–æ!","–ü—Ä–∞–≤–∏–ª—å–Ω–æ!","–ú–æ–ª–æ–¥–µ—Ü!","–¢–æ—á–Ω–æ –≤ —Ü–µ–ª—å!","–ë–µ–∑ –æ—à–∏–±–æ–∫!"]:["Great!","Perfect!","Yes!","Exactly!","Awesome!","Brilliant!","Spot on!","Well done!","Nailed it!","Correct!"];return r[Math.floor(Math.random()*r.length)]}function Ct(o){const r=o===0?["–†—è–¥–æ–º!","–ü–æ—á—Ç–∏!","–ï—â–µ —á—É—Ç—å-—á—É—Ç—å!","–ü—Ä–æ–¥–æ–ª–∂–∞–π!","–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ!","–û—á–µ–Ω—å –±–ª–∏–∑–∫–æ!","–•–æ—Ä–æ—à–∞—è –ø–æ–ø—ã—Ç–∫–∞!","–ù–µ —Å–æ–≤—Å–µ–º‚Ä¶","–ü–æ—á—Ç–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å!","–¢—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏!"]:["Close!","Almost!","Nearly!","Keep going!","Try again!","So close!","Good attempt!","Not quite!","One more try!","You're getting there!"];return r[Math.floor(Math.random()*r.length)]}function Be(o){const e=Math.floor(o/1e3),s=Math.floor(e/60),r=e%60;return`${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function It(o,e){const s=Be(e);return o===0?`–í–∞—à–µ –≤—Ä–µ–º—è: ${s}`:`Your time is: ${s}`}const zt=()=>{const[o,e]=rt.useState("dark"),[s,r]=v.useState(D.prefs[0]),[m,t]=v.useState(D.prefs[4]),[u,n]=v.useState(!1),[l,p]=v.useState(0),[i,h]=v.useState(et.hasPremium);return v.useEffect(()=>{const c=tt.subscribe(h);return()=>c.unsubscribe()},[]),v.useEffect(()=>{const c=Ne.subscribe(e),d=Pe.subscribe(M=>{r(M==="ru"?0:1)}),w=ze.subscribe(M=>{t(M)});return()=>{c.unsubscribe(),d.unsubscribe(),w.unsubscribe()}},[]),a.jsxs("div",{style:Y(o).container,children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center",justifyItems:"center"},children:[a.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"1fr 1fr",alignItems:"center",justifyItems:"center"},children:E.map((c,d)=>{const w="difficulty"+d;return d<4&&a.jsx(re,{width:"46vw",difficulty:d,protocol:c,setLevel:p,color:f.get(w,o),theme:o,lang:s,click:()=>{p(d),n(!0)},fSize:m,hasPremium:i,needBlur:d>1},d)})}),a.jsx(re,{width:"96vw",difficulty:4,protocol:E[4],setLevel:p,color:f.get("difficultyAdd",o),theme:o,lang:s,click:()=>{p(4),n(!0)},fSize:m,hasPremium:i,needBlur:!0}),a.jsx(re,{width:"96vw",difficulty:5,protocol:E[5],setLevel:p,color:f.get("difficulty",o),theme:o,lang:s,click:()=>{p(5),n(!0)},fSize:m,hasPremium:i,needBlur:!0})]}),a.jsx(St,{type:0,difficulty:l,maxTimer:E[l].timeLimitSec*1e3,show:u,setShow:n})]})},Y=(o,e)=>({container:{backgroundColor:f.get("background",o),display:"flex",flexDirection:"column",overflowY:"scroll",justifyItems:"center",alignItems:"center",height:"78vh",paddingTop:"5vh",width:"100vw",fontFamily:"Segoe UI"},scrollView:{height:"95%",width:"100%",overflowY:"scroll",display:"flex",flexDirection:"column"},mainText:{textAlign:"left",fontSize:e===0?"15px":"17px",color:f.get("mainText",o)},subtext:{textAlign:"center",fontSize:e===0?"12px":"14px",color:f.get("mainText",o),margin:"2px"},icon:{fontSize:"32px",color:f.get("mainText",o)},simplePanelRow:{width:"75vw",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around"},cardText:{textAlign:"left",marginBottom:"5px",fontSize:e===0?"14px":"16px",color:f.get("mainText",o),marginLeft:"30px"},text:{textAlign:"left",fontSize:e===0?"10px":"12px",color:f.get("subText",o),marginLeft:"30px"},btn:{width:"70%",height:"40px",borderRadius:"12px",fontSize:e===0?"13px":"14px",color:f.get("mainText",o),backgroundColor:f.get("simplePanel",o)}});function re({protocol:o,difficulty:e,click:s,width:r,color:m,theme:t,lang:u,fSize:n,hasPremium:l=!1,needBlur:p=!1}){const i=()=>e===0?a.jsx(st,{style:c}):e===1?a.jsx(H,{style:c}):e===2?a.jsx(at,{style:c}):e===3?a.jsx(lt,{style:c}):e===4?a.jsx(ot,{style:c}):a.jsx(it,{style:c}),h={alignItems:"center",justifyContent:"center",display:"flex",width:r,flexDirection:"row",height:"12vh",marginTop:"15px",borderRadius:"24px",backgroundColor:m,overflow:"hidden",position:"relative",boxShadow:"3px 3px 2px rgba(0,0,0,0.3)"},c={fontSize:"86px",rotate:"-20deg",position:"absolute",right:"-10px",top:"30%",color:f.get("svgColor",t)};return a.jsxs("div",{style:h,onClick:s,children:[!l&&p&&a.jsxs("div",{onClick:d=>{d.stopPropagation()},style:{position:"absolute",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"center",width:"100%",height:"100%",left:"0",top:"0",backdropFilter:"blur(8px)",zIndex:2},children:[a.jsxs("div",{style:{...Y(t,n).mainText},children:[" ",u===0?"–ü—Ä–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è":"Pro category"," "]}),a.jsxs("div",{style:{...Y(t,n).mainText},children:[" ",u===0?"üëë–ø—Ä–µ–º–∏—É–ºüëë":"üëëpremiumüëë"," "]}),a.jsx("button",{onClick:()=>{nt("premium")},style:{...Y(t,n).btn},children:u===0?"–°—Ç–∞—Ç—å –ø—Ä–µ–º–∏—É–º":"Get premium"})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"row",width:"65%",height:"22%",alignItems:"center",justifyContent:"flex-end",position:"absolute",top:"5%",left:"30%",fontWeight:"bold",fontSize:"16px",color:f.get("maxValColor",t)},children:[a.jsx(H,{})," ",D.mentalRecords[0][e]]}),a.jsxs("div",{style:{width:"90%",height:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:[a.jsx("h2",{style:Y(t,n).cardText,children:o.level[u]}),a.jsx("p",{style:Y(t,n).text,children:o.difficulty[u]})]}),i()]})}export{zt as default};
