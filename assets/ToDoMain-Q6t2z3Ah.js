import{A as w,y as z,j as e,a as $,m,ab as ne,bW as se,bX as re,b2 as ee,bY as te,aQ as ae,C as d,bV as oe,bZ as le,b_ as de,bq as ce,a2 as pe,$ as xe,b$ as ge,t as ue,l as fe,f as ye,c0 as he,c1 as be,c2 as je,bv as me,c3 as Ce}from"./index-C6YXmVSn.js";import{r as y}from"./recharts-Bg6K2Pzo.js";import{M as G}from"./MyInput-C9xBKn5H.js";import{I as Y}from"./Icons-Rn-KKX0U.js";import{S as _}from"./ScrollPicker-BdsHt3Iu.js";async function we(t,s,o,a,p,x,i,c,u,C,b){const h=Date.now();w.todoList.push({id:h,name:t,description:s,difficulty:o,priority:a,category:p,icon:x,color:i,isDone:!1,startDate:c,deadLine:u,goals:C||[],note:b}),await z()}async function ve(t,s,o,a,p,x,i,c,u,C,b){const h=w.todoList.find(k=>k.id===t);h&&(h.name=s,h.description=o,h.difficulty=a,h.priority=p,h.category=x,h.icon=i,h.color=c,h.startDate=u,h.deadLine=C,h.note=b,await z())}async function Se(t){w.todoList=w.todoList.filter(s=>s.id!==t),await z()}async function ke(t){const s=w.todoList.find(o=>o.id===t);s&&(s.isDone=!s.isDone,await z())}async function Te(t,s){const o=w.todoList.find(a=>a.id===t);o&&(o.goals||(o.goals=[]),o.goals.push({text:s,isDone:!1}),await z())}async function De(t,s){const o=w.todoList.find(a=>a.id===t);o&&o.goals&&(o.goals.splice(s,1),await z())}async function Ie(t,s){const o=w.todoList.find(a=>a.id===t);o&&o.goals&&o.goals[s]&&(o.goals[s].isDone=!o.goals[s].isDone,await z())}const V=[["ÐÐ¸Ð·ÐºÐ¸Ð¹","Low"],["ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹","Normal"],["Ð’Ð°Ð¶Ð½Ñ‹Ð¹","Important"],["Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹","High"],["ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹","Critical"]],U=[["ÐžÑ‡ÐµÐ½ÑŒ Ð»ÐµÐ³ÐºÐ¾","Very Easy"],["Ð›ÐµÐ³ÐºÐ¾","Easy"],["Ð¡Ñ€ÐµÐ´Ð½Ðµ","Medium"],["Ð¡Ð»Ð¾Ð¶Ð½Ð¾","Hard"],["ÐšÐ¾ÑˆÐ¼Ð°Ñ€","Nightmare"]],K=["#B0BEC5","#29B6F6","#FFCA28","#FB8C00","#F44336"],X=["#66BB6A","#9CCC65","#FFCA28","#FF7043","#D32F2F"],Re=({show:t,setShow:s,theme:o,lang:a,fSize:p,task:x})=>{const[i,c]=y.useState(x||{}),[u,C]=y.useState(!1),[b,h]=y.useState("");y.useEffect(()=>{x&&c(x)},[x]);const k=i.goals?.length||0,S=i.goals?.filter(l=>l.isDone).length||0,T=k===0?i.isDone?100:0:Math.round(S/k*100),D=K[i.priority]||K[0],v=X[i.difficulty]||X[0],F=async()=>{c(l=>({...l,isDone:!l.isDone})),await ke(i.id)},B=async()=>{window.confirm(a===0?"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ†ÐµÐ»ÑŒ?":"Delete this goal?")&&(await Se(i.id),s(!1))},L=async()=>{await ve(i.id,i.name,i.description,i.difficulty,i.priority,i.category,i.icon,i.color,i.startDate,i.deadLine,i.note),C(!1)},I=async l=>{const f=[...i.goals];f[l].isDone=!f[l].isDone,c(P=>({...P,goals:f})),await Ie(i.id,l)},j=async l=>{const f=i.goals.filter((P,ie)=>ie!==l);c(P=>({...P,goals:f})),await De(i.id,l)},r=async()=>{if(!b.trim())return;const l={text:b,isDone:!1};c(f=>({...f,goals:[...f.goals||[],l]})),await Te(i.id,b),h("")},g=()=>{C(!1),s(!1)},n=A(o,p,i.color);return e.jsx($,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:g,style:n.backdrop}),e.jsxs(m.div,{initial:{y:"100%"},animate:{y:"0%"},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},style:n.modalContainer,children:[e.jsx("div",{style:n.dragArea,onClick:g,children:e.jsx("div",{style:n.dragHandle})}),e.jsxs("div",{style:n.toolbar,children:[e.jsx("div",{style:n.toolbarLeft,children:e.jsx("button",{onClick:B,style:n.iconBtnRed,children:e.jsx(ne,{size:16})})}),e.jsx("div",{style:n.toolbarRight,children:u?e.jsxs("button",{onClick:L,style:n.saveBtn,children:[e.jsx(se,{size:16,style:{marginRight:6}})," ",a===0?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ":"Save"]}):e.jsx("button",{onClick:()=>C(!0),style:n.iconBtn,children:e.jsx(re,{size:16})})})]}),e.jsxs("div",{style:n.scrollableContent,className:"no-scrollbar",children:[e.jsxs("div",{style:n.headerWrapper,children:[e.jsxs("div",{style:n.headerTopRow,children:[e.jsx("div",{style:n.iconBadge,children:i.icon}),e.jsx(m.button,{whileTap:{scale:.95},onClick:F,style:n.statusBadge(i.isDone),children:i.isDone?a===0?"Ð’Ð«ÐŸÐžÐ›ÐÐ•ÐÐž":"COMPLETED":a===0?"Ð’ ÐŸÐ ÐžÐ¦Ð•Ð¡Ð¡Ð•":"IN PROGRESS"})]}),u?e.jsx("input",{style:n.titleInput,value:i.name,onChange:l=>c({...i,name:l.target.value}),placeholder:"Goal Title"}):e.jsx("h2",{style:n.title,children:i.name}),e.jsxs("div",{style:n.progressContainer,children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:e.jsxs("span",{style:n.progressText,children:[T,"%"]})}),e.jsx("div",{style:n.progressBarBg,children:e.jsx(m.div,{initial:{width:0},animate:{width:`${T}%`},style:n.progressBarFill})})]})]}),e.jsxs("div",{style:n.bodyPadding,children:[e.jsx("div",{style:n.gridTwo,children:u?e.jsxs(e.Fragment,{children:[e.jsx("select",{style:n.selectInput,value:i.priority,onChange:l=>c({...i,priority:parseInt(l.target.value)}),children:V.map((l,f)=>e.jsx("option",{value:f,children:l[a]},f))}),e.jsx("select",{style:n.selectInput,value:i.difficulty,onChange:l=>c({...i,difficulty:parseInt(l.target.value)}),children:U.map((l,f)=>e.jsx("option",{value:f,children:l[a]},f))})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{icon:e.jsx(ee,{}),label:a===0?"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚":"Priority",value:V[i.priority][a],color:D,theme:o}),e.jsx(q,{icon:e.jsx(te,{}),label:a===0?"Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ":"Difficulty",value:U[i.difficulty][a],color:v,theme:o})]})}),e.jsx("div",{style:n.sectionBox,children:u?e.jsx("textarea",{style:n.textArea,value:i.description,onChange:l=>c({...i,description:l.target.value}),placeholder:"Description...",rows:3}):e.jsx("p",{style:n.description,children:i.description||(a===0?"ÐÐµÑ‚ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ":"No description")})}),e.jsxs("div",{style:n.dateRow,children:[e.jsxs("div",{style:n.dateItem,children:[e.jsx(ae,{style:{marginRight:8,color:d.get("subText",o)}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:n.label,children:a===0?"Ð¡Ñ‚Ð°Ñ€Ñ‚":"Start"}),u?e.jsx("input",{type:"date",style:n.dateInput,value:i.startDate,onChange:l=>c({...i,startDate:l.target.value})}):e.jsx("span",{style:n.dateValue,children:i.startDate})]})]}),e.jsxs("div",{style:n.dateItem,children:[e.jsx(oe,{style:{marginRight:8,color:d.get("subText",o)}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:n.label,children:a===0?"Ð¡Ñ€Ð¾Ðº":"Deadline"}),u?e.jsx("input",{type:"date",style:n.dateInput,value:i.deadLine||"",onChange:l=>c({...i,deadLine:l.target.value})}):e.jsx("span",{style:n.dateValue,children:i.deadLine||"-"})]})]})]}),e.jsxs("div",{style:{marginTop:"30px"},children:[e.jsxs("div",{style:n.sectionHeader,children:[e.jsx(le,{style:{marginRight:"8px",color:i.color}}),a===0?"Ð§ÐµÐº-Ð»Ð¸ÑÑ‚":"Checklist",e.jsxs("span",{style:n.counterBadge,children:[S,"/",k]})]}),e.jsxs("div",{style:n.goalsContainer,children:[e.jsx($,{children:i.goals?.map((l,f)=>e.jsxs(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},style:n.goalRow,children:[e.jsx("div",{onClick:()=>I(f),style:n.checkbox(l.isDone),children:l.isDone&&e.jsx(de,{size:10,color:"#fff"})}),e.jsx("div",{style:n.goalText(l.isDone),onClick:()=>I(f),children:l.text}),e.jsx("div",{onClick:()=>j(f),style:n.deleteSubBtn,children:e.jsx(ce,{})})]},f))}),e.jsxs("div",{style:n.addSubRow,children:[e.jsx(pe,{style:{color:d.get("subText",o),marginRight:10}}),e.jsx("input",{style:n.addSubInput,placeholder:a===0?"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ñƒ...":"Add item...",value:b,onChange:l=>h(l.target.value),onKeyDown:l=>l.key==="Enter"&&r()}),b.length>0&&e.jsx("button",{onClick:r,style:n.addSubBtn,children:"OK"})]})]})]}),e.jsx("div",{style:{height:"80px"}})]})]})]})]})})},q=({icon:t,label:s,value:o,color:a,theme:p})=>e.jsxs("div",{style:{...A(p).modernBadge,backgroundColor:`${a}15`,border:`1px solid ${a}30`},children:[e.jsxs("div",{style:A(p).badgeLabel,children:[t," ",e.jsx("span",{style:{marginLeft:6},children:s})]}),e.jsx("div",{style:{...A(p).badgeValue,color:a},children:o})]}),A=(t,s,o)=>{const a=d.get("background",t),p=d.get("simplePanel",t),x=d.get("mainText",t),i=d.get("subText",t),c=d.get("border",t);return{backdrop:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",backdropFilter:"blur(5px)",zIndex:1999},modalContainer:{position:"fixed",bottom:0,left:0,right:0,height:"85vh",backgroundColor:a,borderTopLeftRadius:"32px",borderTopRightRadius:"32px",zIndex:2e3,display:"flex",flexDirection:"column",boxShadow:"0 -10px 40px rgba(0,0,0,0.3)",overflow:"hidden"},dragArea:{width:"100%",padding:"12px 0",display:"flex",justifyContent:"center",cursor:"grab"},dragHandle:{width:"40px",height:"4px",backgroundColor:c,borderRadius:"10px"},toolbar:{display:"flex",justifyContent:"space-between",padding:"0 24px 10px 24px"},iconBtn:{background:p,border:"none",width:"36px",height:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:x,cursor:"pointer"},iconBtnRed:{background:"rgba(239, 68, 68, 0.1)",border:"none",width:"36px",height:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#EF4444",cursor:"pointer"},saveBtn:{background:d.get("done",t),color:"#fff",border:"none",borderRadius:"20px",padding:"8px 16px",fontWeight:"bold",display:"flex",alignItems:"center",cursor:"pointer"},scrollableContent:{flex:1,overflowY:"auto",position:"relative"},headerWrapper:{padding:"10px 24px 20px 24px",background:`linear-gradient(180deg, ${a} 0%, ${p} 100%)`},headerTopRow:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},iconBadge:{width:"56px",height:"56px",borderRadius:"16px",fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:o?`${o}20`:p,border:`1px solid ${o}40`},statusBadge:u=>({padding:"8px 14px",borderRadius:"12px",fontSize:"11px",fontWeight:"800",border:"none",backgroundColor:u?d.get("done",t):p,color:u?"#fff":i,cursor:"pointer"}),title:{fontSize:"26px",fontWeight:"800",color:x,lineHeight:"1.2",marginBottom:"15px"},titleInput:{fontSize:"26px",fontWeight:"800",color:x,background:"transparent",border:"none",borderBottom:`2px solid ${o}`,width:"100%",marginBottom:"15px",paddingBottom:"4px",outline:"none"},progressContainer:{width:"100%",marginTop:"5px"},progressText:{fontSize:"12px",fontWeight:"700",color:i},progressBarBg:{width:"100%",height:"6px",backgroundColor:c,borderRadius:"3px",marginTop:"4px"},progressBarFill:{height:"100%",backgroundColor:o,borderRadius:"3px"},bodyPadding:{padding:"24px"},gridTwo:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"20px"},modernBadge:{borderRadius:"16px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},badgeLabel:{display:"flex",alignItems:"center",fontSize:"11px",color:i,marginBottom:"4px",textTransform:"uppercase"},badgeValue:{fontSize:"14px",fontWeight:"700"},selectInput:{width:"100%",padding:"12px",borderRadius:"12px",border:`1px solid ${c}`,backgroundColor:a,color:x,fontSize:"14px",outline:"none"},sectionBox:{marginBottom:"20px"},description:{fontSize:"16px",lineHeight:"1.5",color:x,opacity:.8},textArea:{width:"100%",padding:"12px",borderRadius:"12px",border:`1px solid ${c}`,backgroundColor:a,color:x,fontSize:"16px",outline:"none",resize:"none"},dateRow:{display:"flex",gap:"12px",marginBottom:"20px"},dateItem:{flex:1,display:"flex",alignItems:"center",backgroundColor:p,padding:"12px",borderRadius:"12px"},label:{fontSize:"10px",color:i,textTransform:"uppercase",marginBottom:"2px"},dateValue:{fontSize:"13px",fontWeight:"600",color:x},dateInput:{background:"transparent",border:"none",color:x,fontSize:"13px",width:"100%",outline:"none",fontFamily:"inherit"},sectionHeader:{display:"flex",alignItems:"center",fontSize:"16px",fontWeight:"700",color:x,marginBottom:"15px"},counterBadge:{marginLeft:"auto",fontSize:"12px",backgroundColor:p,padding:"2px 8px",borderRadius:"6px",color:i},goalsContainer:{display:"flex",flexDirection:"column",gap:"8px"},goalRow:{display:"flex",alignItems:"center",padding:"10px 12px",backgroundColor:p,borderRadius:"12px",gap:"12px"},checkbox:u=>({width:"22px",height:"22px",borderRadius:"6px",border:`2px solid ${u?o:c}`,backgroundColor:u?o:"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}),goalText:u=>({flex:1,fontSize:"15px",color:x,opacity:u?.5:1,textDecoration:u?"line-through":"none",cursor:"pointer",transition:"all 0.2s"}),deleteSubBtn:{color:i,cursor:"pointer",opacity:.6,fontSize:"12px",padding:"5px"},addSubRow:{display:"flex",alignItems:"center",padding:"10px 12px",marginTop:"5px",border:`1px dashed ${c}`,borderRadius:"12px"},addSubInput:{flex:1,background:"transparent",border:"none",color:x,fontSize:"14px",outline:"none"},addSubBtn:{background:o,color:"#fff",border:"none",borderRadius:"6px",padding:"4px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"}}},W=[["ÐÐ¸Ð·ÐºÐ¸Ð¹","Low"],["ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹","Normal"],["Ð’Ð°Ð¶Ð½Ñ‹Ð¹","Important"],["Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹","High"],["ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹","Critical"]],O=[["ÐžÑ‡ÐµÐ½ÑŒ Ð»ÐµÐ³ÐºÐ¾","Very Easy"],["Ð›ÐµÐ³ÐºÐ¾","Easy"],["Ð¡Ñ€ÐµÐ´Ð½Ðµ","Medium"],["Ð¡Ð»Ð¾Ð¶Ð½Ð¾","Hard"],["ÐšÐ¾ÑˆÐ¼Ð°Ñ€","Nightmare"]],Q=["ðŸ“","ðŸ’¼","ðŸ ","ðŸ’ª","ðŸ›’","ðŸŽ“","âœˆï¸","ðŸ’°","ðŸŽ¨","ðŸ’»"],Fe=({theme:t,lang:s,fSize:o})=>{const[a,p]=y.useState(!1),[x,i]=y.useState(""),[c,u]=y.useState(""),[C,b]=y.useState(W[1][s]),[h,k]=y.useState(O[2][s]),[S,T]=y.useState(Q[0]),[D,v]=y.useState([]),[F,B]=y.useState("");y.useRef(null),y.useEffect(()=>{const g=xe.subscribe(n=>p(n==="ToDoNew"));return()=>g.unsubscribe()},[]);const L=async()=>{if(!x.trim())return;const g=W.findIndex(f=>f.includes(C)),n=O.findIndex(f=>f.includes(h)),l=new Date().toISOString().split("T")[0];await we(x,c,n,g,"General",S,d.get("areaChart",t),l,null,D,""),I()},I=()=>{ge(null),setTimeout(()=>{i(""),u(""),v([]),B(""),b(W[1][s])},300)},j=()=>{F.trim()&&(v([...D,{text:F,isDone:!1}]),B(""))},r=Be(t);return e.jsx($,{children:a&&e.jsxs(e.Fragment,{children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:I,style:r.backdrop}),e.jsxs(m.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:28,stiffness:250},style:r.container,children:[e.jsx("div",{style:r.handleContainer,children:e.jsx("div",{style:r.handle})}),e.jsxs("div",{style:r.header,children:[e.jsx(m.button,{whileTap:{scale:.9},onClick:I,style:r.textBtn,children:s===0?"ÐžÑ‚Ð¼ÐµÐ½Ð°":"Cancel"}),e.jsx("span",{style:r.headerTitle,children:s===0?"ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ":"New Goal"}),e.jsx(m.button,{whileTap:{scale:.9},onClick:L,style:{...r.textBtn,color:d.get("done",t),fontWeight:"700"},children:s===0?"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ":"Create"})]}),e.jsxs("div",{style:r.scrollContent,className:"no-scrollbar",children:[e.jsx("div",{style:r.section,children:e.jsxs("div",{style:r.mainInputWrapper,children:[e.jsx("span",{style:{fontSize:"2rem",marginRight:"10px"},children:S}),e.jsx("div",{style:{flex:1},children:e.jsx(G,{placeHolder:s===0?"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸...":"Goal Title...",value:x,onChange:i,theme:t,w:"100%",h:"auto"})})]})}),e.jsx("div",{style:r.iconScrollContainer,children:Q.map((g,n)=>e.jsx(m.div,{whileTap:{scale:.8},onClick:()=>T(g),style:{...r.iconChip,backgroundColor:g===S?d.get("iconsHighlited",t):"transparent",border:g===S?"none":`1px solid ${d.get("border",t)}`},children:e.jsx("span",{style:{fontSize:"1.2rem",filter:g===S?"grayscale(0)":"grayscale(100%) opacity(0.7)"},children:g})},n))}),e.jsx("div",{style:r.card,children:e.jsxs("div",{style:r.pickerRow,children:[e.jsxs("div",{style:r.pickerCol,children:[e.jsx("label",{style:r.label,children:s===0?"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚":"Priority"}),e.jsx(_,{items:W.map(g=>g[s]),value:C,onChange:b,theme:t,width:"100%"})]}),e.jsx("div",{style:r.divider}),e.jsxs("div",{style:r.pickerCol,children:[e.jsx("label",{style:r.label,children:s===0?"Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ":"Difficulty"}),e.jsx(_,{items:O.map(g=>g[s]),value:h,onChange:k,theme:t,width:"100%"})]})]})}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(G,{placeHolder:s===0?"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸ / ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ...":"Notes / Description...",value:c,onChange:u,theme:t})}),e.jsxs("div",{style:r.subTaskContainer,children:[e.jsx("label",{style:r.sectionTitle,children:s===0?"Ð§ÐµÐº-Ð»Ð¸ÑÑ‚":"Checklist"}),e.jsxs("div",{style:r.addSubRow,children:[e.jsx("div",{style:{flex:1},children:e.jsx(G,{placeHolder:s===0?"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑˆÐ°Ð³...":"Add a step...",value:F,onChange:B,theme:t})}),e.jsx(m.button,{whileTap:{scale:.9},onClick:j,style:r.addBtn,children:Y.getIcon("add",{style:{color:"#FFF",fontSize:"1.5rem"}})})]}),e.jsx("div",{style:r.subList,children:e.jsx($,{children:D.map((g,n)=>e.jsxs(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,padding:0},style:r.subItem,children:[e.jsx("div",{style:r.subDot}),e.jsx("span",{style:r.subText,children:g.text}),e.jsx("div",{onClick:()=>v(D.filter((l,f)=>f!==n)),children:Y.getIcon("close",{style:{fontSize:"1rem",color:d.get("skipped",t)}})})]},n))})})]}),e.jsx("div",{style:{marginBottom:"300px"}})]})]})]})})},Be=t=>{const s=d.get("background",t),o=d.get("simplePanel",t),a=d.get("mainText",t),p=d.get("subText",t);return{backdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",backdropFilter:"blur(4px)",zIndex:998},container:{position:"fixed",bottom:0,left:0,right:0,height:"85vh",backgroundColor:s,borderRadius:"24px 24px 0 0",boxShadow:"0 -10px 40px rgba(0,0,0,0.1)",zIndex:999,display:"flex",flexDirection:"column",overflow:"hidden"},handleContainer:{width:"100%",display:"flex",justifyContent:"center",paddingTop:"12px",paddingBottom:"8px"},handle:{width:"40px",height:"5px",borderRadius:"3px",backgroundColor:d.get("border",t)},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 20px 15px 20px",borderBottom:`1px solid ${d.get("svgColor",t)}`},textBtn:{background:"none",border:"none",fontSize:"16px",color:p,cursor:"pointer",padding:"10px"},headerTitle:{fontSize:"18px",fontWeight:"700",color:a},scrollContent:{flex:1,overflowY:"auto",padding:"20px"},section:{marginBottom:"20px"},mainInputWrapper:{display:"flex",alignItems:"center"},iconScrollContainer:{display:"flex",gap:"12px",overflowX:"auto",padding:"5px 5px 15px 5px",scrollbarWidth:"none"},iconChip:{width:"45px",height:"45px",minWidth:"45px",borderRadius:"14px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},card:{backgroundColor:o,borderRadius:"20px",padding:"15px",boxShadow:d.get("shadow",t)},pickerRow:{display:"flex",justifyContent:"space-between",alignItems:"center"},pickerCol:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},divider:{width:"1px",height:"60px",backgroundColor:d.get("border",t),margin:"0 10px"},label:{fontSize:"13px",color:p,fontWeight:"600",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},subTaskContainer:{marginTop:"30px"},sectionTitle:{fontSize:"16px",fontWeight:"700",color:a,marginLeft:"5px",marginBottom:"10px",display:"block"},addSubRow:{display:"flex",alignItems:"center",gap:"10px"},addBtn:{width:"46px",height:"46px",borderRadius:"14px",backgroundColor:d.get("done",t),display:"flex",alignItems:"center",justifyContent:"center",border:"none",marginTop:"10px",cursor:"pointer",boxShadow:`0 4px 12px ${d.get("habitCardDone",t)}`},subList:{marginTop:"15px",display:"flex",flexDirection:"column",gap:"8px"},subItem:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",backgroundColor:o,borderRadius:"12px"},subDot:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:d.get("subText",t),marginRight:"12px"},subText:{flex:1,fontSize:"15px",color:a}}},H=new Audio("Audio/Click.wav"),Z=["#B0BEC5","#4FC3F7","#FFD54F","#FF9800","#F44336"],J=["#AED581","#81C784","#FFB74D","#FF8A65","#D32F2F"],Ne=()=>{const[t,s]=y.useState("dark"),[o,a]=y.useState(w.prefs[0]),[p,x]=y.useState(w.prefs[4]),[i,c]=y.useState(!1),[u,C]=y.useState(0),[b,h]=y.useState([]),[k,S]=y.useState({}),[T,D]=y.useState(0),[v,F]=y.useState(1);y.useEffect(()=>{const r=ue.subscribe(s),g=fe.subscribe(l=>a(l==="ru"?0:1)),n=ye.subscribe(x);return()=>{r.unsubscribe(),g.unsubscribe(),n.unsubscribe()}},[]),y.useEffect(()=>{let r=[...w.todoList];T===1?r=r.filter(g=>g.isDone):T===2&&(r=r.filter(g=>!g.isDone)),v===0?r.sort((g,n)=>n.difficulty-g.difficulty):v===1?r.sort((g,n)=>n.priority-g.priority):v===2&&r.sort((g,n)=>E(g.deadLine)-E(n.deadLine)),h(r)},[T,v,u,i]);const B=r=>{S(r),c(!0),M(H)},L=()=>[o===0?"Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ":"Difficulty",o===0?"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚":"Priority",o===0?"Ð”ÐµÐ´Ð»Ð°Ð¹Ð½":"Deadline"][v],I=()=>[o===0?"Ð’ÑÐµ":"All",o===0?"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾":"Done",o===0?"Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ":"Active"][T],j=R(t,p);return e.jsxs("div",{style:j.container,children:[e.jsxs("div",{style:j.controlBar,children:[e.jsxs(m.div,{whileTap:{scale:.96},onClick:()=>{F(r=>r+1<3?r+1:0),M(H)},style:j.controlButton,children:[e.jsx("div",{style:j.iconCircle,children:e.jsx(he,{size:14})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:j.controlLabel,children:o===0?"Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°":"Sort By"}),e.jsx("span",{style:j.controlValue,children:L()})]})]}),e.jsxs(m.div,{whileTap:{scale:.96},onClick:()=>{D(r=>r+1<3?r+1:0),M(H)},style:j.controlButton,children:[e.jsx("div",{style:j.iconCircle,children:e.jsx(be,{size:12})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:j.controlLabel,children:o===0?"Ð¤Ð¸Ð»ÑŒÑ‚Ñ€":"Filter"}),e.jsx("span",{style:j.controlValue,children:I()})]})]})]}),e.jsxs("div",{style:j.panel,className:"no-scrollbar",children:[e.jsx($,{mode:"popLayout",children:b.length>0?b.map(r=>e.jsx(ze,{item:r,onClick:()=>B(r),theme:t,lang:o,fSize:p},r.id)):e.jsxs(m.div,{initial:{opacity:0},animate:{opacity:.5},style:j.emptyState,children:[e.jsx(je,{size:40,style:{marginBottom:10}}),e.jsx("span",{children:o===0?"Ð—Ð°Ð´Ð°Ñ‡ Ð½ÐµÑ‚":"No tasks found"})]})}),e.jsx("div",{style:{height:"120px",width:"100%"}})]}),e.jsx(Re,{show:i,setShow:c,theme:t,lang:o,fSize:p,task:k}),e.jsx(Fe,{theme:t,lang:o,fSize:p})]})},ze=({item:t,onClick:s,theme:o,lang:a,fSize:p})=>{const x=o==="dark",i=Pe(t.deadLine)&&!t.isDone,c=Le(t),u=Z[t.priority]||Z[0],C=J[t.difficulty]||J[0],b=t.isDone?d.get("done",o):i?d.get("skipped",o):d.get("mainText",o),h=t.isDone?"50":"99";return e.jsxs(m.div,{layout:!0,initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9},whileTap:{scale:.98},onClick:s,style:{...R(o).card,backgroundColor:x?`${d.get("simplePanel",o)}${h}`:"#FFFFFF",borderLeft:`4px solid ${i?"#EF4444":t.isDone?"#10B981":"transparent"}`},children:[e.jsx("div",{style:R(o).iconBox(t.color),children:t.icon||"ðŸ“"}),e.jsxs("div",{style:R(o).cardContent,children:[e.jsx("div",{style:R(o,p).cardTitle(t.isDone),children:t.name}),e.jsxs("div",{style:R(o).badgeRow,children:[e.jsx(N,{color:u,icon:e.jsx(ee,{size:8}),text:t.priority+1}),e.jsx(N,{color:C,icon:e.jsx(te,{size:8}),text:t.difficulty+1}),t.isDone&&e.jsx(N,{color:d.get("done",o),icon:e.jsx(me,{size:8}),text:a===0?"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾":"Done"})]})]}),e.jsxs("div",{style:R(o).cardRight,children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:"800",color:d.get("subText",o)},children:c}),e.jsxs("div",{style:{...R(o).dateTag,color:b,borderColor:`${b}30`},children:[i?e.jsx(Ce,{size:10}):e.jsx(oe,{size:10}),e.jsx("span",{children:We(t.deadLine,a)})]})]})]})},N=({color:t,icon:s,text:o})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"6px",backgroundColor:`${t}15`,border:`1px solid ${t}30`,color:t,fontSize:"10px",fontWeight:"bold"},children:[s,e.jsx("span",{children:o})]}),R=(t,s)=>{const o=d.get("background",t),a=d.get("mainText",t),p=d.get("subText",t),x=d.get("border",t),i=d.get("simplePanel",t);return{container:{backgroundColor:o,height:"100vh",width:"100vw",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},controlBar:{display:"flex",justifyContent:"space-between",gap:"12px",width:"92%",height:"60px",marginTop:"15vh",marginBottom:"10px"},controlButton:{flex:1,backgroundColor:i,borderRadius:"18px",display:"flex",alignItems:"center",padding:"0 14px",cursor:"pointer",border:`1px solid ${x}`,boxShadow:`0 4px 12px ${d.get("shadow",t)}`},iconCircle:{width:"32px",height:"32px",borderRadius:"10px",backgroundColor:`${a}10`,color:a,display:"flex",alignItems:"center",justifyContent:"center",marginRight:"10px"},controlLabel:{fontSize:"10px",color:p,textTransform:"uppercase",fontWeight:"bold"},controlValue:{fontSize:"13px",fontWeight:"800",color:a},panel:{flex:1,width:"100%",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"10px"},emptyState:{marginTop:"50px",display:"flex",flexDirection:"column",alignItems:"center",color:p,fontSize:"16px",fontWeight:"600"},card:{width:"92%",minHeight:"80px",borderRadius:"20px",marginBottom:"12px",padding:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",backdropFilter:"blur(10px)",boxShadow:"0 2px 10px rgba(0,0,0,0.02)",cursor:"pointer",overflow:"hidden"},iconBox:c=>({width:"48px",height:"48px",borderRadius:"14px",backgroundColor:c||"#888",color:"#fff",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 10px ${c}40`,flexShrink:0,marginRight:"12px"}),cardContent:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},cardTitle:c=>({fontSize:s===0?"16px":"18px",fontWeight:"700",color:a,marginBottom:"6px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textDecoration:c?"line-through":"none",opacity:c?.6:1}),badgeRow:{display:"flex",gap:"6px"},cardRight:{display:"flex",flexDirection:"column",alignItems:"flex-end",minWidth:"70px",gap:"6px"},dateTag:{fontSize:"11px",fontWeight:"700",display:"flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"8px",border:"1px solid transparent",backgroundColor:"transparent"},fab:{position:"absolute",bottom:"30px",right:"20px",width:"56px",height:"56px",borderRadius:"20px",backgroundColor:d.get("accent",t)||"#3B82F6",border:"none",boxShadow:"0 8px 20px rgba(59, 130, 246, 0.4)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10}}};function M(t){w.prefs[2]===0&&t&&(t.paused||(t.pause(),t.currentTime=0),t.volume=.5,t.play().catch(s=>console.log("Audio play failed",s))),w.prefs[3]===0&&window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("light")}const Le=t=>!t.goals||t.goals.length===0?"":`${t.goals.filter(o=>o.isDone).length}/${t.goals.length}`;function $e(t){if(!t)return null;if(t.includes("-"))return new Date(t);if(t.includes(".")){const s=t.split(".");return new Date(s[2],s[1]-1,s[0])}return new Date(t)}function E(t){const s=$e(t);if(!s)return 9999;const o=new Date;return o.setHours(0,0,0,0),s.setHours(0,0,0,0),Math.ceil((s-o)/(1e3*60*60*24))}function Pe(t){return E(t)<0}function We(t,s){if(!t)return"";const o=E(t);return s===0?o===0?"Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ":o===1?"Ð—Ð°Ð²Ñ‚Ñ€Ð°":o<0?`${Math.abs(o)} Ð´Ð½. Ð½Ð°Ð·Ð°Ð´`:`${o} Ð´Ð½.`:o===0?"Today":o===1?"Tmrw":o<0?`${Math.abs(o)}d ago`:`${o}d left`}export{Ne as default};
