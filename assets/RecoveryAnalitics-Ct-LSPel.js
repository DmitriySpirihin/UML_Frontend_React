import{A as S,U as H,t as D,l as P,f as L,p as U,j as e,C as i,bX as E,bY as Y,m as T,bz as O,g as K,bI as M,bJ as N,bO as J}from"./index-BuXiURDS.js";import{r as l}from"./recharts-Bg6K2Pzo.js";import{M as X}from"./MyAreaChart-pzZndpMe.js";const $=[{ru:"Дыхание",en:"Breathing",icon:e.jsx(N,{}),colorKey:"out",fallback:"#32D74B"},{ru:"Медитация",en:"Meditation",icon:e.jsx(J,{}),colorKey:"meditate",fallback:"#BF5AF2"},{ru:"Закалка",en:"Hardening",icon:e.jsx(M,{}),colorKey:"cold",fallback:"#0A84FF"}],_=[["Месяц","Month"],["Полгода","6 Months"],["Год","Year"]],q=[28,180,360],C=t=>{const r=Math.floor(t/1e3),o=Math.floor(r/60),c=r%60;return`${o}m ${c}s`},G=(t,r)=>new Date(t).toLocaleDateString(r===0?"ru-RU":"en-US",{day:"numeric",month:"short"}),Q=(t,r)=>{const o=$[t];return i.get(o.colorKey,r)||o.fallback},V=({items:t,selectedIndex:r,onChange:o,theme:c,langIndex:m,fSize:g,activeColor:f})=>e.jsx("div",{style:{display:"flex",backgroundColor:c==="dark"?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.05)",borderRadius:"14px",padding:"4px",marginBottom:"20px",width:"92%",position:"relative",backdropFilter:"blur(10px)"},children:t.map((x,s)=>{const y=r===s;return e.jsxs("div",{onClick:()=>o(s),style:{flex:1,position:"relative",padding:"10px 0",textAlign:"center",cursor:"pointer",zIndex:1,fontSize:g===0?"13px":"15px",fontWeight:y?"700":"500",color:y?"#FFF":i.get("subText",c),transition:"color 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[y&&e.jsx(T.div,{layoutId:"activeTab",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:f,borderRadius:"12px",zIndex:-1,boxShadow:`0 4px 12px ${f}60`},transition:{type:"spring",stiffness:300,damping:25}}),e.jsx("span",{style:{fontSize:"14px"},children:x.icon}),e.jsx("span",{children:x[m===0?"ru":"en"]})]},s)})}),Z=({items:t,selectedIndex:r,onChange:o,theme:c,langIndex:m,activeColor:g})=>e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",width:"92%",justifyContent:"center"},children:t.map((f,x)=>{const s=r===x;return e.jsx("div",{onClick:()=>o(x),style:{padding:"6px 16px",borderRadius:"20px",fontSize:"12px",fontWeight:s?"700":"500",cursor:"pointer",backgroundColor:s?`${g}20`:"transparent",color:s?g:i.get("subText",c),border:s?`1px solid ${g}`:`1px solid ${i.get("border",c)}`,transition:"all 0.2s ease",minWidth:"60px",textAlign:"center"},children:f[m]},x)})}),se=()=>{const[t,r]=l.useState("dark"),[o,c]=l.useState(S.prefs[0]),[m,g]=l.useState(S.prefs[4]),[f,x]=l.useState(H.hasPremium),[s,y]=l.useState(0),[I,A]=l.useState(0);l.useEffect(()=>{const n=D.subscribe(r),a=P.subscribe(v=>c(v==="ru"?0:1)),p=L.subscribe(g),j=U.subscribe(x);return()=>{n.unsubscribe(),a.unsubscribe(),p.unsubscribe(),j.unsubscribe()}},[]);const R=[S.breathingLog,S.meditationLog,S.hardeningLog],F=l.useMemo(()=>{const n=R[s]||{},a={};for(const[p,j]of Object.entries(n)){let v=0,w=0,z=0;for(const h of j){const B=h.endTime-h.startTime;v+=B,s===0&&h.maxHold&&(w+=h.maxHold),s===2&&h.timeInColdWater&&(z+=h.timeInColdWater)}a[p]={date:p,totalDuration:v,totalMaxHold:w,totalTimeInCold:z}}return Object.values(a).sort((p,j)=>new Date(p.date)-new Date(j.date))},[s]),u=l.useMemo(()=>{if(F.length===0)return[];const n=new Date,a=new Date(n);return a.setDate(n.getDate()-q[I]),F.filter(p=>new Date(p.date)>=a)},[F,I]),W=l.useMemo(()=>u.map(n=>({date:n.date.split("-").slice(1).reverse().join("."),weight:Math.round(n.totalDuration/1e3)})).reverse(),[u]),k=l.useMemo(()=>u.reduce((n,a)=>n+a.totalDuration,0),[u]),d=Q(s,t),b=t==="dark"||t==="specialdark";return e.jsxs("div",{style:ee(t).container,children:[e.jsx("h2",{style:{margin:"0 0 15px 0",fontSize:"24px",fontWeight:"800",color:i.get("mainText",t),fontFamily:"Segoe UI",letterSpacing:"0.5px"},children:o===0?"Ваш прогресс":"Your Progress"}),e.jsx(V,{items:$,selectedIndex:s,onChange:y,theme:t,langIndex:o,fSize:m,activeColor:d}),e.jsxs("div",{style:{width:"92%",background:b?"linear-gradient(160deg, #1C1C1E 0%, #101010 100%)":"#FFFFFF",borderRadius:"24px",padding:"20px 0px 10px 0px",marginBottom:"20px",boxShadow:b?"0 10px 40px -10px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05)":"0 10px 30px -10px rgba(0,0,0,0.1)",border:b?`1px solid ${d}30`:"none",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{paddingLeft:"24px",marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"13px",color:i.get("subText",t),fontWeight:"600",textTransform:"uppercase",letterSpacing:"1px"},children:o===0?"Всего за период":"Total Time"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"800",color:d,textShadow:`0 0 20px ${d}50`},children:k>0?C(k):"0m 0s"})]}),e.jsx("div",{style:{width:"100%",height:"160px",paddingRight:"10px"},children:e.jsx(X,{data:W,fillColor:d,textColor:i.get("subText",t),linesColor:b?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)",backgroundColor:"transparent"})}),e.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:"40%",background:`linear-gradient(to top, ${d}20, transparent)`,pointerEvents:"none"}})]}),e.jsx(Z,{items:_,selectedIndex:I,onChange:A,theme:t,langIndex:o,activeColor:d}),e.jsxs("div",{style:{width:"90%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(E,{color:i.get("subText",t),size:14}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"700",color:i.get("mainText",t)},children:o===0?"История сессий":"History"})]}),e.jsxs("span",{style:{fontSize:"12px",color:i.get("subText",t),opacity:.7},children:[u.length," ",o===0?"записей":"records"]})]}),e.jsx("div",{style:{width:"100%",flex:1,overflowY:"auto",padding:"0 5% 50px 5%",boxSizing:"border-box"},className:"no-scrollbar",children:u.length===0?e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"40px",opacity:.5},children:[e.jsx(Y,{size:40,color:i.get("subText",t),style:{marginBottom:"10px"}}),e.jsx("div",{style:{color:i.get("subText",t),fontSize:"14px"},children:o===0?"Нет тренировок за этот период":"No sessions in this period"})]}):u.slice().reverse().map((n,a)=>e.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.05},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",marginBottom:"10px",backgroundColor:b?"rgba(255,255,255,0.03)":"#FFF",borderRadius:"18px",borderLeft:`4px solid ${d}`,boxShadow:b?"none":"0 2px 10px rgba(0,0,0,0.03)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:`${d}15`,display:"flex",alignItems:"center",justifyContent:"center",color:d},children:e.jsx(O,{size:14})}),e.jsx("span",{style:{color:i.get("mainText",t),fontSize:"15px",fontWeight:"600"},children:G(n.date,o)})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsx("span",{style:{color:i.get("mainText",t),fontSize:"15px",fontWeight:"700"},children:C(n.totalDuration)}),s===0&&n.totalMaxHold>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:i.get("subText",t)},children:[e.jsx(K,{size:8})," ",o===0?"Задержка: ":"Hold: "," ",C(n.totalMaxHold)]}),s===2&&n.totalTimeInCold>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:i.get("subText",t)},children:[e.jsx(M,{size:8})," ",o===0?"Холод: ":"Cold: "," ",C(n.totalTimeInCold)]})]})]},`${n.date}-${a}`))}),!f&&e.jsx("div",{onClick:n=>n.stopPropagation(),style:{position:"absolute",inset:0,zIndex:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:D.value==="dark"?"rgba(10, 10, 10, 0.85)":"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(5px)",textAlign:"center"},children:e.jsx("div",{style:{color:D.value==="dark"?"#FFD700":"#D97706",fontSize:"11px",fontWeight:"bold",fontFamily:"Segoe UI"},children:o===0?"ТОЛЬКО ДЛЯ ПРЕМИУМ":"PREMIUM USERS ONLY"})})]})},ee=t=>({container:{backgroundColor:i.get("background",t),display:"flex",position:"absolute",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"88vh",top:"12vh",width:"100vw",fontFamily:"Segoe UI",overflow:"hidden"}});export{se as default};
