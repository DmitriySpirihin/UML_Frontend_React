import{R as y,r as u,A as l,t as Q,g as Z,l as $,j as d,C as r,b as B,z as tt,s as P,D as et,B as nt,a as at,E as st,m as it,G as rt,H as ot,I as dt}from"./index-ZDuoRJat.js";import{u as ct,a as lt,b as z}from"./index-CH2jhtzz.js";const v=new Date().toISOString().split("T")[0],ut=new Audio("Audio/Click.wav"),pt=new Audio("Audio/IsDone.wav"),R=new Audio("Audio/Skip.wav"),_=new Audio("Audio/SwitchPanel.wav"),bt=new Audio("Audio/Transition.wav");let gt,ft,xt;const Dt=()=>{const[t,s]=y.useState("dark"),[c,i]=y.useState("dark"),[n,e]=y.useState([]),[x,w]=y.useState([]),[C,k]=u.useState(l.prefs[0]),[h,g]=u.useState(l.choosenHabits.length>0);y.useEffect(()=>{const o=Q.subscribe(s);return()=>o.unsubscribe()},[]),y.useEffect(()=>{const o=Z.subscribe(i);return()=>o.unsubscribe()},[]),y.useEffect(()=>{const o=$.subscribe(b=>{k(b==="ru"?0:1)});return()=>o.unsubscribe()},[]),y.useEffect(()=>{e(l.choosenHabits)},[]),y.useEffect(()=>{if(n.length>0){const o=new Set;n.forEach(b=>{const f=T().find(m=>m.id===b);f&&!o.has(f.category[0])&&o.add(f.category[0])}),w(Array.from(o))}},[n]);const I=o=>{e(b=>{const f=new Set(b);return f.has(o)?b:(l.addHabit(v,o),[...f,o])}),g(l.choosenHabits.length>0)};return gt=o=>{if(n.includes(o)){l.removeHabit(v,o),e(D=>D.filter(M=>M!==o));const m=(T().find(D=>D.id===o)?.name||["",""])[C]||(C===0?"Привычка":"Habit"),A=C===0?`Привычка: '${m}' удалена`:`Habit: '${m}' deleted`;tt(A,2e3),g(l.choosenHabits.length>0)}},ft=I,d.jsxs("div",{style:H(t).container,children:[!h&&d.jsx("div",{style:{...H(t).panel,justifyContent:"center",alignItems:"center",marginTop:"30%"},children:d.jsx("p",{style:{...H(t).subText,fontSize:"12px",margin:"10%",whiteSpace:"pre-line",color:r.get("subText",t)},children:wt(C)})}),h&&d.jsx("div",{style:H(t).scrollView,children:ht({theme:t,habitsCards:n,categories:x})}),d.jsx(St,{theme:t,globalTheme:c})]})};function T(){return B.concat((l.CustomHabits||[]).filter(t=>!B.some(s=>s.id===t.id)))}function ht({theme:t,habitsCards:s,categories:c}){return c.map(i=>{const n=s.map(e=>T().find(x=>x.id===e)).filter(e=>e&&e.category[0]===i);return d.jsx(Ct,{text:T().find(e=>e.category[0]===i)?.category,theme:t,children:n.map(e=>d.jsx(yt,{id:e.id,text:e.name,descr:e.description,imgsrc:e.src,theme:t},e.id))},i)})}function yt({id:t=0,text:s=["Название","Name"],descr:c=["Описание","Description"],imgsrc:i,theme:n}){const[e,x]=u.useState(l.habitsByDate[v]?.[t]),[w,C]=u.useState(l.prefs[0]),[k,h]=u.useState(null),g=100,I=-g,[j,o]=u.useState(!0);let b=r.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n),f=r.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",n),m=r.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",n);const[A,D]=u.useState(!1),[M,E]=u.useState(b);u.useEffect(()=>{const p=$.subscribe(a=>{C(a==="ru"?0:1)});return()=>p.unsubscribe()},[]),u.useEffect(()=>{l.changeStatus(v,t,e)},[e]),u.useEffect(()=>{(async()=>{try{if(i&&typeof i=="string"&&i.startsWith("icon_")){const a=await rt(i);h(a||"Art/HabitsIcons/Default.png")}else h(i)}catch(a){console.error("Error loading icon:",a),h("Art/HabitsIcons/Default.png")}})()},[i]);const U=Array.isArray(s)?s[w]:s,Y=Array.isArray(c)?c[w]:c;u.useEffect(()=>{E(r.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n))},[n,e]);const F=ct(0),L=lt(F,[-1,1],[I,g]),O=()=>{b=r.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n),f=r.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",n),m=r.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",n)},N=(p,a)=>{(e===1&&a.offset.x<0||e!==1)&&E(mt(b,a.offset.x>0?m:f,Math.abs(a.offset.x)/g)),Math.abs(a.offset.x)>g&&j&&(X(a.offset.x>0),z(L,0,{type:"tween",duration:.2}),o(!1))},V=()=>{j&&z(L,0,{type:"tween",duration:.2}),E(r.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n)),o(!0)},X=p=>{let a=0;if(p)e===0?a=1:e===-1?a=0:a=1,l.habitsByDate[v][t]=a;else{if(e===0)a=-1;else if(e===1)a=0;else{a=-1,xt=t;const J=l.prefs[0]===0?`Вы уверены, что хотите удалить привычку: '${U}' ?`:`Are you sure you want to delete '${U}' habit?`;dt(J)}l.habitsByDate[v][t]=a}a===1?S(pt,50):a===-1&&S(R,50),E(r.get(a===1?"habitCardDone":a===-1?"habitCardSkipped":"habitCard",n)),x(a)},G=()=>{S(ut,50);const p=!A;D(p),ot(p?t:null)};u.useEffect(()=>{const p=st.subscribe(a=>{D(a===t)});return()=>p.unsubscribe()},[t]);const W={display:"flex",flexDirection:"column",alignItems:"stretch",borderRadius:"24px",margin:"10px",overflow:"hidden",borderStyle:"solid",borderColor:r.get("border",n),borderWidth:1,position:"relative",backgroundColor:M,x:L},K={fontSize:"14px",color:r.get("mainText",n),marginLeft:"20px"},q={textAlign:"left",fontSize:"10px",color:r.get("subText",n),marginLeft:"70px"};return d.jsxs(it.div,{id:t,style:W,onClick:G,drag:j?"x":!1,dragConstraints:{left:I,right:e===1?0:g},onDragStart:O,dragElastic:0,onDrag:N,onDragEnd:V,animate:{height:A?"10vh":"4.5vh",outline:A?"3px solid "+r.get("border",n):"1px solid "+r.get("border",n)},transition:{type:"tween",duration:.4,ease:"easeInOut"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",maxHeight:"40px",paddingBottom:"5px"},children:[k&&d.jsx("img",{src:k,style:{width:"24px",objectFit:"contain",marginLeft:"15px",marginTop:"8px"},onError:p=>{p.target.onerror=null,p.target.src="Art/HabitsIcons/Default.png"},alt:""}),d.jsx("h2",{style:K,children:U})]}),A&&d.jsx("div",{style:{paddingBottom:"25px"},children:d.jsx("p",{style:q,children:Y})})]})}function Ct({text:t=["Имя","Name"],children:s,theme:c}){const[i,n]=u.useState(l.prefs[0]);return u.useEffect(()=>{const e=$.subscribe(x=>{n(x==="ru"?0:1)});return()=>e.unsubscribe()},[]),d.jsxs("div",{style:H(c).categoryPanel,children:[d.jsx("h2",{style:{textAlign:"center",fontSize:"14px",color:r.get("mainText",c)},children:t[i]}),s]})}function St({globalTheme:t,theme:s}){const c={position:"fixed",bottom:"0",left:"0",width:"100vw",height:"10vh",borderTopLeftRadius:"24px",borderTopRightRadius:"24px",backgroundColor:r.get("bottomPanel",s),display:"flex",justifyContent:"space-around",alignItems:"center",zIndex:900,boxShadow:`0px -2px 0px ${r.get("bottomPanelShadow",s)}`},i={width:"35px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"};return d.jsxs("div",{style:c,children:[d.jsx("img",{src:t==="dark"?"Art/Ui/Back_Dark.png":"Art/Ui/Back_Light.png",style:i,onClick:()=>{P("MainMenu"),et(),S(R,50)}}),d.jsx("img",{src:t==="dark"?"Art/Ui/Metrics_Dark.png":"Art/Ui/Metrics_Light.png",style:i,onClick:()=>{P("HabitMetrics"),S(_,50)}}),d.jsx("img",{src:t==="dark"?"Art/Ui/Add_Dark.png":"Art/Ui/Add_Light.png",style:i,onClick:()=>{nt(!0),S(bt,50)}}),d.jsx("img",{src:t==="dark"?"Art/Ui/Setting_Dark.png":"Art/Ui/Settings_Light.png",style:i,onClick:()=>{at(!0),S(_,50)}}),d.jsx("img",{src:t==="dark"?"Art/Ui/Calendar_Dark.png":"Art/Ui/Calendar_Light.png",style:i,onClick:()=>{P("HabitCalendar"),S(_,50)}})]})}const H=t=>({container:{backgroundColor:r.get("background",t),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI"},categoryPanel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${r.get("border",t)}`,margin:"5px",background:r.get("panelGradient",t),boxShadow:`4px 4px 6px ${r.get("shadow",t)}`},text:{textAlign:"left",fontSize:"10px",color:r.get("subText",t),marginLeft:"30px",marginBottom:"12px"},scrollView:{width:"85vw",height:"74vh",overflowY:"auto",marginTop:"17vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"}});function mt(t,s,c){if(!t||!s)return t||s||"#000000";c=Math.max(0,Math.min(1,c)),t=t.replace("#",""),s=s.replace("#","");const i=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),e=parseInt(t.slice(4,6),16),x=parseInt(s.slice(0,2),16),w=parseInt(s.slice(2,4),16),C=parseInt(s.slice(4,6),16),k=Math.round(i+(x-i)*c),h=Math.round(n+(w-n)*c),g=Math.round(e+(C-e)*c);return"#"+k.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")+g.toString(16).padStart(2,"0")}function wt(t){return t===0?`Вы еще не добавили ни одной привычки

 Вы можете выбрать из списка или добавить свою привычку.

Выбранные привычки будут обновляться автоматически каждый день, если вы пропустите день, привычка будет не выполнена для этого дня.

Вы должны выполнить свою привычку и затем свайпнуть вправо, чтобы отметить её как выполненную.

Чтобы сформировать привычку, вам нужно выполнить ее 66 дней подряд.

Вы можете просмотреть прогресс ваших привычек в панели метрик и календаре.


 * Чтобы начать, нажмите кнопку "+" ниже`:`You have not added any habits yet

 You can choose from the list or add your own habit.

Choosen habits will update automatically every day, if you skip a day, the habit will be skipped for that day.

You need to perform your habit and then swipe right to mark it as done.

To form a habit you need to perform it for 66 days in a row.

You can view a progress of your habits in the metrics panel and calendar.


 * To get started tap the "+" button below`}function S(t,s){l.prefs[2]==0&&t!==null&&(t.paused||(t.pause(),t.currentTime=0),t.volume=.5,t.play()),l.prefs[3]==0&&navigator.vibrate(s)}export{ft as addHabitFn,xt as currentId,Dt as default,gt as removeHabitFn};
