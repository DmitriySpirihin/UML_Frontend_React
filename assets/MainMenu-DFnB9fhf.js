import{A as d,U as S,p as K,u as Q,t as q,l as X,f as Z,v as _,w as ee,j as e,b as k,N as te,C as r,m as f,a as ie,x as se,y as ne,z as oe,B as ae,D as re,E as le,G as ce,n as de,H as pe,I as ue,J as xe,i as ge,K as he,L as fe}from"./index-D4sWhUtF.js";import{r as a,R as be}from"./recharts-Bg6K2Pzo.js";import{getCurrentCycleAnalysis as ye}from"./TrainingAnaliticsMain-BlDqz2JM.js";import{s as me}from"./Premium-3TNWy-Dx.js";import"./TrainingAnaliticsTabs-B0ZLu22o.js";import"./index-BJUKRcps.js";const ze=()=>{const[i,s]=a.useState(d.prefs[1]===0?"dark":"light"),[o,l]=a.useState(d.prefs[0]),[u,b]=a.useState(0),[y,m]=a.useState(0),[g,c]=a.useState(0),[j,w]=a.useState(!1),[I,v]=a.useState(""),[T,z]=a.useState(""),[D,E]=a.useState(""),[M,H]=a.useState(!1),[U,R]=a.useState(!1),[W,$]=a.useState(S.hasPremium),[Ce,B]=a.useState(S.isValidation),[p,F]=a.useState(d.menuCardsStates||{}),A=[{id:"MainCard",icon:null,title:"",subtitle:"",color:"#00ff6600"},{id:"HabitsMain",icon:e.jsx(oe,{}),title:o===0?"Привычки":"Habits",subtitle:o===0?"Трекер дисциплины":"Discipline tracker",color:"#FFD700"},{id:"TrainingMain",icon:e.jsx(ae,{}),title:o===0?"Тренировки":"Workout",subtitle:o===0?"Дневник силы":"Gym diary",color:"#FF4D4D"},{id:"MentalMain",icon:e.jsx(re,{}),title:o===0?"Мозг":"Brain",subtitle:o===0?"Развитие интеллекта":"Intelligence",color:"#4DA6FF"},{id:"RecoveryMain",icon:e.jsx(le,{}),title:o===0?"Восстановление":"Recovery",subtitle:o===0?"Медитации и отдых":"Meditation & Rest",color:"#4DFF88"},{id:"SleepMain",icon:e.jsx(ce,{}),title:o===0?"Сон":"Sleep",subtitle:o===0?"Анализ качества":"Quality analysis",color:"#A64DFF"},{id:"ToDoMain",icon:e.jsx(de,{}),title:o===0?"Задачи":"To-Do",subtitle:o===0?"Список дел":"Task list",color:"#FFA64D"}];a.useEffect(()=>{d.menuCardsStates&&Object.keys(d.menuCardsStates).length>0&&F(d.menuCardsStates)},[]),a.useEffect(()=>{Object.keys(p).length>0&&(d.menuCardsStates=p,(async()=>{try{await ne(),console.log("Menu states saved successfully")}catch(n){console.error("Failed to save menu states",n)}})())},[p]),a.useEffect(()=>{const t=K.subscribe($),n=Q.subscribe(B);return()=>{t.unsubscribe(),n.unsubscribe()}},[]),a.useEffect(()=>{const t=q.subscribe(s),n=X.subscribe(C=>{l(C==="ru"?0:1)}),x=Z.subscribe(b);return()=>{t.unsubscribe(),n.unsubscribe(),x.unsubscribe()}},[]),a.useEffect(()=>{const t=_.subscribe(v),n=ee.subscribe(H);return()=>{t.unsubscribe(),n.unsubscribe()}},[]),a.useEffect(()=>{M&&(R(!1),w(!0))},[M]);const P=t=>{t?c(g+1):m(y+1),y===5&&g===5&&(R(!0),m(0),c(0),S.hasPremium=!0,S.premiumEndDate="2099-01-01",ue(!0))},V=t=>{t.length===16&&pe(t)},O=t=>{F(n=>({...n,[t]:{...n[t],pinned:!n[t]?.pinned,hidden:n[t]?.hidden||!1}}))},L=t=>{F(n=>({...n,[t]:{...n[t],hidden:!0,pinned:!1}}))},G=()=>{F(t=>{const n={...t};return Object.keys(n).forEach(x=>{n[x]={...n[x],hidden:!1}}),n})},N=(()=>{let t=[...A];return t=t.filter(n=>!p[n.id]?.hidden),t.sort((n,x)=>{const C=p[n.id]?.pinned?1:0;return(p[x.id]?.pinned?1:0)-C}),t})(),Y=A.some(t=>p[t.id]?.hidden),J={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.09}}};return e.jsxs(e.Fragment,{children:[j&&e.jsxs("div",{style:{position:"absolute",display:"flex",alignItems:"center",flexDirection:"column",top:"10vh",left:"0",width:"100vw",height:"40vh",backgroundColor:"rgba(0,0,0,0.9)",zIndex:1e4},children:[e.jsx("div",{style:{display:"flex",overflowY:"scroll",borderRadius:"12px",width:"85vw",height:"15vh",fontSize:"12px",fontFamily:"Segoe UI",border:"1px solid #333",color:"white",padding:"10px"},children:I}),e.jsx("textarea",{style:{borderRadius:"12px",width:"85vw",height:"10vh",fontSize:"12px",background:"#111",color:"white",marginTop:"10px"},value:D,onChange:t=>E(t.target.value)}),e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around",marginTop:"10px"},children:[e.jsx("input",{style:{borderRadius:"12px",width:"50vw",height:"3vh",background:"#222",color:"white"},type:"text",onChange:t=>z(t.target.value)}),e.jsx("button",{onClick:()=>{T==="TrainingMain"?k("TrainingMain"):te.sendMessage(T,D)},children:"Submit"})]}),e.jsx("button",{onClick:()=>w(!1),style:{marginTop:"10px"},children:"Close"})]}),e.jsxs("div",{style:h(i).container,children:[e.jsx("div",{style:{height:"16vh"}}),U&&e.jsx("input",{style:{width:"85vw",height:"2vh",fontSize:"12px",borderRadius:"12px",zIndex:1001,marginBottom:"10px"},type:"password",onChange:t=>V(t.target.value)}),e.jsxs("div",{style:h(i).scrollView,children:[e.jsx("div",{style:{height:"2vh",width:"100%"},onClick:()=>{P(!0)}}),e.jsx(f.div,{variants:J,initial:"hidden",animate:"show",style:h(i).grid,children:e.jsx(ie,{mode:"popLayout",children:N.map((t,n)=>e.jsx(Fe,{item:t,theme:i,hasPremium:W,index:n,fSize:u,lang:o,isPinned:p[t.id]?.pinned,onPin:()=>O(t.id),onHide:()=>L(t.id)},t.id))})}),Y&&e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},onClick:G,style:{marginTop:"20px",padding:"10px 20px",display:"flex",alignItems:"center",gap:"8px",background:r.get("simplePanel",i),borderRadius:"20px",cursor:"pointer",fontSize:"12px",color:r.get("subText",i)},children:[e.jsx(se,{})," ",o===0?"Вернуть скрытые разделы":"Restore hidden sections"]}),e.jsx("div",{style:{height:"10vh",width:"100%"},onClick:()=>{P(!1)}})]})]})]})};function we({theme:i,lang:s,onClick:o}){const l=i==="dark";return e.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},whileTap:{scale:.96},onClick:o,style:{width:"88%",height:"88%",borderRadius:"16px",background:l?"rgba(0, 229, 255, 0.08)":"#FFFFFF",border:`1px solid ${l?"rgba(0, 229, 255, 0.3)":"rgba(0, 229, 255, 0.5)"}`,margin:"5px",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",position:"relative",overflow:"hidden"},children:[e.jsx(fe,{size:18,color:"#00E5FF"}),e.jsx("span",{style:{fontFamily:"Segoe UI",fontWeight:"600",fontSize:"15px",color:l?"#E0F7FA":"#333",letterSpacing:"0.3px"},children:s===0?"AI Ассистент":"AI Assistant"})]})}function ve({theme:i,lang:s,onClick:o}){const l=i==="dark";return e.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},whileTap:{scale:.96},onClick:o,style:{width:"88%",height:"88%",borderRadius:"16px",background:l?"rgba(242, 255, 0, 0.08)":"#FFFFFF",border:`1px solid ${l?"rgba(255, 238, 0, 0.3)":"rgba(255, 247, 0, 0.5)"}`,margin:"5px",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",position:"relative",overflow:"hidden"},children:[e.jsx(he,{size:18,color:"#ffd500"}),e.jsx("span",{style:{fontFamily:"Segoe UI",fontWeight:"600",fontSize:"15px",color:l?"#E0F7FA":"#333",letterSpacing:"0.3px"},children:s===0?"Друг = премиум":"Friend = premium"})]})}function Fe({item:i,theme:s,index:o,fSize:l,lang:u,isPinned:b,onPin:y,onHide:m}){const g=je(o-1),c=s==="dark",j={position:"relative",width:"100%",height:i.icon?"80px":"50px",display:"flex",alignItems:"center",padding:i.icon?"0 20px":"0px",boxSizing:"border-box",borderRadius:i.icon?"24px":"0px",overflow:"hidden",marginBottom:"12px",backgroundColor:i.icon?c?r.get("simplePanel",s)+"99":"#FFFFFF":"transparent",backdropFilter:i.icon&&c?"blur(40px)":"none",border:i.icon?b?`1px solid ${i.color}`:`1px solid ${c?r.get("border",s)+"30":"#E5E7EB"}`:"none",boxShadow:i.icon?c?"0 8px 20px 0 rgba(0, 0, 0, 0.4)":"0 4px 10px rgba(0, 0, 0, 0.04)":"none"},w={width:"48px",height:"48px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px",flexShrink:0,backgroundColor:c?r.get("background",s)+"80":r.get("background",s),color:i.color,border:c?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.03)"};return e.jsx(f.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,x:-100,height:0,marginBottom:0},whileTap:{scale:.97},drag:"x",dragConstraints:{left:0,right:0},onDragEnd:(I,{offset:v})=>{v.x<-80&&(m(),window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.notificationOccurred("success")),v.x>80&&(y(),window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("medium"))},onClick:()=>{i.icon!==null&&(k(i.id),Se(null))},style:j,children:i.icon?e.jsxs("div",{style:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"},children:[e.jsx("div",{style:w,children:be.cloneElement(i.icon,{size:22})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",flexGrow:1,overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("h4",{style:{...h(s,l).title,color:r.get("mainText",s),margin:0,fontWeight:c?"900":"700"},children:i.title}),b&&e.jsx(xe,{size:12,color:i.color,style:{transform:"rotate(45deg)"}})]}),e.jsx("div",{style:{...h(s,l).subtitle,color:r.get("subText",s),opacity:c?.6:.8},children:i.subtitle})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginLeft:"8px"},children:[g!==""&&e.jsx("div",{style:{padding:"4px 10px",backgroundColor:c?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",borderRadius:"12px",fontSize:"13px",fontWeight:"700",color:r.get("mainText",s),marginRight:"8px"},children:g}),e.jsx(ge,{size:14,color:r.get("subText",s),style:{opacity:.3}})]})]}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",alignContent:"center",justifyItems:"center"},children:[e.jsx(ve,{theme:s,lang:u,onClick:()=>me()}),e.jsx(we,{theme:s,lang:u,onClick:()=>{k("RobotMain")}})]})})}const h=(i,s)=>({container:{backgroundColor:r.get("background",i),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI",overflow:"hidden"},scrollView:{width:"100vw",maxHeight:"90vh",overflowY:"scroll",display:"flex",flexDirection:"column",alignItems:"center"},grid:{width:"92%",display:"flex",flexDirection:"column",gap:"4px",marginTop:"5px"},title:{fontFamily:"Segoe UI",fontSize:s===0?"19px":"21px",letterSpacing:"0.2px"},subtitle:{fontFamily:"Segoe UI",fontWeight:"500",fontSize:s===0?"12px":"14px",marginTop:"2px"},text:{fontFamily:"Segoe UI",fontSize:s===0?"10px":"12px",color:r.get("subText",i)},mainText:{fontFamily:"Segoe UI",fontSize:s===0?"14px":"16px",color:r.get("mainText",i)}});function Se(i){d.prefs[2]==0,d.prefs[3]==0&&window.Telegram?.WebApp?.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("light")}function je(i){if(i===0)return d.choosenHabits.length>0?d.choosenHabits.length:"";if(i===1){const s=ye().currentTonnage;return s>0?(s/1e3).toFixed(1)+(d.prefs[0]===0?"т":"t"):""}return""}export{ze as default};
