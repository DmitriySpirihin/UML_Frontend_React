import{R as m,r as u,A as l,t as tt,g as et,l as F,j as i,C as o,b as P,I as at,s as T,J as nt,a as st,K as rt,m as ot,L as it,M as dt}from"./index-w8IAKEA-.js";import{B as ct,a as lt,M as B,b as $,A as ut,c as pt,C as ft,d as bt}from"./Calendar_Light-BCEklUL6.js";import{b as gt,c as ht}from"./SaveHelper-CbdKbu9V.js";import{u as xt,a as yt,b as N}from"./index-kti6s9Ko.js";const j=new Date().toISOString().split("T")[0],mt=new Audio(new URL("/UML_Frontend_React/assets/Click-5rJ2A-_B.wav",import.meta.url).href),Ct=new Audio(new URL("/UML_Frontend_React/assets/IsDone-CY5KfW9n.wav",import.meta.url).href),z=new Audio(new URL("/UML_Frontend_React/assets/Skip-C95holY4.wav",import.meta.url).href),U=new Audio(new URL("/UML_Frontend_React/assets/SwitchPanel-CJjFfFgV.wav",import.meta.url).href),St=new Audio(new URL("/UML_Frontend_React/assets/Transition-DNEfmScM.wav",import.meta.url).href);let wt,Dt,kt;const Ut=()=>{const[t,r]=m.useState("dark"),[c,a]=m.useState("dark"),[n,e]=m.useState([]),[f,C]=m.useState([]),[h,D]=u.useState(l.prefs[0]),[x,y]=u.useState(l.choosenHabits.length>0);m.useEffect(()=>{const d=tt.subscribe(r);return()=>d.unsubscribe()},[]),m.useEffect(()=>{const d=et.subscribe(a);return()=>d.unsubscribe()},[]),m.useEffect(()=>{const d=F.subscribe(b=>{D(b==="ru"?0:1)});return()=>d.unsubscribe()},[]),m.useEffect(()=>{e(l.choosenHabits)},[]),m.useEffect(()=>{if(n.length>0){const d=new Set;n.forEach(b=>{const g=_().find(w=>w.id===b);g&&g.category&&g.category[h]&&d.add(g.category[h])}),C(Array.from(d))}},[n]);const A=d=>{e(b=>{const g=new Set(b);return g.has(d)?b:(l.addHabit(j,d),[...g,d])}),y(l.choosenHabits.length>0)};return wt=d=>{if(n.includes(d)){l.removeHabit(j,d),e(v=>v.filter(M=>M!==d));const w=(_().find(v=>v.id===d)?.name||["",""])[h]||(h===0?"Привычка":"Habit"),k=h===0?`Привычка: '${w}' удалена`:`Habit: '${w}' deleted`;at(k,2e3),y(l.choosenHabits.length>0)}},Dt=A,i.jsxs("div",{style:L(t).container,children:[!x&&i.jsx("div",{style:{...L(t).panel,justifyContent:"center",alignItems:"center",marginTop:"30%"},children:i.jsx("p",{style:{...L(t).subText,fontSize:"12px",margin:"10%",whiteSpace:"pre-line",color:o.get("subText",t)},children:Ht(h)})}),x&&i.jsx("div",{style:L(t).scrollView,children:vt({theme:t,habitsCards:n,categories:f})}),i.jsx(At,{theme:t,globalTheme:c})]})};function _(){return P.concat((l.CustomHabits||[]).filter(t=>!P.some(r=>r.id===t.id)))}function vt({theme:t,habitsCards:r,categories:c}){return c.map(a=>{const n=r.map(e=>_().find(f=>f.id===e)).filter(e=>e&&e.category&&Array.isArray(e.category)&&e.category[0]===a);return i.jsx(Lt,{text:a,theme:t,children:n.map(e=>{const f=(e.isCustom,e.src);return i.jsx(jt,{id:e.id,text:e.name,descr:e.description,imgsrc:f,theme:t},e.id)})},a)})}function jt({id:t=0,text:r=["Название","Name"],descr:c=["Описание","Description"],imgsrc:a,theme:n}){const[e,f]=u.useState(l.habitsByDate[j]?.[t]),[C,h]=u.useState(l.prefs[0]),[D,x]=u.useState(null),y=100,A=-y,[I,d]=u.useState(!0);let b=o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n),g=o.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",n),w=o.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",n);const[k,v]=u.useState(!1),[M,H]=u.useState(b);u.useEffect(()=>{const p=F.subscribe(s=>{h(s==="ru"?0:1)});return()=>p.unsubscribe()},[]),u.useEffect(()=>{l.changeStatus(j,t,e)},[e]),u.useEffect(()=>{typeof a=="string"&&(a.startsWith("data:")||a.startsWith("http")||a.startsWith("blob:"))?x(a):a&&typeof a=="string"&&a.startsWith("icon_")?(async()=>{try{const s=await ht(a);x(s||new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href)}catch(s){console.error("Error loading custom icon:",s),x(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href)}})():a&&typeof a=="object"&&"default"in a?x(a.default||a):x(new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href)},[a]);const R=Array.isArray(r)?r[C]:r,K=Array.isArray(c)?c[C]:c;u.useEffect(()=>{H(o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n))},[n,e]);const Y=xt(0),E=yt(Y,[-1,1],[A,y]),W=()=>{b=o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n),g=o.get(e===0?"habitCardSkipped":e===1?"habitCard":"habitCardSkipped",n),w=o.get(e===0?"habitCardDone":e===-1?"habitCard":"habitCardDone",n)},O=(p,s)=>{(e===1&&s.offset.x<0||e!==1)&&H(It(b,s.offset.x>0?w:g,Math.abs(s.offset.x)/y)),Math.abs(s.offset.x)>y&&I&&(J(s.offset.x>0),N(E,0,{type:"tween",duration:.2}),d(!1))},V=()=>{I&&N(E,0,{type:"tween",duration:.2}),H(o.get(e===1?"habitCardDone":e===-1?"habitCardSkipped":"habitCard",n)),d(!0)},J=p=>{let s=0;if(p)e===0?s=1:e===-1?s=0:s=1,l.habitsByDate[j][t]=s;else{if(e===0)s=-1;else if(e===1)s=0;else{s=-1,kt=t;const Z=l.prefs[0]===0?`Вы уверены, что хотите удалить привычку: '${R}' ?`:`Are you sure you want to delete '${R}' habit?`;dt(Z)}l.habitsByDate[j][t]=s}s===1?S(Ct,50):s===-1&&S(z,50),H(o.get(s===1?"habitCardDone":s===-1?"habitCardSkipped":"habitCard",n)),f(s)},X=()=>{S(mt,50);const p=!k;v(p),it(p?t:null)};u.useEffect(()=>{const p=rt.subscribe(s=>{v(s===t)});return()=>p.unsubscribe()},[t]);const G={display:"flex",flexDirection:"column",alignItems:"stretch",borderRadius:"24px",margin:"10px",overflow:"hidden",borderStyle:"solid",borderColor:o.get("border",n),borderWidth:1,position:"relative",backgroundColor:M,x:E},q={fontSize:"14px",color:o.get("mainText",n),marginLeft:"20px"},Q={textAlign:"left",fontSize:"10px",color:o.get("subText",n),marginLeft:"70px"};return i.jsxs(ot.div,{id:t,style:G,onClick:X,drag:I?"x":!1,dragConstraints:{left:A,right:e===1?0:y},onDragStart:W,dragElastic:0,onDrag:O,onDragEnd:V,animate:{height:k?"10vh":"4.5vh",outline:k?"3px solid "+o.get("border",n):"1px solid "+o.get("border",n)},transition:{type:"tween",duration:.4,ease:"easeInOut"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",maxHeight:"40px",paddingBottom:"5px"},children:[D&&i.jsx("img",{src:D,style:{width:"24px",objectFit:"contain",marginLeft:"15px",marginTop:"8px"},onError:p=>{p.target.onerror=null,p.target.src=new URL("/UML_Frontend_React/assets/Default-f6NamDK1.png",import.meta.url).href},alt:""}),i.jsx("h2",{style:q,children:R})]}),k&&i.jsx("div",{style:{paddingBottom:"25px"},children:i.jsx("p",{style:Q,children:K})})]})}function Lt({text:t=["Имя","Name"],children:r,theme:c}){const[a,n]=u.useState(l.prefs[0]);u.useEffect(()=>{const f=F.subscribe(C=>{n(C==="ru"?0:1)});return()=>f.unsubscribe()},[]);const e=Array.isArray(t)?t[a]:t;return i.jsxs("div",{style:L(c).categoryPanel,children:[i.jsx("h2",{style:{textAlign:"center",fontSize:"14px",color:o.get("mainText",c)},children:e}),r]})}function At({globalTheme:t,theme:r}){const c={position:"fixed",bottom:"0",left:"0",width:"100vw",height:"10vh",borderTopLeftRadius:"24px",borderTopRightRadius:"24px",backgroundColor:o.get("bottomPanel",r),display:"flex",justifyContent:"space-around",alignItems:"center",zIndex:900,boxShadow:`0px -2px 0px ${o.get("bottomPanelShadow",r)}`},a={width:"35px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"};return i.jsxs("div",{style:c,children:[i.jsx("img",{src:t==="dark"?ct:lt,style:a,onClick:()=>{T("MainMenu"),gt(),S(z,50)}}),i.jsx("img",{src:t==="dark"?B:$,style:a,onClick:()=>{T("HabitMetrics"),S(U,50)}}),i.jsx("img",{src:t==="dark"?ut:pt,style:a,onClick:()=>{nt(!0),S(St,50)}}),i.jsx("img",{src:t==="dark"?B:$,style:a,onClick:()=>{st(!0),S(U,50)}}),i.jsx("img",{src:t==="dark"?ft:bt,style:a,onClick:()=>{T("HabitCalendar"),S(U,50)}})]})}const L=t=>({container:{backgroundColor:o.get("background",t),display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",height:"100vh",width:"100vw",fontFamily:"Segoe UI"},categoryPanel:{alignItems:"center",justifyContent:"center",borderRadius:"24px",border:`1px solid ${o.get("border",t)}`,margin:"5px",background:o.get("panelGradient",t),boxShadow:`4px 4px 6px ${o.get("shadow",t)}`},text:{textAlign:"left",fontSize:"10px",color:o.get("subText",t),marginLeft:"30px",marginBottom:"12px"},scrollView:{width:"85vw",height:"74vh",overflowY:"auto",marginTop:"17vh",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"stretch"}});function It(t,r,c){if(!t||!r)return t||r||"#000000";c=Math.max(0,Math.min(1,c)),t=t.replace("#",""),r=r.replace("#","");const a=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),e=parseInt(t.slice(4,6),16),f=parseInt(r.slice(0,2),16),C=parseInt(r.slice(2,4),16),h=parseInt(r.slice(4,6),16),D=Math.round(a+(f-a)*c),x=Math.round(n+(C-n)*c),y=Math.round(e+(h-e)*c);return"#"+D.toString(16).padStart(2,"0")+x.toString(16).padStart(2,"0")+y.toString(16).padStart(2,"0")}function Ht(t){return t===0?`Вы еще не добавили ни одной привычки

 Вы можете выбрать из списка или добавить свою привычку.

Выбранные привычки будут обновляться автоматически каждый день, если вы пропустите день, привычка будет не выполнена для этого дня.

Вы должны выполнить свою привычку и затем свайпнуть вправо, чтобы отметить её как выполненную.

Чтобы сформировать привычку, вам нужно выполнить ее 66 дней подряд.

Вы можете просмотреть прогресс ваших привычек в панели метрик и календаре.


 * Чтобы начать, нажмите кнопку "+" ниже`:`You have not added any habits yet

 You can choose from the list or add your own habit.

Choosen habits will update automatically every day, if you skip a day, the habit will be skipped for that day.

You need to perform your habit and then swipe right to mark it as done.

To form a habit you need to perform it for 66 days in a row.

You can view a progress of your habits in the metrics panel and calendar.


 * To get started tap the "+" button below`}function S(t,r){l.prefs[2]==0&&t!==null&&(t.paused||(t.pause(),t.currentTime=0),t.volume=.5,t.play()),l.prefs[3]==0&&navigator.vibrate(r)}export{Dt as addHabitFn,kt as currentId,Ut as default,wt as removeHabitFn};
